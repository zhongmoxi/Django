(function(a){with(a){
a.gD=function(b,c){var d=k;if("delete"===c&&(d=xu.zs?"debugger":window.prompt("请输入删除理由"),!d))return;b.xhr=new V(j);b.Cb&&P(b.h(),b.xhr,"success",b.Ce);b.xhr.ajax("/reviewq/answer?queue_id="+b.Mb+"&is_realm="+b.ge,"action="+c+"&answer_id="+b.ea.getAttribute("data-answer_id")+"&task_id="+b.ea.getAttribute("data-task_id")+(d?"&reason="+d:"")+"&none_queue="+b.ea.getAttribute("data-none_queue"))},a.hD=function(b,c){b.xhr=new V(j);b.Cb&&P(b.h(),b.xhr,"success",b.Ce);b.xhr.ajax("/reviewq/question?queue_id="+
b.Mb+"&is_realm="+b.ge,"action="+c+"&question_id="+b.ea.getAttribute("data-question_id")+"&task_id="+b.ea.getAttribute("data-task_id")+"&none_queue="+b.ea.getAttribute("data-none_queue"))},a.iD=["delete","delete_answer"],a.jD=function(b){if(A&&!Ib(9)){var c=n;try{c=b.parentNode}catch(d){}return!!c}return vc(b.ownerDocument.body,b)},a.kD=function(b,c){return b.K.m(c?b.QI:b.aE)},a.lD=function(b){if("outerHTML"in b)return b.outerHTML;var c=Ub(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML};
wq.prototype.jg=Z(66,function(){var b=this.ur.body.createTextRange();b.moveToElementText(this.ur.body);return this.Mg(new wq(b,this.ur),j)});Gq.prototype.jg=Z(65,function(){return(!this.xa||jD(this.xa))&&(!this.ua||jD(this.ua))&&(!(A&&!Ib(9))||Kq(this).jg())});Mq.prototype.jg=Z(64,function(){var b=n;try{b=z.every(this.gi(),function(b){return A?!!b.parentNode:vc(b.ownerDocument.body,b)})}catch(c){}return b});Sq.prototype.jg=Z(63,function(){return z.every(hq(this),function(b){return b.jg()})});
oq.prototype.uj=Z(58,function(){return 3!=this.ga.nodeType?-1:this.ga==this.xa?this.Fa:0});Qq.prototype.uj=Z(57,s(0));Uq.prototype.uj=Z(56,function(){return this.kg[this.hl].uj()});py.prototype.mx=Z(51,function(b,c,d,e,g){var h=g||"question",b="question"===h?"问题":"答案";z.contains(iD,e)?Hi({title:d+b,content:"确定要"+d+"这个"+b+"吗？",Yi:["取消","确定"+d]},function(b){b?"question"===h?hD(this,e):gD(this,e):this.locked=n},this):"question"===h?hD(this,e):gD(this,e)});
rq.prototype.ee=Z(47,function(){var b=Vb(this.Q.startContainer).w("div");b.appendChild(this.Q.cloneContents());b=b.innerHTML;if(Ea(b,"<")||!this.isCollapsed()&&!Xa(b,"<"))return b;var c=this.yc(),c=1==c.nodeType?c:c.parentNode;return lD(c.cloneNode(n)).replace(">",">"+b)});wq.prototype.ee=Z(46,function(){return this.Q.htmlText});Gq.prototype.ee=Z(45,function(){return Kq(this).ee()});Mq.prototype.ee=Z(44,function(){return this.Xg()});Sq.prototype.ee=Z(43,function(){return z.map(hq(this),function(b){return b.ee()}).join("")});
oq.prototype.sj=Z(42,function(){return 3!=this.ga.nodeType?-1:this.ga==this.ua?this.Ca:this.ga.nodeValue.length});Qq.prototype.sj=Z(41,s(0));Uq.prototype.sj=Z(40,function(){return this.kg[this.hl].sj()});fq.prototype.ug=Z(39,function(b){this.isCollapsed()||this.cd();return this.insertNode(b,j)});Mq.prototype.ug=Z(38,function(b){b=this.insertNode(b,j);this.isCollapsed()||this.cd();return b});
cq.prototype.restore=Z(35,function(b){this.Sg&&dq.log(fe,"Disposed SavedRange objects cannot be restored.",i);var c=this.pk();b||this.H();return c});Lq.prototype.pk=Z(34,function(){return Jq(this.rC,this.yL,this.pE,this.FN)});Rq.prototype.pk=Z(33,function(){for(var b=(this.$a.length?Ub(this.$a[0]):document).body.createControlRange(),c=0,d=this.$a.length;c<d;c++)b.addElement(this.$a[c]);return Nq(b)});
Vq.prototype.pk=Z(32,function(){var b=z.map(this.dA,function(b){return b.restore()}),c=new Sq;c.xm=b;c.ef=z.map(b,function(b){return b.be()});return c});pq.prototype.Xg=Z(25,function(){var b=new $s;O.forEach(this,function(c,d,e){3==c.nodeType?b.append(Wa(c.nodeValue.substring(e.uj(),e.sj()))):1==c.nodeType&&(-1==e.ec?jc(c)&&b.append("</"+c.tagName+">"):(d=c.cloneNode(n),d=lD(d),A&&"LI"==c.tagName?b.append(d):(c=d.lastIndexOf("<"),b.append(c?d.substr(0,c):d))))},this);return b.toString()});
Gq.prototype.Xg=Z(24,function(){return Kq(this).Xg()});Mq.prototype.Xg=Z(23,function(){return z.map(Pq(this),lD).join("")});Sq.prototype.Xg=Z(22,function(){return this.ee()});eq.prototype.Lp=Z(16,function(){var b=this.Tc?-1:1;this.ec==b&&(this.ec=-1*b,this.depth+=this.ec*(this.Tc?-1:1))});oq.prototype.Lp=Z(15,function(){oq.n.Lp.apply(this);vc(this.ga,this.ua)&&f(O.fb)});ce.prototype.gD=Z(13,function(b,c){this.log(ie,b,c)});
Md.prototype.setInterval=Z(11,function(b){this.dh=b;this.sa&&this.enabled?(this.stop(),this.start()):this.sa&&this.stop()});go.prototype.$w=Z(10,function(){return this.m().innerHTML});nq.prototype.yh=Z(9,function(b,c){this.insertNode(b,j);this.insertNode(c,n)});
rq.prototype.yh=Z(8,function(b,c){var d=dc(Ub(this.Z()));if(d=Xq(d))var e=d.Z(),g=d.ka(),h=d.wa(),l=d.Ka();var m=this.Q.cloneRange(),p=this.Q.cloneRange();m.collapse(n);p.collapse(j);m.insertNode(c);p.insertNode(b);m.detach();p.detach();if(d){if(3==e.nodeType)for(;h>e.length;){h-=e.length;do e=e.nextSibling;while(e==b||e==c)}if(3==g.nodeType)for(;l>g.length;){l-=g.length;do g=g.nextSibling;while(g==b||g==c)}Jq(e,h,g,l).select()}});
wq.prototype.yh=Z(7,function(b,c){var d=this.Q.duplicate(),e=this.Q.duplicate();Cq(d,b,j);Cq(e,c,n);this.De()});Gq.prototype.yh=Z(6,function(b,c){Kq(this).yh(b,c);this.De()});rq.prototype.cd=Z(5,function(){var b=this.Q;b.extractContents();if(b.startContainer.hasChildNodes()&&(b=b.startContainer.childNodes[b.startOffset])){var c=b.previousSibling;""==Jc(b)&&L(b);c&&""==Jc(c)&&L(c)}});
wq.prototype.cd=Z(4,function(){if(!this.isCollapsed()&&this.Q.htmlText){var b=this.Z(),c=this.ka(),d=this.Q.text,e=this.Q.duplicate();e.moveStart("character",1);e.moveStart("character",-1);e.text==d&&(this.Q=e);this.Q.text="";this.De();d=this.Z();e=this.wa();try{var g=b.nextSibling;b==c&&(b.parentNode&&3==b.nodeType&&g&&3==g.nodeType)&&(b.nodeValue+=g.nodeValue,L(g),this.Q=yq(d),this.Q.move("character",e),this.De())}catch(h){}}});Gq.prototype.cd=Z(3,function(){Kq(this).cd();this.De()});
Mq.prototype.cd=Z(2,function(){if(this.Q){for(var b=[],c=0,d=this.Q.length;c<d;c++)b.push(this.Q.item(c));z.forEach(b,L);this.collapse(n)}});Sq.prototype.cd=Z(1,function(){z.forEach(hq(this),function(b){b.cd()})});
a.mD=function(b,c){var d=c.md();b.td[d]&&b.Qb.log(fe,"Cannot register the same class of plugin twice.",i);b.td[d]=c;for(var e in Vv)c[Vv[e]]&&b.Gj[e].push(c);c.D=b;b.Ld()&&c.enable(b)},a.nD=function(b){return b.D&&b.D.hb},a.oD=function(b){var c=b.ga.parentNode;return new Xs(c,z.indexOf(c.childNodes,b.ga))},a.pD=function(b,c,d,e){return Jq(b,c,d,e)},a.qD=function(b){M.call(this);this.QI=fb();this.aE=fb();this.K=Vb(b.za());b.yh(this.K.w("SPAN",{id:this.QI}),this.K.w("SPAN",{id:this.aE}))};y(qD,cq);
qD.prototype.kp=function(b){L(kD(this,j));L(kD(this,n));return b};qD.prototype.pk=function(){var b=k,c=kD(this,j),d=kD(this,n);if(c&&d){var b=c.parentNode,c=z.indexOf(b.childNodes,c),e=d.parentNode,d=z.indexOf(e.childNodes,d);e==b&&(d-=1);b=Jq(b,c,e,d);b=this.kp(b);b.select()}else this.kp();return b};qD.prototype.z=function(){this.kp();this.K=k};
a.rD=function(b){var c;if(3==b.ga.nodeType)for(c=b.ga.previousSibling;c&&3==c.nodeType;c=c.previousSibling)b.offset+=Ys(c);else c=b.ga.previousSibling;var d=b.ga.parentNode;b.ga=c?c.nextSibling:d.firstChild;return b},a.sD=function(b,c){return c?Zs(b.Z(),b.wa()):Zs(b.ka(),b.Ka())},a.tD=function(b){for(var c=k,d=b.firstChild;d;){var e=d.nextSibling;3==d.nodeType?""==d.nodeValue?b.removeChild(d):c?(c.nodeValue+=d.nodeValue,b.removeChild(d)):c=d:(tD(d),c=k);d=e}},a.uD=function(b){var c=b&&b.nodeName.toLowerCase();
return!(!b||"block"!=(1!=b.nodeType?k:A?Zf(b,"display"):Yf(b,"display"))&&!("td"==c||"table"==c||"li"==c))},a.vD=function(b){return Kc(b,uD,j)},a.wD=function(b,c){if(c){var d,e=rD(sD(c,j)),g=oD(e),h=e.ga.previousSibling;3==e.ga.nodeType&&(e.ga=k);var l=rD(sD(c,n)),m=oD(l),p=l.ga.previousSibling;3==l.ga.nodeType&&(l.ga=k);d=function(){!e.ga&&h&&(e.ga=h.nextSibling,e.ga||(e=new Xs(h,Ys(h))));!l.ga&&p&&(l.ga=p.nextSibling,l.ga||(l=new Xs(p,Ys(p))));return Jq(e.ga||g.ga.firstChild||g.ga,e.offset,l.ga||
m.ga.firstChild||m.ga,l.offset)};var r=vD(c.Gb())}r?(r=zc(r,b),A?tD(r):r.normalize()):b&&(A?tD(b):b.normalize());return d?d():k},a.xD=function(b,c,d){Ut.call(this,c,b||lz.U(),d)};y(xD,Ut);a.yD=function(b){return b.getAttribute&&"true"==b.getAttribute("g_editable")},a.zD=function(b){qD.call(this,b)};y(zD,qD);zD.prototype.kp=function(b){var c=kD(this,j),d=kD(this,n),c=c&&d?zc(c,d):c||d;zD.n.kp.call(this);if(b)return wD(c,b);c&&(b=Xq(dc(Ub(c))),(b=wD(c,b))&&b.select())};
a.AD=function(b,c,d){for(var e=(c=1==c)?b.Z():b.ka(),g=c?b.wa():b.Ka(),h=b.Gb();e!=h&&e!=d&&!(c&&0!=g||!c&&g!=Ys(e));)var l=e.parentNode,e=z.indexOf(l.childNodes,e),g=c?e:e+1,e=l;return pD(c?e:b.Z(),c?g:b.wa(),c?b.ka():e,c?b.Ka():g)},a.BD=function(b){wg(b,n);if(fr)for(var c=b,b=b.parentNode;b&&"HTML"!=b.tagName;){if(vg?"none"==b.style[vg].toLowerCase():(A||tb)&&"on"==b.getAttribute("unselectable")){wg(b,n,j);for(var d=0,e=b.childNodes.length;d<e;d++){var g=b.childNodes[d];g!=c&&1==g.nodeType&&wg(b.childNodes[d],
j)}}c=b;b=b.parentNode}},a.CD=function(b){var c=b.target.tagName;"TEXTAREA"!=c&&"INPUT"!=c&&b.preventDefault()},a.DD=void 0,a.ED=function(b){var c=b.Gb();return b.Z()!=c.parentElement&&yD(c)||!!Kc(c,yD)},a.FD=function(b,c){var d=AD(b,1,c),d=AD(d,0,c),e=d.Z(),g=d.ka(),h=d.wa(),d=d.Ka();if(e==g){for(;g!=c&&0==h&&d==Ys(g);)e=g.parentNode,h=z.indexOf(e.childNodes,g),d=h+1,g=e;e=g}return Jq(e,h,g,d)},a.GD=function(b,c){fr&&c.e(b,"mousedown",CD,j);wg(b,j);for(var d=b.getElementsByTagName("INPUT"),e=0,g=
d.length;e<g;e++){var h=d[e];h.type in yr&&BD(h)}z.forEach(b.getElementsByTagName("TEXTAREA"),BD)},a.HD=function(b){return!!wr[b.tagName]},a.ID=function(b){return ot(O.filter(new mt(b),nt))},a.JD=void 0,a.KD=function(b){var c=arguments,d=c.length;return function(){for(var b=0;b<d;b++)if(!c[b].apply(this,arguments))return n;return j}},a.LD=function(b){this.Pf=b;this.xQ=j;this.Cw=[]},a.MD=function(b){b.Vv||(b.Vv=Jc(b.Pf));return b.Vv};a.ND=function(){Uv.call(this)};y(ND,Uv);ND.prototype.md=s("BTF");ND.prototype.Qb=pe("goog.editor.plugins.BasicTextFormatter");
a.OD={gK:"+link",aX:"+formatBlock",nX:"+indent",PX:"+outdent",sY:"+strikeThrough",jX:"+insertHorizontalRule",tY:"+subscript",uY:"+superscript",FY:"+underline",DW:"+bold",pX:"+italic",ZW:"+fontSize",YW:"+fontName",XW:"+foreColor",wW:"+backColor",NX:"+insertOrderedList",JY:"+insertUnorderedList",qX:"+justifyCenter",rX:"+justifyFull",tX:"+justifyRight",sX:"+justifyLeft"},a.PD=F.Um(OD);t=ND.prototype;t.Qe=function(b){return b in PD};t.Je=function(){return ww(this.D)};a.QD=function(b){return nD(b).za()};
t.of=function(b,c){var d,e,g,h,l,m=c;switch(b){case "+backColor":if(m!==k)if(lr){e=m;g=ww(this.D);var p,r;g&&g.isCollapsed()&&(p=nD(this).createTextNode(C?" ":""),m=g.Z(),r=1==m.nodeType?m:m.parentNode,""==r.innerHTML?(r.style.textIndent="-10000px",r.appendChild(p)):(r=nD(this).w("span",{style:"text-indent:-10000px"},p),g.ug(r)),lq(p).select());RD(this,"hiliteColor",e,n,j);p&&(C&&(p.data=""),r.style.textIndent="")}else tb?RD(this,"hiliteColor",m):RD(this,b,m);break;case "+link":a:{l=m;this.D.xf||
nD(this).Ta().focus();g=(e=this.Je())&&e.Gb();if((g=Lc(g,"A"))&&Kc(g,yD))qc(g);else{g=k;var w=[];if((m=e&&e.Gb())&&"IMG"==m.tagName)l=k;else{if(e&&e.isCollapsed())e=e.Ke(0).be(),cr?(g=nD(this).createElement("A"),e.insertNode(g)):br&&(e.pasteHTML("<a id='newLink'></a>"),g=nD(this).m("newLink"),g.removeAttribute("id"));else{var B=fb();RD(this,"CreateLink",B);z.forEach(this.D.m().getElementsByTagName("A"),function(b){Fa(b.href,B)&&w.push(b)});w.length&&(g=w.pop())}e=g;g=new LD(e);g.Pf.href="/";l&&(e.target=
l);w&&(g.Cw=w);l=g}if(l){if(!this.D.execCommand("link",l))if(h=this.D.Xk.prompt(mA,"http://"))if(e=l,g=MD(l)||h,m=e.Pf,m.href=h,p=MD(e),g!=p&&(h=At(m),3==h.nodeType&&(h=h.parentNode),Jc(h)!=p&&(h=m),lc(h),m=Vb(h),h.appendChild(m.createTextNode(g)),e.Vv=k),e.xQ=n,e=l.Pf,pr){g=e.nextSibling;if(!g||!(3==g.nodeType&&(Ea(g.data," ")||Ea(g.data," "))))g=Vb(e).createTextNode(" "),nc(g,e);Zq(g,1).select()}else ct(e,n);else{e=lq(l.Pf);e=new zD(e);qc(l.Pf);for(l.Pf=k;l.Cw.length;)qc(l.Cw.pop());e.restore().select();
l=k;break a}break a}}l=k}break;case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":RD(this,b,k,n,j);C&&RD(this,b,k,n,j);(!jr||!C)&&O.forEach(ww(this.D),SD);break;default:A&&("+formatBlock"==b&&m)&&(m="<"+m+">");if("+foreColor"==b&&m===k)break;switch(b){case "+indent":case "+outdent":jr&&(C&&(e=j),tb&&(e="+outdent"==b?!QD(this).queryCommandEnabled("outdent"):j));case "+insertOrderedList":case "+insertUnorderedList":if(p=sr)p=QD(this),p=TD(this,j,p,b,i);if(p)g="P"!=this.D.queryCommandValue("+defaultTag");
else if(!tr&&(A||tb)){d=this.Je();p=d.Gb();var H=QD(this);UD.lastIndex=0;UD.test(p.innerHTML)&&(d=d.Z()&&d.ka()?new qD(d):k,"P"==p.tagName?VD(p,j):(p.innerHTML=p.innerHTML.replace(UD,'<p$1 trtempbr="temp_br">'),p=z.toArray(p.getElementsByTagName("P")),O.forEach(p,function(b){if("temp_br"==b.getAttribute("trtempbr")){b.removeAttribute("trtempbr");if(lt(Ic(b))){var c=A?H.createTextNode(" "):H.createElement("BR");b.appendChild(c)}VD(b)}})),d.restore())}C&&(rr&&!this.queryCommandValue(b))&&(p=this.D.queryCommandValue("+defaultTag"),
"P"==p||"DIV"==p?p=n:(p=this.Je(),p.isCollapsed()&&3!=p.yc().nodeType?(d=nD(this).createTextNode(" "),p.insertNode(d,n),lq(d).select(),p=j):p=n),h|=p);case "+formatBlock":d=!!this.D.tj("Bidi");break;case "+subscript":case "+superscript":qr&&!this.queryCommandValue(b)&&(p="+subscript"==b?"+superscript":"+subscript",r=WD(p),this.queryCommandValue(p)||QD(this).execCommand(r,n,k),QD(this).execCommand(r,n,k));break;case "+underline":case "+bold":case "+italic":e=C&&jr&&this.queryCommandValue(b);break;
case "+foreColor":case "+fontName":e=jr&&C}RD(this,b,m,d,!!e);h&&QD(this).execCommand("Delete",n,j);g&&QD(this).execCommand("FormatBlock",n,"<div>")}C&&!this.D.ah&&nD(this).Ta().focus();return l};
t.queryCommandValue=function(b){var c;switch(b){case "+link":return b=(b=this.Je())&&b.Gb(),b=Lc(b,"A"),!!b&&!!Kc(b,yD);case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":return XD(this,b);case "+formatBlock":var b=ww(this.D),d=k;O.forEach(b,function(b,c,e){-1!=e.ec&&(b=vD(b).tagName,d=d||b,d!=b&&(d=k,f(O.fb)),e.Lp())});return d;case "+indent":case "+outdent":case "+insertHorizontalRule":return n;case "+fontSize":case "+fontName":case "+foreColor":case "+backColor":return this.ut(QD(this),
b,jr&&C);case "+underline":case "+bold":case "+italic":c=jr&&C;default:var e=QD(this);return TD(this,j,e,b,c)}};t.IH=function(b){hr&&b.match(/^\s*<script/i)&&(b="&nbsp;"+b);ir&&(b=b.replace(/<(\/?)strong([^\w])/gi,"<$1b$2"),b=b.replace(/<(\/?)em([^\w])/gi,"<$1i$2"));return b};
t.nM=function(b){for(var b=b.getElementsByTagName("IMG"),c=0,d;d=b[c];c++)if(A){d.removeAttribute("tabIndex");d.removeAttribute("tabIndexSet");var e=d;"removeAttribute"in e&&e.removeAttribute(sa);try{delete e[sa]}catch(g){}d.vR&&(d.tabIndex=d.vR)}};t.oM=function(b){if(D){for(var c=Wb(this.D.hb.Ja,"HEAD",i,i),d=[],e=c.length,g=1;g<e;++g)for(var h=c[g].getElementsByTagName("STYLE"),l=h.length,m=0;m<l;++m)d.push(h[m].outerHTML);return d.join("")+b}return b};
t.Xr=function(b,c,d){if(!d)return n;var e;switch(c){case "b":e="+bold";break;case "i":e="+italic";break;case "u":e="+underline";break;case "s":return j}return e?(this.D.execCommand(e),j):n};
a.UD=A?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi,a.VD=function(b,c){if(A||tb){var d=b.outerHTML.replace(/<(\/?)p/gi,"<$1div");c&&(d=d.replace(UD,"</div><div$1>"));tb&&!/<\/div>$/i.test(d)&&(d+="</div>");b.outerHTML=d}},a.WD=function(b){return 0==b.indexOf("+")?b.substring(1):b},a.SD=function(b){b=vD(b);b.align&&(b.style.textAlign=b.align,b.removeAttribute("align"))},a.RD=function(b,c,d,e,g){var h=k;e&&(h=b.D.queryCommandValue("rtl")?"rtl":b.D.queryCommandValue("ltr")?"ltr":k);var c=
WD(c),l,m;if(A){var p=c;m=[];var e=k,r=b.Je();l=nD(b);if(p in YD){var w=r&&r.Gb();if(w){for(var B=Xb("BLOCKQUOTE",k,w),H,G=0;G<B.length;G++)if(r.containsNode(B[G])){H=B[G];break}if(w=H||Lc(w,"BLOCKQUOTE"))e=l.w("div",{style:"height:0"}),w.appendChild(e),m.push(e),H?r=Jq(H,0,e,0):r.containsNode(e)&&(r=pD(r.Z(),r.wa(),e,0)),r.select()}}H=b.D;!H.sc()&&!e&&p in ZD&&(H=H.m(),r&&(r.isCollapsed()&&!tc(H))&&(e=r.Ke(0).be(),r=e.duplicate(),r.moveToElementText(H),r.collapse(n),r.isEqual(e)&&(r=l.createTextNode(" "),
H.appendChild(r),e.move("character",1),e.move("character",-1),e.select(),m.push(r))),e=l.w("div",{style:"height:0"}),H.appendChild(e),m.push(e));l=m[0];m=m[1]}if(D){l=c;var S;$D[l]&&(S=nD(b).w("div",{style:"height: 0"},"x"),b.D.m().appendChild(S));aE[l]&&(l=b.D.m(),S=nD(b).w("div",{style:"height: 0"},"x"),l.insertBefore(S,l.firstChild));l=S}if(C&&(S=c,Gb("1.9")&&"formatblock"==S.toLowerCase()&&(S=b.Je(),H=S.Z(),S.isCollapsed()&&(H&&"BODY"==H.tagName)&&(e=S.wa(),(H=H.childNodes[e])&&"BR"==H.tagName))))S=
S.be(),S.setStart(H,0),S.setEnd(H,0);if(ur&&"fontsize"==c.toLowerCase()){var X=FD(ww(b.D),b.D.m());O.forEach(O.filter(X,function(b,c,d){return 1==d.ec&&X.containsNode(b)}),function(b){Wf(b,"font-size","");C&&(0==b.style.length&&b.getAttribute("style")!=k)&&b.removeAttribute("style")})}S=QD(b);if(g&&jr&&(S.execCommand("styleWithCSS",n,j),tb)){H=[];e=ww(b.D).Gb();do H.push(e);while(e=e.parentNode);H=O.eM(O.fd(ww(b.D)),O.fd(H));H=O.filter(H,uD);O.forEach(H,function(b){var c=b.style.outline;b.style.outline=
"0px solid red";b.style.outline=c})}S.execCommand(c,n,d);g&&jr&&S.execCommand("styleWithCSS",n,n);D&&(!Gb("526")&&"formatblock"==c.toLowerCase()&&d&&/^[<]?h\d[>]?$/i.test(d))&&O.forEach(b.Je(),function(b){"Apple-style-span"==b.className&&(b.style.fontSize="",b.style.fontWeight="")});if(/insert(un)?orderedlist/i.test(c)){if(D){var ja=n;O.forEach(b.Je(),function(b){var c=b.tagName;if("UL"==c||"OL"==c)if(ja){if(c=uc(b)){var d=b.ownerDocument.createRange();d.setStartAfter(c);d.setEndBefore(b);if(Ha(d.toString())&&
c.nodeName==b.nodeName){for(;c.lastChild;)b.insertBefore(c.lastChild,b.firstChild);c.parentNode.removeChild(c)}}}else ja=j})}if(A){for(c=(c=b.Je())&&c.yc();c&&"UL"!=c.tagName&&"OL"!=c.tagName;)c=c.parentNode;c&&(c=c.parentNode);c&&(d=z.toArray(c.getElementsByTagName("UL")),z.extend(d,z.toArray(c.getElementsByTagName("OL"))),z.forEach(d,function(b){var c=b.type;if(c&&!("UL"==b.tagName?bE:cE)[c])b.type=""}));m&&L(m)}}l&&L(l);h&&b.D.execCommand(h)},a.ZD={indent:1,outdent:1,insertOrderedList:1,insertUnorderedList:1,
justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,ltr:1,rtl:1},a.YD={insertOrderedList:1,insertUnorderedList:1},a.cE={1:1,a:1,A:1,i:1,I:1},a.bE={disc:1,circle:1,square:1},a.$D={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},a.aE={insertOrderedList:1,insertUnorderedList:1},a.dE={center:1,justify:1,right:1,left:1},a.XD=function(b,c){var d=c.replace("+justify","").toLowerCase();"full"==d&&(d="justify");var e=b.D.tj("Bidi");if(e)return d==e.MZ();var g=b.Je();if(!g)return n;
for(var h=g.Gb(),e=z.filter(h.childNodes,function(b){return nt(b)&&g.containsNode(b,j)}),e=e.length?e:[h],h=0;h<e.length;h++){var l=vD(e[h]),m=d,p=$f(l,"textAlign"),p=p.replace(/^-(moz|webkit)-/,"");dE[p]||(p=l.align||"left");if(m!=p)return n}return j};ND.prototype.ut=function(b,c,d){return TD(this,n,b,c,d)};a.TD=function(b,c,d,e,g){e=WD(e);if(g){var h=QD(b);h.execCommand("styleWithCSS",n,j)}b=c?d.queryCommandState(e):d.queryCommandValue(e);g&&h.execCommand("styleWithCSS",n,n);return b};a.eE=function(b,c){M.call(this);this.ft=[];for(this.at=[];b&&"BODY"!=b.nodeName&&b!=c;){for(var d=0,e=b.previousSibling;e;)e=e.previousSibling,++d;this.ft.unshift(d);this.at.unshift(b.nodeName);b=b.parentNode}};y(eE,M);eE.prototype.toString=function(){for(var b=[],c,d=0;c=this.at[d];d++)b.push(this.ft[d]+","+c);return b.join("\n")};a.fE=function(b,c){for(var d,e=c,g=0;d=b.at[g];++g)if(e=e.childNodes[b.ft[g]],!e||e.nodeName!=d)return k;return e};eE.prototype.z=function(){delete this.ft;delete this.at};pe("goog.editor.plugins.Blockquote");a.hE=function(){Uv.call(this)};y(hE,Uv);t=hE.prototype;t.Ah="DIV";t.md=s("EnterHandler");t.enable=function(b){hE.n.enable.call(this,b);vr&&("P"==this.Ah||"DIV"==this.Ah)&&nD(this).za().execCommand("opera-defaultBlock",n,this.Ah)};t.IH=function(b){return!b||lt(b)?hr?this.WN():"":b};t.WN=of("<br>");
t.LO=function(b){if(C&&this.D.ah)return n;if(8==b.keyCode){var c=ww(this.D),d=this.D.m(),c=c&&c.Z();d.firstChild==c&&Mt(c)&&(b.preventDefault(),b.stopPropagation())}else if(13==b.keyCode)if(C){if(!b.shiftKey){var d=ww(this.D),c=!d||d.isCollapsed(),e=cr?iE(this):jE(this),g=this.D.execCommand("+splitBlockquote",e);g&&(b.preventDefault(),b.stopPropagation());cr||e.removeNode(j);g||this.AO(b,c,d)}}else{this.D.Yh();d=cr?iE(this):jE(this);if(c=!!this.D.execCommand("+splitBlockquote",d))b.preventDefault(),
b.stopPropagation();cr||d.removeNode(j);D&&this.BO(b);if(A||tb)kE(this);else if(!c&&D){if(c=d=ww(this.D))a:{for(c=d.Gb();c;c=c.parentNode)if(HD(c)){c="BLOCKQUOTE"==c.tagName;break a}c=n}if(c){c=nD(this);e=c.createElement("BR");d.insertNode(e,j);if(d=HD(e.parentNode)){for(d=e.nextSibling;d&&3==d.nodeType&&!d.nodeValue;)d=d.nextSibling;d=!d}d&&mc(c.createElement("BR"),e);ct(e,n);b.preventDefault()}}this.D.He()}else if(C&&46==b.keyCode&&(c=ww(this.D),c.isCollapsed()&&(d=c.ka(),1==d.nodeType&&(c=d.childNodes[c.Ka()])&&
"BR"==c.tagName)))e=ot(O.filter(new mt(c,n,j),nt)),g=c.nextSibling,d.removeChild(c),b.preventDefault(),g&&HD(g)&&(e&&!("BR"==e.tagName||HD(e))?Zq(e,Ys(e)).select():(b=At(g),Zq(b,0).select()));return n};t.Wr=function(b){if(C&&this.D.ah)return n;(A||tb)&&13==b.keyCode&&kE(this,j);return n};t.BO=ha;t.AO=ha;
a.lE=F.Wh("LI","DIV","H1","H2","H3","H4","H5","H6"),a.kE=function(b,c){for(var d=ww(b.D),e=d.yc(),g=b.D.m(),h;e&&e!=g;){var l=e.nodeName;if("DIV"==l||lE[l]&&(!c||!(Mt(e)&&1==e.getElementsByTagName("BR").length))){if(tb&&h){"DIV"==l&&(h==e.lastChild&&Mt(h))&&(nc(h,e),lq(h).select());break}return}tb&&(c&&"P"==l&&"DIV"!=l)&&(h=e);e=e.parentNode}if(A&&!Gb(9)){var m=n,d=d.be(),e=d.duplicate();e.moveEnd("character",1);if(e.text.length&&(m=e.parentElement(),e=e.duplicate(),e.collapse(n),e=e.parentElement(),
m=m!=e&&e!=d.parentElement()))d.move("character",-1),d.select()}b.D.hb.za().execCommand("FormatBlock",n,"<DIV>");m&&(d.move("character",1),d.select())},a.jE=function(b){var b=nD(b).za(),c=b.selection.createRange(),d=fb();c.pasteHTML('<span id="'+d+'"></span>');b=b.getElementById(d);b.id="";return b},a.iE=function(b){b=ww(b.D);if(!b.isCollapsed()){var c=j;if(tb){var d=b.Z(),e=b.wa();d==b.ka()&&(d.lastChild&&"BR"==d.lastChild.tagName&&e==d.childNodes.length-1)&&(c=n)}if(c){var g=b;if(g&&!g.isCollapsed()){var h=
j,c=g.Gb(),d=new eE(g.Z(),c),e=g.wa(),l;l=g;var m=l.Z();uD(m)&&(m=m.childNodes[l.wa()]||m);var m=vD(m),p=l.ka();uD(p)&&(p=p.childNodes[l.Ka()]||p);p=vD(p);l=m==p;if(m=!l)a:{var p=g,m=p.ka(),p=p.Ka(),r=m;if(uD(r)){var w=r.childNodes[p];if(!w||1==w.nodeType&&uD(w)){m=n;break a}}for(w=vD(r);w!=r;){if(ID(r)){m=j;break a}r=r.parentNode}m=p!=Ys(m)}g.cd();(g=fE(d,c))?g=Zq(g,e):(g=Zq(c,c.childNodes.length),h=n);g.select();l&&(l=vD(g.Z()),Mt(l,j)&&(h="&nbsp;",tb&&"LI"==l.tagName&&(h="<br>"),l.innerHTML=h,
Lt(l.firstChild),h=n));m&&(g=vD(g.Z()),l=ID(g),g&&l&&(kc(g,l.childNodes),L(l)));h&&(g=Zq(fE(d,c),e),g.select())}}}return sD(b,j)};a.mE=function(){},a.nE=new mE,a.oE=["click",C?"keypress":"keydown"];mE.prototype.e=function(b,c,d,e,g){function h(b){if("click"==b.type&&rd(b))c.call(e,b);else if(13==b.keyCode||3==b.keyCode)b.type="keypress",c.call(e,b)}h.Uj=c;h.hU=e;g?g.e(b,oE,h):N(b,oE,h)};mE.prototype.ya=function(b,c,d,e,g){for(var h=0;d=oE[h];h++){var l;l=Cd(b,d,n)||[];for(var m,p=0;m=l[p];p++)if(m.lg.Uj==c&&m.lg.hU==e){g?g.ya(b,d,m.lg):Bd(b,d,m.lg);break}}};a.qE=function(b){M.call(this);this.Lk=b||window;this.Rs=N(this.Lk,"resize",this.Fx,n,this);this.pc=ac(this.Lk);if(D&&nb||tb&&this.Lk.self!=this.Lk.top)this.xu=window.setInterval(v(this.UC,this),pE)};y(qE,Kd);a.pE=500;t=qE.prototype;t.Rs=k;t.Lk=k;t.pc=k;t.xu=k;t.Ll=function(){return this.pc?this.pc.clone():k};t.z=function(){qE.n.z.call(this);this.Rs&&(Dd(this.Rs),this.Rs=k);this.xu&&(window.clearInterval(this.xu),this.xu=k);this.pc=this.Lk=k};t.Fx=function(){this.UC()};
t.UC=function(){var b=ac(this.Lk);Sb(b,this.pc)||(this.pc=b,this.dispatchEvent("resize"))};a.sE=function(b,c){M.call(this);this.K=Vb(b);this.S=new qe(this);this.zB=new qE(this.K.Ta());this.rd={};this.Bd=this.K.w("DIV",{className:rE});Q(this.Bd,n);b.appendChild(this.Bd);Wf(this.Bd,"zIndex",c);this.un=this.Bd;this.sM=this.K.w("DIV",{className:"tr_bubble_closebox",innerHTML:"&nbsp;"});this.un.appendChild(this.sM);GD(this.Bd,this.S);this.zi=new Wh(this.Bd)};y(sE,Kd);a.rE="tr_bubble";t=sE.prototype;t.Qb=pe("goog.ui.editor.Bubble");
t.z=function(){sE.n.z.call(this);L(this.Bd);this.Bd=k;this.S.H();this.S=k;this.zB.H();this.zB=k};t.fa=q("un");t.Gb=q("Bd");t.wP=function(){this.V()&&this.pa()};t.cP=function(){for(var b in this.rd)L(this.rd[b].element);this.rd={};E.remove(this.Bd,"tr_multi_bubble");this.S.Sc();this.dispatchEvent("hide")};t.V=function(){return this.zi.V()};a.tE=A?4:2,a.uE=new Rf(tE,0,tE,0);
sE.prototype.pa=function(){var b=k,c=j,d;for(d in this.rd)var e=this.rd[d],b=e.ZA,c=c&&e.nT;d=496;b=hg(this.Bd)!=hg(b);c&&(d=vE(this,b?7:5,4,9));d&496&&(d=vE(this,b?6:4,5,9));d&496&&(d=vE(this,b?7:5,4,5),d&496&&this.Qb.Ik("reposition(): positionAtAnchor() failed with "+d))};
a.vE=function(b,c,d,e){var g=k,h;for(h in b.rd){var l=b.rd[h].ZA;if(!g||vc(l,g))g=b.rd[h].ZA}return Pm(g,c,b.Bd,d,k,uE,e)},a.wE=function(b,c,d,e,g,h){this.type=d;this.ZA=g;this.nT=h;this.element=b.w("DIV",{className:"tr_bubble_panel",id:c},b.w("DIV",{className:"tr_bubble_panel_title"},e+":"),b.w("DIV",{className:"tr_bubble_panel_content"}))};wE.prototype.fa=function(){return this.element.lastChild};a.xE=function(){Uv.call(this);this.kc=new qe(this)};y(xE,Uv);a.yE=function(b,c){return new sE(b,c)},a.zE={};t=xE.prototype;t.bk=k;t.qy=n;t.md=of("AbstractBubblePlugin");t.Wr=function(){this.V()&&this.Aj();return n};
t.Aj=function(b,c){var d;if(b)d=b.target;else if(c)d=c;else{var e=ww(this.D);if(e){var g=e.Z(),h=e.ka(),l=e.wa(),m=e.Ka();A&&(e.isCollapsed()&&g!=h)&&(e=Zq(g,l));1==g.nodeType&&(g==h&&l==m-1)&&(g=g.childNodes[l],1==g.nodeType&&(d=g))}d=d||e&&e.Gb()}var p;a:{if(d&&(l=this.TN(d))){if(l!=this.gu||!this.bk){AE(this);this.ph&&gt(this.ph);d=BE(this);var r=this.Tw();if(!F.some(d.rd,function(b){return b.type==r})){this.gu=l;var g=this.Tw(),m=this.yE(),h=v(this.KM,this),w=this.EU(),e=fb(),l=new wE(d.K,e,g,
m,l,!w);d.rd[e]=l;m=0;for(w=d.un.childNodes.length-1;m<w;m++){var B=d.un.childNodes[m];if(d.rd[B.id].type>g){p=B;break}}mc(l.element,p||d.un.lastChild);h(l.fa());GD(l.element,d.S);p=F.bb(d.rd);1==p?(d.S.e(d.zB,"resize",d.wP).e(d.zi,"hide",d.cP),d.zi.F(j),d.pa()):2==p&&E.add(d.Bd,"tr_multi_bubble");d.pa();this.bk=e;this.kc.e(d,"hide",this.ZE);this.xi();this.qy&&this.kc.e(d.fa(),"keydown",this.HR);this.kc.e(d.fa(),"mouseover",function(){this.ph&&this.ph.stop()},this)}}else this.ph&&this.ph.stop();p=
n;break a}AE(this);p=n}return p};t.disable=function(b){if(b.Vj==gw){var c=zE[b.id];c&&(c.H(),delete zE[b.id])}};a.BE=function(b){var c=b.$Y||b.D.Xk.document.body;b.K=Vb(c);var d=zE[b.D.id];d||(d=yE.call(k,c,b.D.UL||0),zE[b.D.id]=d);return d};t.Tw=s("");t.yE=s("");t.EU=pf;
a.AE=function(b){if(b.bk&&(!b.ph||!b.ph.bc()))b.ph=new Gj(function(){if(this.bk){var b=BE(this),d=this.bk;L(b.rd[d].element);delete b.rd[d];d=F.bb(b.rd);1>=d&&E.remove(b.Bd,"tr_multi_bubble");0==d?b.zi.F(n):b.pa();this.ZE()}},250,b),b.ph.start()};t.xi=ha;t.ZE=function(){this.bk=this.gu=k;this.kc.Sc()};t.Bx=function(b){if(this.qy&&this.V()&&9==b.keyCode&&!b.shiftKey){var c=BE(this).fa();if(c=J("tr_bubble_link",c))return c.focus(),b.preventDefault(),j}return n};
t.HR=function(b){if(this.V()&&9==b.keyCode){var c=BE(this).fa(),c=Yb("tr_bubble_link",c);if(b.shiftKey?c[0]==b.target:c.length&&c[c.length-1]==b.target)this.D.focus(),b.preventDefault()}};t.V=function(){return!!this.bk};t.pa=function(){var b=BE(this);b&&b.pa()};
t.ir=function(b,c,d,e,g){c=this.K.w("SPAN",{className:"tr_bubble_link"},g?this.K.w("I",{className:g},c):c);this.qy&&c.setAttribute("tabindex",0);c.setAttribute("role","link");e?e.appendChild(c):(e=this.K.m(b))&&pc(c,e);c.id=b;GD(c,this.kc);d&&(b=this.kc,nE.e(c,d,i,b.ha||b,b));return c};x("Go to link: ");x("Change");x("Remove");a.CE=function(b){M.call(this);this.jd=b};y(CE,Kd);CE.prototype.show=function(){this.kf||(this.kf=this.Pv(),this.kf.addEventListener(ki,this.cO,n,this));this.kf.F(j)};CE.prototype.hide=function(){this.kf&&this.kf.F(n)};CE.prototype.sb=function(){return!!this.kf&&this.kf.V()};a.DE=function(b){this.rl=b;this.Qi=new ai("",j,this.rl.jd);this.xn=new ii(this.rl.jd);this.wn={};this.Mh("tr-dialog")};DE.prototype.lb=function(b){this.Qi.lb(b);return this};
a.EE=function(b,c){var d=x("OK");b.xn.set("ok",c||d,j);b.wn.ok=v(b.rl.$O,b.rl)},a.FE=function(b){var c=pi,d=x("取消");b.xn.set(c,d,n,j);b.wn[c]=v(b.rl.ox,b.rl);return b};DE.prototype.xe=function(b,c,d){d=d||fb();this.xn.set(d,b);this.wn[d]=c;return this};DE.prototype.Mh=function(b){E.add(di(this.Qi),b);return this};DE.prototype.Na=function(b){this.Qi.fa().appendChild(b);return this};
a.GE=function(b){b.xn.Jb()&&(EE(b),FE(b));mi(b.Qi,b.xn);var c=b.wn;b.wn=k;b.Qi.addEventListener(ni,function(b){if(c[b.key])return c[b.key](b)});gi(b.Qi,j);var d=b.Qi;b.Qi=k;return d};t=CE.prototype;t.Uw=function(b){return this.kf.uc.ld(b)};t.$O=function(b){return(b=this.Fn(b))?this.dispatchEvent(b):n};t.ox=function(){return this.dispatchEvent("cancel")};t.z=function(){this.kf&&(this.hide(),this.kf.H(),this.kf=k);CE.n.z.call(this)};t.cO=function(){this.dispatchEvent("afterhide")};a.HE=function(b){Uv.call(this);this.AM=b};y(HE,Uv);t=HE.prototype;t.Qe=function(b){return b==this.AM};t.execCommand=function(b,c){return this.of.apply(this,arguments)};t.Ww=q("rb");t.of=function(b,c){this.jI||IE(this);this.rb||(this.rb=this.Ov(Vb(this.D.Xk),c));var d=ww(this.D);this.cA=d&&new zD(d);Ot(this.D.hb.Ta());Ad(this.rb,"afterhide",this.fo,n,this);this.D.ah=j;this.rb.show();this.dispatchEvent("dialogOpened");Yv(this.D);return j};
t.fo=function(){this.D.ah=n;JE(this);this.jI||IE(this);this.dispatchEvent("dialogClosed");Yv(this.D);this.D.nr.selectionchange=za()};a.JE=function(b){b.cA&&(b.cA.restore(),b.cA=k);b.D.focus()};t.z=function(){IE(this);HE.n.z.call(this)};t.jI=n;t.fy=n;a.IE=function(b){b.rb&&!b.fy&&(b.fy=j,b.rb.H(),b.rb=k,b.fy=n)};a.KE=function(){};y(KE,fp);ia(KE);t=KE.prototype;t.P=s("goog-tab");t.xc=function(){return Zc.ZB};t.w=function(b){var c=KE.n.w.call(this,b);(b=b.gg())&&this.Wc(c,b);return c};t.o=function(b,c){var c=KE.n.o.call(this,b,c),d=this.gg(c);d&&b.Tt(d);if(b.da&8&&(d=b.getParent())&&qa(d.Km))b.dc(8,n),d.Km(b);return c};t.gg=function(b){return b.title||""};t.Wc=function(b,c){b&&(b.title=c||"")};a.LE=function(b,c,d){op.call(this,b,c||KE.U(),d);rp(this,8,j);this.vk|=9};y(LE,op);LE.prototype.gg=q("Xp");LE.prototype.Wc=function(b){this.N.Wc(this.m(),b);this.Tt(b)};LE.prototype.Tt=ca("Xp");mp("goog-tab",function(){return new LE(k)});a.ME=function(){};y(ME,Mp);ia(ME);ME.prototype.P=s("goog-tab-bar");ME.prototype.xc=function(){return Zc.GK};ME.prototype.qA=function(b,c,d){this.uG||(this.Xq||NE(this),this.uG=F.Um(this.Xq));var e=this.uG[c];e?(b.Cp(e==OE||e==PE?Pp:Op),b.vG=e):ME.n.qA.call(this,b,c,d)};ME.prototype.sf=function(b){var c=ME.n.sf.call(this,b);this.Xq||NE(this);c.push(this.Xq[b.vG]);return c};a.NE=function(b){var c=b.P();b.Xq=F.create(QE,c+"-top",RE,c+"-bottom",OE,c+"-start",PE,c+"-end")};a.TE=function(b,c,d){b=b||QE;this.Cp(b==OE||b==PE?Pp:Op);this.vG=b;Ut.call(this,this.zb,c||ME.U(),d);SE(this)};y(TE,Ut);a.QE="top",a.RE="bottom",a.OE="start",a.PE="end";t=TE.prototype;t.NL=j;t.Df=k;t.C=function(){TE.n.C.call(this);SE(this)};t.z=function(){TE.n.z.call(this);this.Df=k};t.removeChild=function(b,c){UE(this,b);return TE.n.removeChild.call(this,b,c)};t.lA=function(b){TE.n.lA.call(this,b);this.NL&&this.Km(Vh(this,b))};t.Km=function(b){b?b.Jm(j):this.Df&&this.Df.Jm(n)};
a.UE=function(b,c){if(c&&c==b.Df){for(var d=jt(b,c),e=d-1;c=Vh(b,e);e--)if(c.V()&&c.isEnabled()){b.Km(c);return}for(d+=1;c=Vh(b,d);d++)if(c.V()&&c.isEnabled()){b.Km(c);return}b.Km(k)}};t.mP=function(b){this.Df&&this.Df!=b.target&&this.Df.Jm(n);this.Df=b.target};t.nP=function(b){b.target==this.Df&&(this.Df=k)};t.kP=function(b){UE(this,b.target)};t.lP=function(b){UE(this,b.target)};t.Le=function(){Xt(this)||this.wd(this.Df||Vh(this,0))};
a.SE=function(b){b.h().e(b,"select",b.mP).e(b,"unselect",b.nP).e(b,"disable",b.kP).e(b,"hide",b.lP)};mp("goog-tab-bar",function(){return new TE});a.VE=function(){Uv.call(this)};y(VE,Uv);VE.prototype.Xr=function(b){if(C&&this.D.ah)b=n;else if(9==b.keyCode&&!b.metaKey&&!b.ctrlKey){var c=ww(this.D);Lc(c.Gb(),"LI")||O.some(c,function(b){return"LI"==b.tagName})?(this.D.execCommand(b.shiftKey?"+outdent":"+indent"),b.preventDefault(),b=j):b=n}else b=n;return b};a.WE=function(){Uv.call(this)};y(WE,VE);WE.prototype.md=s("ListTabHandler");a.XE=function(b){Uv.call(this);this.fR=b};y(XE,Uv);t=XE.prototype;t.md=of("LoremIpsum");t.yq=qf;t.dq=n;t.queryCommandValue=function(b){return"usinglorem"==b&&this.dq};
t.execCommand=function(b,c){if("clearlorem"==b){var d=!!c,e=this.D;if(this.dq&&!e.ah){var g=e.m();g||(g=e.Rc);this.dq=n;g.style.fontStyle=this.uR;e.ne(j,k,j);d&&e.Ld()&&(D?(Ub(e.m()).body.focus(),e.dg()):tb&&Bw(e))}}else"updatelorem"==b&&(d=this.D,!this.dq&&(!d.ah&&iw!=d.id)&&((e=d.m())||(e=d.Rc),Mt(e)&&(this.dq=j,this.uR=e.style.fontStyle,e.style.fontStyle="italic",d.ne(j,this.fR,j))))};t.Qe=function(b){return"clearlorem"==b||"updatelorem"==b||"usinglorem"==b};a.YE=function(b){this.xC=b};y(YE,Kd);a.ZE=function(){M.call(this);this.bR=100;this.Rd=[];this.ik=[];this.lt=[]};y(ZE,Kd);t=ZE.prototype;t.ms=k;t.oB=function(){$E(this,this.Rd,this.ik)};t.Qz=function(){$E(this,this.ik,this.Rd)};a.$E=function(b,c,d){if(c.length){var e=c.pop();d.push(e);b.lt.push({type:c==b.Rd?"before_undo":"before_redo",vE:c==b.Rd?e.oB:e.Qz,state:e});1==b.lt.length&&b.Tg();(0==c.length||1==d.length)&&b.dispatchEvent("state_change")}};
t.Tg=function(){if(!(this.ms||0==this.lt.length)){var b=this.lt.shift();this.dispatchEvent({type:b.type,state:b.state})&&(b.state.xC?(this.ms=N(b.state,"action_completed",this.zN,n,this),b.vE.call(b.state)):(b.vE.call(b.state),this.Tg()))}};t.zN=function(){Dd(this.ms);this.ms=k;this.Tg()};a.aF=function(b){Uv.call(this);b=b||new ZE;this.xG&&Dd(this.xG);this.oe=b;this.xG=N(this.oe,"state_change",this.iN,n,this);this.qj={};this.Jn={};this.HF=k;this.WL=v(this.ZT,this)};y(aF,Uv);aF.prototype.Qb=pe("goog.editor.plugins.UndoRedo");aF.prototype.qo=k;a.bF=F.Um({HY:"+undo",ZX:"+redo"});t=aF.prototype;t.Qe=function(b){return b in bF};t.rJ=function(b){this.disable(b);this.D=k};
t.enable=function(b){if(!this.isEnabled(b)){xw(b);var c=new qe(this);C||c.e(b,"beforechange",this.eO);c.e(b,cw,this.lO);c.e(b,"blur",this.nx);this.qj[b.$g]=c;cF(this,b)}};t.disable=function(b){xw(b);var c=this.qj[b.$g];c&&(c.H(),delete this.qj[b.$g]);this.Jn[b.$g]&&delete this.Jn[b.$g]};t.isEnabled=function(b){return!!this.qj[b.$g]};t.z=function(){aF.n.z.call(this);for(var b in this.qj)this.qj[b].H(),delete this.qj[b];this.D=k;this.oe&&(this.oe.H(),delete this.oe)};t.md=s("UndoRedo");
t.execCommand=function(b){"+undo"==b?this.oe.oB():"+redo"==b&&this.oe.Qz()};t.queryCommandValue=function(b){var c=k;"+undo"==b?c=0<this.oe.Rd.length:"+redo"==b&&(c=0<this.oe.ik.length);return c};t.iN=function(){this.D.dispatchEvent({type:"cvc",BM:["+redo","+undo"]})};
t.ZT=function(b,c,d){var e=this.D;if(e){Xv(e,j,j);try{e.Yh();e.execCommand("clearlorem",j);e.m().innerHTML=c;d&&d.select();var g=this.D;e.focus();g&&g.$g!=b.Vn&&g.execCommand("updatelorem");var h=this.Jn[b.Vn];h.Li=c;h.pJ=d}catch(l){this.Qb.log(fe,"Error while restoring undo state",l)}finally{this.qo=b,e.He(),Yv(e)}}};
t.Xr=function(b,c,d){if(d){var e;"z"==c?e=b.shiftKey?"+redo":"+undo":"y"==c&&(e="+redo");if(e)return(b="+undo"==e?this.oe.Rd[this.oe.Rd.length-1]:this.oe.ik[this.oe.ik.length-1])&&b.Vn?this.D.execCommand(e):this.execCommand(e),j}return n};t.eO=function(b){if(!this.qo){var b=b.target,c=b.$g;this.HF!=c&&(this.HF=c,cF(this,b))}};t.lO=function(b){this.qo?(b=this.qo,this.qo=k,b.dispatchEvent("action_completed")):cF(this,b.target)};t.nx=function(b){(b=b.target)&&xw(b)};
a.cF=function(b,c){var d=c.$g,e,g;c.queryCommandValue("usinglorem")?(e="",g=k):(e=c.m().innerHTML,g=new dF(c),g=!g.isValid()?k:g);var h=b.Jn[d];if(h){if(h.Li==e)return;if(""==e||""==h.Li){var l=c.xt(8,"",{});if(e==l&&""==h.Li||h.Li==l&&""==e)return}h.Rz=e;h.BT=g;l=b.oe;if(0==l.Rd.length||!h.Zf(l.Rd[l.Rd.length-1])){l.Rd.push(h);l.Rd.length>l.bR&&l.Rd.shift();var m=l.ik.length;l.ik.length=0;l.dispatchEvent({type:"state_added",state:h});(1==l.Rd.length||m)&&l.dispatchEvent("state_change")}}b.Jn[d]=
new eF(d,e,g,b.WL)},a.eF=function(b,c,d,e){this.xC=j;this.Vn=b;this.hI=e;this.Li=c;this.pJ=d};y(eF,YE);eF.prototype.oB=function(){this.hI(this,this.Li,this.pJ)};eF.prototype.Qz=function(){this.hI(this,this.Rz,this.BT)};eF.prototype.Zf=function(b){return this.Vn==b.Vn&&this.Li==b.Li&&this.Rz==b.Rz};
a.dF=function(b){this.$d=b;var c=b.hb.Ta(),b=(b=ww(b))&&b.jg()&&b.Ta()==c?b:k;if(cr){if(c=b,this.Ds=n,c){var d=iq(c),e=jq(c);if(d&&e){var b=c.pi()?c.Ka():c.wa(),d=new eE(d,this.$d.m()),g=kq(c),e=new eE(e,this.$d.m());c.pi()?(this.Fa=e,this.MA=g,this.Ca=d,this.uw=b):(this.Fa=d,this.MA=b,this.Ca=e,this.uw=g);this.Ds=j}}}else br&&(c=b,this.Ds=n,c&&(b=c.Ke(0).be(),vc(this.$d.m(),b.parentElement())&&(c=this.$d.hb.za().body.createTextRange(),c.moveToElementText(this.$d.m()),e=b.duplicate(),e.collapse(j),
e.setEndPoint("StartToStart",c),this.Fa=fF(e),b=b.duplicate(),b.setEndPoint("StartToStart",c),this.Ca=fF(b),this.Ds=j)))};dF.prototype.isValid=q("Ds");dF.prototype.toString=function(){return cr?"W3C:"+this.Fa.toString()+"\n"+this.MA+":"+this.Ca.toString()+"\n"+this.uw:"IE:"+this.Fa+","+this.Ca};dF.prototype.select=function(){var b=this.Je(this.$d.m());b&&(br&&this.$d.m().focus(),Yq(b).select())};
dF.prototype.Je=function(b){if(cr){var c=fE(this.Fa,b),b=fE(this.Ca,b);return!c||!b?k:Jq(c,this.MA,b,this.uw).be()}c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);c.collapse(j);c.moveEnd("character",this.Ca);c.moveStart("character",this.Fa);return c};
a.fF=function(b){var c=b.duplicate(),d=b.text,e=d.length;c.collapse(j);c.moveEnd("character",e);for(var g,h=10;(g=c.compareEndPoints("EndToEnd",b))&&!(e-=g,c.moveEnd("character",-g),--h,0==h););b=0;for(c=d.indexOf("\n\r");-1!=c;)++b,c=d.indexOf("\n\r",c+1);return e+b};a.gF=function(b,c){Lp.call(this,b||kz.U(),c)};y(gF,Lp);mp("goog-toolbar-separator",function(){return new gF});a.iF=function(b,c){M.call(this);this.ha=new qe(this);this.$d=b;this.vb=c;this.Mz=[];Th(this.vb,function(b){b.kb&&this.Mz.push(hF(b.ce()))},this);this.vb.Ze(n);this.ha.e(this.$d,"cvc",this.SV).e(this.vb,"action",this.mx)};y(iF,Kd);a.hF=function(b){return b};t=iF.prototype;t.h=q("ha");t.Nr=q("$d");t.V=function(){return this.vb.V()};t.F=function(b){this.vb.F(b)};t.isEnabled=function(){return this.vb.isEnabled()};t.Ya=function(b){this.vb.Ya(b)};t.blur=function(){this.vb.$c(k)};
t.z=function(){iF.n.z.call(this);this.ha&&(this.ha.H(),delete this.ha);this.vb&&(this.vb.H(),delete this.vb);delete this.$d;delete this.Mz};t.SV=function(b){if(this.vb.isEnabled()&&this.dispatchEvent("change")){var c;try{c=this.$d.queryCommandValue(b.BM||this.Mz)}catch(d){c={}}var b=c,e;for(e in b)if(c=Rh(this.vb,e)){var g=b[e];c.Mi?c.Mi(g):c.Vc(!!g)}}};t.mx=function(b){var c=b.target.ce();this.$d.execCommand(c,b.target.X())};a.jF=function(b){this.uN=b};y(jF,kd);jF.prototype.type="ok";a.kF=function(b){kd.call(this,"change");this.isValid=b};y(kF,kd);a.lF=function(b){return!b?"":"//www.zhihu.com/equation?tex="+encodeURIComponent(b)};a.mF=function(b){T.call(this,b)};y(mF,T);mF.prototype.Bj="";mF.prototype.F=function(b){Q(this.m(),b)};a.oF=function(b,c,d,e,g,h,l,m){this.Ki=c;this.Sk=l||[];for(var c=m||nF.U(),m=[],d=-d,e=-e,p=0;p<l.length;p++)m.push(K("DIV",{"class":c.P()+"-item",style:"width:"+g+"px;height:"+h+"px;background-position:"+d+"px "+e+"px;"})),d-=g;this.qg=b;Dz.call(this,m,c)};y(oF,Dz);t=oF.prototype;t.ji=q("Ki");t.Cl=function(b){return 0<=b&&b<this.Sk.length?this.Sk[b]:k};t.hg=function(b){oF.n.hg.call(this,b);this.qg.dispatchEvent(new pF(qF,this))};
t.ki=function(b){oF.n.ki.call(this,b);b.relatedTarget&&!vc(this.m(),b.relatedTarget)&&this.qg.Xv()};t.nd=function(b){oF.n.nd.call(this,b);b.relatedTarget&&!vc(this.m(),b.relatedTarget)&&this.qg.Yv.stop()};a.pF=function(b,c,d){kd.call(this,b,d);this.cT=c},a.qF="a";pF.prototype.dx=q("cT");a.nF=function(){};y(nF,vz);ia(nF);nF.prototype.P=s("ee-palette");a.rF=function(b){oF.call(this,b,"a",0,150,18,18,"\\leftarrow \\rightarrow \\leftrightarrow \\Leftarrow \\Rightarrow \\Leftrightarrow \\uparrow \\downarrow \\updownarrow \\Uparrow \\Downarrow \\Updownarrow".split(" "));Hz(this,new Rb(12,1))};y(rF,oF);a.sF=function(b){oF.call(this,b,"c",0,70,18,18,"\\leq \\geq \\prec \\succ \\preceq \\succeq \\ll \\gg \\equiv \\sim \\simeq \\asymp \\approx \\ne \\subset \\supset \\subseteq \\supseteq \\in \\ni \\notin".split(" "));Hz(this,new Rb(7,3))};y(sF,oF);a.tF=function(b){oF.call(this,b,"g",0,30,18,18,"\\alpha \\beta \\gamma \\delta \\epsilon \\varepsilon \\zeta \\eta \\theta \\vartheta \\iota \\kappa \\lambda \\mu \\nu \\xi \\pi \\varpi \\rho \\varrho \\sigma \\varsigma \\tau \\upsilon \\phi \\varphi \\chi \\psi \\omega \\Gamma \\Delta \\Theta \\Lambda \\Xi \\Pi \\Sigma \\Upsilon \\Phi \\Psi \\Omega".split(" "));Hz(this,new Rb(7,6))};y(tF,oF);a.uF=function(b){oF.call(this,b,"m",0,90,30,56,"x_{a};x^{b};x_{a}^{b};\\bar{x};\\tilde{x};\\frac{a}{b};\\sqrt{x};\\sqrt[n]{x};\\bigcap_{a}^{b};\\bigcup_{a}^{b};\\prod_{a}^{b};\\coprod_{a}^{b};\\left( x \\right);\\left[ x \\right];\\left{ x \\right};\\left| x \\right|;\\int_{a}^{b};\\oint_{a}^{b};\\sum_{a}^{b}{x};\\lim_{a \\rightarrow b}{x}".split(";"));Hz(this,new Rb(10,2))};y(uF,oF);a.wF=function(b){oF.call(this,b,"mn",0,0,46,18,["g","s","c","m","a"],vF.U());Hz(this,new Rb(5,1))};y(wF,oF);wF.prototype.F=function(b,c){return wF.n.F.call(this,j,c)};a.vF=function(){};y(vF,nF);ia(vF);vF.prototype.P=s("ee-menu-palette");a.xF=function(b){oF.call(this,b,"s",0,50,18,18,"\\times \\div \\cdot \\pm \\mp \\ast \\star \\circ \\bullet \\oplus \\ominus \\oslash \\otimes \\odot \\dagger \\ddagger \\vee \\wedge \\cap \\cup \\aleph \\Re \\Im \\top \\bot \\infty \\partial \\forall \\exists \\neg \\angle \\triangle \\diamond".split(" "));Hz(this,new Rb(7,5))};y(xF,oF);a.yF=function(){M.call(this);this.yH={};this.dn=k;this.S=new qe(this);this.Yv=new Md(300);this.S.e(this.Yv,Nd,this.KE)};y(yF,Kd);t=yF.prototype;t.dx=function(b){var c=this.yH,d=c[b];if(!d){switch(b){case "mn":d=new wF(this);break;case "g":d=new tF(this);break;case "s":d=new xF(this);break;case "c":d=new sF(this);break;case "m":d=new uF(this);break;case "a":d=new rF(this);break;default:f(Error("Invalid palette type!"))}c[b]=d}return d};
t.setActive=function(b){var c=this.dn;c&&c.F(n);this.dn=c=this.dx(b);c.F(j);return c};t.Xv=function(){this.Yv.start()};t.KE=function(){this.setActive("mn")};t.z=function(){yF.n.z.call(this);this.yH=this.dn=k};a.zF=function(b,c,d){T.call(this,d);this.Bj=c;this.qg=b.bT};y(zF,mF);t=zF.prototype;t.gG="";t.Ev=0;
t.w=function(){var b=x("TeX 公式"),c=x("预览"),d=x("Learn more"),e=this.K,d=e.w("DIV",{style:"display: none;"},e.w("SPAN",{"class":"ee-section-title ee-section-title-floating"},b),this.Bj?e.w("A",{id:"ee-section-learn-more",target:"_blank",href:this.Bj},d):k,e.w("DIV",{style:"clear: both;"}),b=this.dQ=e.w("DIV",{style:"position: relative"}));this.qg.setActive("mn").aa(b);b.appendChild(e.w("DIV",{style:"clear:both"}));var g=this.Dh=e.w("textarea",{"class":"ee-tex",dir:"ltr"});b.appendChild(g);b.appendChild(e.w("DIV",
{"class":"ee-section-title"},c));c=this.pT=e.w("DIV",{"class":"ee-preview-container"});b.appendChild(c);this.g=d};t.C=function(){this.$I=new sv(this.Dh);N(this.$I,"input",this.eF,n,this);this.h().e(this.Dh,"keydown",this.eF);this.h().e(this.qg,qF,this.bP,n,this)};t.F=function(b){zF.n.F.call(this,b);b&&Od(this.GN,0,this)};t.GN=function(){this.Dh.focus();et(this.Dh,this.Dh.value.length)};
a.AF=function(b){var c=b.Gl();if(c!=b.gG){b.gG=c;var d=!(1024<c.length);b.dispatchEvent(new kF(d));var b=b.pT,e=Vb(b);e.Bt(b);c&&(d?c=e.w("IMG",{src:lF(c)}):(c=x("Equation is too long"),c=e.w("DIV",{"class":"ee-warning"},c)),e.appendChild(b,c))}};t.eF=function(){this.Ev++;Od(v(this.oP,this,this.Ev),500)};t.oP=function(b){b==this.Ev&&AF(this)};
t.bP=function(b){var c=b.dx(),d=this.qg,e=d.dn,b=this.Dh;if("mn"==c.ji()){var g=c.Ib,g=-1!=g?c.Cl(g):k;if(e!=c&&e.ji()==g){d.KE();return}g&&(c=this.qg.setActive(g),c.m()||c.aa(this.dQ),c=c.m(),cg(c,0,-c.clientHeight))}else{e=this.qg.dn;g=e.Cl(e.Ib);if(!g)return;Od(v(this.mQ,this,g+" "),0)}b.focus()};t.mQ=function(b){var c=this.Dh,d=Bm(c),e=c.value,e=e.substring(0,d)+b+e.substring(d);c.value=e;et(c,d+b.length);AF(this)};t.Gl=function(){return this.Dh.value};t.jA=function(b){this.Dh.value=b;AF(this)};
t.z=function(){this.$I.H();this.qg=k;zF.n.z.call(this)};a.BF=function(b,c,d){T.call(this,d);this.mD=b;this.Bj=c};y(BF,T);t=BF.prototype;t.Eh=k;t.w=function(){BF.n.w.call(this);this.gr()};t.gr=function(){var b=this.m();this.Eh=new zF(this.mD,this.Bj,this.K);this.J(this.Eh);this.Eh.aa(b);this.Eh.F(j)};t.$=function(b){this.g=b;this.gr()};t.Gl=function(){return this.Eh.Gl()};t.jA=function(b){this.Eh.jA(b)};t.$w=function(){var b=this.Gl(),c=lF(b);return!c?"":'<img src="'+c+'" alt="'+Wa(b)+'" class="ee_img tr_noresize" eeimg="1" style="vertical-align: middle">'};
t.isValid=function(){return 1024<this.Gl().length};t.F=function(b){this.Eh.F(b)};t.z=function(){this.Eh&&this.Eh.H();this.mD=k;BF.n.z.call(this)};a.CF=function(b,c,d,e){CE.call(this,c);this.pj=new BF(b,e);this.pj.aa();this.pj.jA(d);this.pj.addEventListener("+equation",this.Wo,n,this)};y(CF,CE);CF.prototype.Pv=function(){var b=new DE(this),c=x("公式编辑器"),d=x("插入公式"),e=x("保存"),d=this.pj.Gl()?e:d;EE(FE(b.lb(c).Na(this.pj.m())),d);return GE(b)};CF.prototype.Fn=function(){if(this.pj.isValid())return k;var b=this.pj.$w();return new jF(b)};CF.prototype.Wo=function(b){this.VG||(this.VG=this.Uw("ok"));this.VG.disabled=!b.isValid};a.DF=function(b){this.Bj=b||"";HE.call(this,"+equation")};y(DF,HE);t=DF.prototype;t.Ga=pe("goog.editor.plugins.EquationEditorPlugin");t.md=of("EquationEditorPlugin");t.Ov=function(b,c){var d=c||k,e;d?(e=d.getAttribute("alt"),e||(e=d.getAttribute("src"),e=!e?"":decodeURIComponent(e.match(ze)[6]||k).slice(4)||"")):e="";this.xH=d;d={};d.bT=new yF;d=new CF(d,b,e,this.Bj);d.addEventListener("ok",this.mo,n,this);return d};t.enable=function(b){DF.n.enable.call(this,b)};
t.disable=function(b){DF.n.disable.call(this,b)};t.mo=function(b){JE(this);this.D.Yh();b=hc(nD(this).Ja,b.uN);if(this.xH)pc(b,this.xH);else{var c=ww(this.D);c.isCollapsed()||c.cd();b=c.insertNode(b,n)}ct(b,n);this.D.He()};a.EF=function(){xE.call(this)};y(EF,xE);x("Equation:");a.FF=x("Edit"),a.GF=x("Remove");t=EF.prototype;t.md=s("EquationBubble");t.TN=function(b){return b&&"IMG"==b.nodeName&&(b.getAttribute("eeimg")||E.has(b,"ee_img"))?b:k};t.KM=function(b){this.ir("ee_bubble_edit",FF,this.mN,b,"zg-icon zg-icon-pen");this.ir("ee_remove_remove",GF,this.JT,b,"zg-icon zg-icon-trash")};t.Tw=s("IMG");t.yE=function(){return x("Equation")};t.JT=function(){this.D.Yh();L(this.gu);AE(this);this.D.He()};
t.mN=function(){var b=this.gu;AE(this);this.D.execCommand("+equation",b)};a.HF=function(b){Uv.call(this);this.tB="http://upload."+gh.qp+":"+location.port+"/upload";F.extend(this.G={},this.R,b||{})};y(HF,Uv);t=HF.prototype;t.R={u_:ha};t.md=of("FastUpload");
t.enable=function(b){if(!this.isEnabled(b)&&!(!window.URL&&!window.webkitURL||!window.FileReader||!window.FormData||!document.addEventListener)){$.fn.draghover=function(){return this.each(function(){var b=$(),c=$(this),d=j;c.on("dragenter",function(l){l=l.originalEvent;0===b.size()&&(d&&z.contains(l.dataTransfer.types,"Files"))&&c.trigger("draghoverstart",l);b=b.add(l.target)});c.on("dragleave",function(l){setTimeout(function(){b=b.not(l.target);0===b.size()&&d&&c.trigger("draghoverend",l)},1)});
c.on("dragstart",function(){d=n});c.on("drop dragend",function(){b=$();c.trigger("draghoverend");d=j})})};this.DB=$(this.D.m());var c=nD(this),d=$('<div class="editable-dropzone"><div class="row"><div class="cell"><div>拖拽至此处上传</div></div></div></div>');c.vs(d[0],this.D.m());c=this.RJ=d;new qe(this);b.m().addEventListener("paste",v(this.Ex,this));document.addEventListener("dragover",v(this.yO,this),n);c.on("dragover",v(this.xO,this));c.get(0).addEventListener("drop",v(this.Ur,this),n);$(window).draghover().on({draghoverstart:v(this.ME,
this),draghoverend:v(this.zO,this)});c.draghover().on({draghoverstart:v(this.rO,this),draghoverend:v(this.ME,this)})}};t.yO=function(b){z.contains(b.dataTransfer.types,"Files")&&(b.dataTransfer.dropEffect="none",b.preventDefault())};t.xO=function(b){b=b.originalEvent;b.dataTransfer.dropEffect="copy";b.preventDefault();b.stopPropagation()};t.ME=function(b){b.preventDefault();b.stopPropagation();IF(this,1)};t.rO=function(b){IF(this,2);b.stopPropagation()};
t.zO=function(b){b.preventDefault();IF(this,0)};a.IF=function(b,c){var d=[{display:"none"},{display:"table",width:b.DB.width(),height:b.DB.height(),"background-color":"rgba(255, 255, 255, 0.5)"}];d[2]=$.extend({},d[1],{"background-color":"rgba(245, 245, 245, 0.5)"});b.RJ.css(d[c])};t.Ex=function(b){var c=this;b.clipboardData&&z.contains(b.clipboardData.types,"Files")&&z.forEach(b.clipboardData.items,function(d){-1<d.type.indexOf("image")&&(JF(c,d.getAsFile()),b.preventDefault())})};
t.Ur=function(b){var c=this;c.D.execCommand("clearlorem");var d=b.dataTransfer.files;document.createElement("img");b.preventDefault();var e=[];z.forEach(d,function(b){-1<b.type.indexOf("image")?(JF(c,b),e.push(j)):e.push(n)});z.every(e,function(b){return!b})&&U("文件类型不支持！");IF(c,0)};
a.JF=function(b,c){var d=new FormData;d.append("via","xhr2");d.append("upload_file",c);var e;e=$.ajaxSettings.xhr();e.withCredentials=j;var g=$.ajax({url:b.tB,data:d,processData:n,contentType:n,xhr:function(){return e},type:"POST"}).done(function(b){"string"===$.type(b)&&(b=JSON.parse(b));if(1===b.code)U(b.msg);else{var c=new Image;c.src=b.msg[0];c.setAttribute("originImgSrc",c.src.replace("_m.jpg","_r.jpg"));c.setAttribute("data-rawWidth",b.msg[1]);c.setAttribute("data-rawHeight",b.msg[2]);g.JB.after(c)}}).fail(function(){U("上传失败！>_<")}).always(function(){g.JB.remove()}),
d=g,h;h=nD(b);var l=h.w("IMG",{"class":"",style:"display:block",src:"http://static.zhihu.com/static/img/spinner2.gif"}),m=ww(b.D);!m||!ED(m)||!vc(b.D.m(),m.Gb())?Mt(b.D.field)?oc(b.D.m(),l,0):b.D.m().appendChild(l):m.ug(l);A||(ct(l,n),h.Ta().focus());Xv(b.D);h=$(l);d.JB=h};a.KF={},a.QF=function(b,c,d){function e(b){qc(b)}function g(c,d){for(;c!==b;){if(d(c))return c;c=c.parentNode}return k}function h(b){return b.tagName&&b.tagName===c}b||f("Missing Editable Container");c||(c="blockquote");var c=c.toUpperCase(),l=Xq();if(l&&LF(b,iq(l))&&LF(b,jq(l))){var m=pD(l.Z(),l.wa(),l.ka(),l.Ka()),p;if(l.isCollapsed())p=[];else{var r=l.yc(),w=l.Z(),B=l.ka();p=r.childNodes;var H=function(b){return w!==r&&!LF(b,w)},G=function(b){return!(b.previousSibling&&LF(b.previousSibling,B))};
p=O.toArray(1===p.length?p:O.YA(O.lN(p,H),G))}var H=l.Gb(),G=g(H,h),S=z.reduce(p,function(b,d){1===d.nodeType&&(h(d)?b.push(d):b.push.apply(b,z.toArray(d.getElementsByTagName(c))));return b},[]),X;if(G){if(d)return MF.Nu;qc(G)}else if(S.length){if(d)return MF.Nu;z.forEach(S,e)}else{if(d)return MF.TB;if(d=g(H,function(b){return z.contains(NF,b.tagName.toLowerCase())}))X=document.createElement(c),d.parentNode.insertBefore(X,d),X.appendChild(d);else if(l.Z()!==l.ka())X=document.createElement(c),p[0].parentNode.insertBefore(X,
p[0]),z.forEach(p,function(b){X.appendChild(b)});else{m=c;OF.LK?document.execCommand("formatBlock",n,m):(d=Xq(),l=d.yc(),ra(l)&&1==l.nodeType&&Mt(l)?(m=document.createElement(m),l===b?l.appendChild(m):pc(m,l),(D||C)&&m.appendChild(document.createElement("br")),Lt(m)):(d=d.ka(),d=Kc(d,function(b){return HD(b.parentNode)||uD(b.parentNode)},j),l=O.YA(new mt(d,j,j),tf(PF)),d=O.YA(new mt(d,n,n),tf(PF)),l=O.toArray(l).reverse().concat(O.toArray(d)),l.length&&(m=document.createElement(m),d=z.Ve(l),(p=d.nextSibling)&&
(p&&"BR"===p.tagName)&&L(p),nc(m,d),kc(m,l),(D||C)&&m.appendChild(document.createElement("br")),ct(m.lastChild))));return}}m&&(l=function(c,d){return c&&LF(b,c)&&Ys(c)>=d},l(m.Z(),m.wa())&&l(m.ka(),m.Ka())&&m.select())}else if(d)return MF.TB},a.PF=function(b){return b&&"BR"===b.tagName||HD(b)||uD(b)},a.LF=function(b,c){return 3===b.nodeType?b===c:b.contains(3===c.nodeType?c.parentNode:c)},a.NF=["ul","ol","dl","table"],a.MF={Nu:1,TB:0},a.OF=KF;OF.LK=!A;OF.toggle=QF;
OF.de=function(b,c){return QF(b,c,j)};OF.FK=MF;a.RF=function(){Uv.call(this)};y(RF,Uv);t=RF.prototype;t.md=of("Blockquote");t.Qe=function(b){return"+blockquote"===b};t.of=function(b){this.Qe(b)&&KF.toggle(this.D.m())};t.queryCommandValue=function(){return KF.FK.Nu===KF.de(this.D.m())};t.Bx=function(b){if(13===b.keyCode)return this.wx(b)};t.uA=function(b,c){return SF(b,c).uA};
a.SF=function(b,c){function d(b,c){return{uA:b,SG:c}}D&&(b.normalize(),c=Xq());var e,g=c;e=g.ka();var h=g.Ka(),g=g.yc(),l=g.childNodes.length;3!==e.nodeType&&l&&(e=g.childNodes[h===l?l-1:h]);if(!e)return d(n,k);if(Mt(b))return d(j,b);for(h=e;h!==b;){if(ID(h))return d(n,k);h=h.parentNode}return e&&"BR"===e.tagName&&e.previousSibling&&"BR"===e.previousSibling.tagName?d(j,e):(e=c.Gb())&&1===e.nodeType&&(!e.childNodes.length||Mt(e))?d(j,e):d(n,k)};
t.wx=function(b){var c=ww(this.D);if(c.isCollapsed()){var d;a:{d=c.ka();for(var e=this.D.field;d!==e;){if("BLOCKQUOTE"===d.tagName)break a;d=d.parentNode}d=i}if(d&&(c=SF(d,c),c.uA)){b.preventDefault();b=document.createElement("div");nc(b,d);if(D||C)(d=(d=d.nextSibling)&&"BR"===d.tagName&&d)||(d=document.createElement("br")),b.appendChild(d);Zq(b,0).select();c.SG&&L(c.SG)}}};hB["+blockquote"]={kb:j,T:"引用内容",Aa:"+blockquote",Oa:"tr-icon tr-blockquote",factory:iA};a.TF=function(b,c){this.Xa=b;this.xB=!c};
TF.prototype.Ai=function(b,c,d){var e,g=[];if(""!=b){e=$a(b);var h=RegExp("(^|\\W+)"+e,"i");O.some(this.Xa,function(b){String(b).match(h)&&g.push(b);return g.length>=c})}e=g;if(0==e.length&&this.xB){var l=[];O.forEach(this.Xa,function(c,d){var e=b.toLowerCase(),g=String(c).toLowerCase(),h=0;if(-1!=g.indexOf(e))h=parseInt((g.indexOf(e)/4).toString(),10);else for(var m=e.split(""),S=-1,X=10,ja=0,Oa;Oa=m[ja];ja++)Oa=g.indexOf(Oa),Oa>S?(S=Oa-S-1,S>X-5&&(S=X-5),h+=S,S=Oa):(h+=X,X+=5);h<6*e.length&&l.push({cV:c,
nI:h,index:d})});l.sort(function(b,c){var d=b.nI-c.nI;return 0!=d?d:b.index-c.index});e=[];for(var m=0;m<c&&m<l.length;m++)e.push(l[m].cV)}d(b,e)};a.UF=function(b){T.call(this);F.extend(this.G={},this.R,b||{});this.qe=k};y(UF,T);
a.VF=[["ABAP",["abap"]],["ActionScript",["as","actionscript"]],["Ada",["ada","ada95ada2005"]],["ANTLR",["antlr"]],["ApacheConf",["apacheconf","aconf","apache"]],["AppleScript",["applescript"]],["AspectJ",["aspectj"]],["Asymptote",["asy","asymptote"]],["AutoHotkey",["ahk"]],["Awk",["awk","gawk","mawk","nawk"]],["BBCode",["bbcode"]],["Base Makefile",["basemake"]],["Bash",["bash","sh","ksh"]],["Batchfile",["bat"]],["Befunge",["befunge"]],["BlitzMax",["blitzmax","bmax"]],["Boo",["boo"]],["Brainfuck",
["brainfuck","bf"]],["Bro",["bro"]],["BUGS",["bugs","winbugs","openbugs"]],["C",["c"]],["CMake",["cmake"]],["c-objdump",["c-objdump"]],["aspx-cs",["aspx-cs"]],["C#",["csharp","c#"]],["Ceylon",["ceylon"]],["CFEngine3",["cfengine3","cf3"]],["Cheetah",["cheetah","spitfire"]],["Clojure",["clojure","clj"]],["CoffeeScript",["coffee-script","coffeescript"]],["Coldfusion HTML",["cfm"]],["cfstatement",["cfs"]],["Common Lisp",["common-lisp","cl"]],["Coq",["coq"]],["C++",["cpp","c++"]],["cpp-objdump",["cpp-objdump",
"c++-objdumb","cxx-objdump"]],["Croc",["croc"]],["CSS",["css"]],["CUDA",["cuda","cu"]],["Cython",["cython","pyx"]],["D",["d"]],["d-objdump",["d-objdump"]],["Darcs Patch",["dpatch"]],["Dart",["dart"]],["Delphi",["delphi","pas","pascal","objectpascal"]],["dg",["dg"]],["Diff",["diff","udiff"]],["Django/Jinja",["django","jinja"]],["DTD",["dtd"]],["Duel","duel;Duel Engine;Duel View;JBST;jbst;JsonML+BST".split(";")],["Dylan",["dylan"]],["ECL",["ecl"]],["eC",["ec"]],["Erlang",["erlang"]],["Elixir",["elixir",
"ex","exs"]],["ERB",["erb"]],["Evoque",["evoque"]],["FSharp",["fsharp"]],["Factor",["factor"]],["Fancy",["fancy","fy"]],["Fantom",["fan"]],["Felix",["felix","flx"]],["Fortran",["fortran"]],["GLSL",["glsl"]],["GAS",["gas"]],["Genshi",["genshi","kid","xml+genshi","xml+kid"]],["Gettext Catalog",["pot","po"]],["Gherkin",["Cucumber","cucumber","Gherkin","gherkin"]],["Gnuplot",["gnuplot"]],["Go",["go"]],["GoodData-CL",["gooddata-cl"]],["Gosu",["gosu"]],["Gosu Template",["gst"]],["Groff",["groff","nroff",
"man"]],["Groovy",["groovy"]],["Haml",["haml","HAML"]],["Haskell",["haskell","hs"]],["haXe",["hx","haXe"]],["HTML",["html"]],["HTTP",["http"]],["Hxml",["haxeml","hxml"]],["Hybris",["hybris","hy"]],["INI",["ini","cfg"]],["Io",["io"]],["Ioke",["ioke","ik"]],["IRC logs",["irc"]],["Jade",["jade","JADE"]],["JavaScript",["js","javascript"]],["JSON",["json"]],["Java",["java"]],["Java Server Page",["jsp"]],["Julia console",["jlcon"]],["Julia",["julia","jl"]],["Kconfig",["kconfig","menuconfig","linux-config",
"kernel-config"]],["Koka",["koka"]],["Kotlin",["kotlin"]],["Lasso",["lasso","lassoscript"]],["Lighttpd configuration file",["lighty","lighttpd"]],["Literate Haskell",["lhs","literate-haskell"]],["LiveScript",["live-script","livescript"]],["LLVM",["llvm"]],["Logtalk",["logtalk"]],["Lua",["lua"]],["MOOCode",["moocode"]],["Makefile",["make","makefile","mf","bsdmake"]],["Mako",["mako"]],["MAQL",["maql"]],["Mason",["mason"]],["Matlab",["matlab"]],["Matlab session",["matlabsession"]],["MiniD",["minid"]],
["Modelica",["modelica"]],["Modula-2",["modula2","m2"]],["MoinMoin/Trac Wiki markup",["trac-wiki","moin"]],["Monkey",["monkey"]],["MoonScript",["moon","moonscript"]],["Mscgen",["mscgen","msc"]],["MuPAD",["mupad"]],["MXML",["mxml"]],["MySQL",["mysql"]],["Myghty",["myghty"]],["NASM",["nasm"]],["Nemerle",["nemerle"]],["NewLisp",["newlisp"]],["Newspeak",["newspeak"]],["Nginx configuration file",["nginx"]],["Nimrod",["nimrod","nim"]],["NumPy",["numpy"]],["objdump",["objdump"]],["Objective-C",["objective-c",
"objectivec","obj-c","objc"]],["Objective-J",["objective-j","objectivej","obj-j","objj"]],["OCaml",["ocaml"]],["Octave",["octave"]],["Ooc",["ooc"]],["Opa",["opa"]],["OpenEdge ABL",["openedge","abl","progress"]],["Perl",["perl","pl"]],["PHP",["php","php3","php4","php5"]],["PL/pgSQL",["plpgsql"]],["PostScript",["postscript"]],["PostgreSQL console (psql)",["psql","postgresql-console","postgres-console"]],["PostgreSQL SQL dialect",["postgresql","postgres"]],["POVRay",["pov"]],["PowerShell",["powershell",
"posh","ps1"]],["Prolog",["prolog"]],["Properties",["properties"]],["Protocol Buffer",["protobuf"]],["Python",["python","py","sage"]],["Python Traceback",["pytb"]],["RConsole",["rconsole","rout"]],["Racket",["racket","rkt"]],["Embedded Ragel",["ragel-em"]],["Raw token data",["raw"]],["Rd",["rd"]],["REBOL",["rebol"]],["Redcode",["redcode"]],["RHTML",["rhtml","html+erb","html+ruby"]],["RobotFramework",["RobotFramework","robotframework"]],["reStructuredText",["rst","rest","restructuredtext"]],["Ruby",
["rb","ruby","duby"]],["Rust",["rust"]],["S",["splus","s","r"]],["Standard ML",["sml"]],["Sass",["sass","SASS"]],["Scala",["scala"]],["Scaml",["scaml","SCAML"]],["Scheme",["scheme","scm"]],["Scilab",["scilab"]],["SCSS",["scss"]],["Smali",["smali"]],["Smalltalk",["smalltalk","squeak"]],["Smarty",["smarty"]],["Snobol",["snobol"]],["SourcePawn",["sp"]],["Debian Sourcelist",["sourceslist","sources.list"]],["SQL",["sql"]],["sqlite3con",["sqlite3"]],["SquidConf",["squidconf","squid.conf","squid"]],["Scalate Server Page",
["ssp"]],["Stan",["stan"]],["systemverilog",["sv"]],["Tcl",["tcl"]],["Tcsh",["tcsh","csh"]],["Tea",["tea"]],["TeX",["tex","latex"]],["Text",["text"]],["Treetop",["treetop"]],["UrbiScript",["urbiscript"]],["VGL",["vgl"]],["Vala",["vala","vapi"]],["aspx-vb",["aspx-vb"]],["VB.net",["vb.net","vbnet"]],["Velocity",["velocity"]],["verilog",["v"]],["vhdl",["vhdl"]],["VimL",["vim"]],["XQuery",["xquery","xqy","xq","xql","xqm"]],["XML",["xml"]],["XSLT",["xslt"]],["Xtend",["xtend"]],["YAML",["yaml"]]],a.WF=
function(b){return{label:b[0],value:b[1][0],toString:of(b[0])}},a.XF=z.map(VF,WF);t=UF.prototype;t.R={oU:"lang-select",ar:"collapsed",OQ:"lang-list",XS:"lang-option",Tk:"active",ZC:"checked"};t.z=function(){UF.n.z.call(this);this.h().H();this.W.H();L(this.g);this.Ir=this.ju=this.g=k};t.w=function(){var b=this.G;this.g=K("div",{innerHTML:this.Ch,className:[b.oU,b.ar].join(" ")})};t.Ch='<div class="title-button">选择语言</div><i class="zg-icon zg-icon-double-arrow"></i><div class="input-wrapper"><input class="filter-input zg-form-text-input" placeholder="搜索语言"></div>';
t.C=function(){UF.n.C.call(this);this.ju=J("title-button",this.g);this.Ir=J("filter-input",this.g);wg(this.ju,j);var b=this.Ir,c=this.g,d=this.G,e=this.h(),g=this,h=g.G,l={},m=new TF(XF,n),c=new Qm(c,l),p=new Dm(k,k,n),r=m.Ai;m.Ai=function(b,c,d){La(b)?r.apply(this,arguments):d(b,XF)};l.dd=function(b,c,d){b=b.data;b.value===g.qe&&(E.add(d,h.ZC),d.appendChild(K("i","icon "+h.ZC)));d.appendChild(document.createTextNode(b.toString()))};var w=new tm(m,c,p);p.W=w;p.Yk(b);w.ri=20;e.e(w,"suggestionsupdate",
function(){w.Ne(w.Nc+0)}).e(w,"update",function(b){this.mz(b.sp)}).e(w,"dismiss",function(){this.Ff(j)});b=w.N;b.className=d.OQ;b.Jt=d.XS;b.Uu=d.Tk;this.W=w;this.h().e(this.g,"click",this.Sr).e(this.ju,"click",this.pP)};t.X=q("qe");t.Ea=function(b){var c=b&&z.find(XF,function(c){return c.value===b});c&&(this.sk(c.label),this.dispatchEvent({type:"change",WS:c}));this.qe=b};
t.Sr=function(b){var c=this.W,d=c.N.m();d&&(document.activeElement!==this.Ir&&!d.contains(b.target))&&(b.preventDefault(),b.stopPropagation(),vm(c))};t.pP=function(){this.isCollapsed()&&this.Ff(n)};t.isCollapsed=function(){return E.has(this.g,this.G.ar)};t.Ff=function(b){if(this.isCollapsed()!==b){var c=this.Ir,d=this.G;b?E.add(this.g,d.ar):(E.remove(this.g,d.ar),b=this.W,d=b.N,b.Am(XF),d.m().scrollTop=0,d.show(),c.value="",c.focus())}};t.sk=function(b){var c=this.ju;c.title=b;Ac(c,b)};
t.mz=function(b){this.Ea(b.value);this.W.Mc()};a.YF=function(b){Uv.call(this);F.extend(this.G={},this.R,b||{});this.Bw=this.vb=k};y(YF,Uv);
a.ZF=D||tb||C,a.$F=function(b){return"P"===b.tagName},a.aG=function(b){return 3===b.nodeType},a.bG=function(b){return b&&"PRE"===b.tagName},a.cG=function(b){function c(b){return z.contains(g,b)}function d(){var b=document.createTextNode("\n");g.push(b);return b}var e=document.createElement("div");e.innerHTML=b;var g=[],h=tf(c),b=Cc(e,HD);(0,z.forEach)(b,function(b){b.lastChild&&"BR"===b.lastChild.tagName&&b.removeChild(b.lastChild);b.firstChild||b.appendChild(document.createTextNode(""));b.insertBefore(d(),
b.firstChild);b.appendChild(d())});b=z.toArray(e.getElementsByTagName("br"));(0,z.forEach)(b,function(b){b!==b.parentNode.lastChild&&pc(document.createTextNode("\n"),b)});e=Cc(e,aG);e=sf(function(b){return z.filter(b,function(d,e){var g=b[e-1];return!g||!(c(g)&&c(d))})},function(b){var c=z.Gw(b,h);return-1!==c?b.slice(0,c+1):b},function(b){var c=z.Fw(b,h);return-1!==c?b.slice(c):b})(e);return(0,z.map)(e,function(b){return b.nodeValue}).join("").replace(/\xa0/g," ")};t=YF.prototype;t.md=of("CodePlugin");
t.Qe=function(b){return"+code"===b};t.of=function(b){this.Qe(b)&&this.trigger()};t.queryCommandValue=function(){var b="1"===dG(this).state,c=this.D.tj("EnterHandler");c&&(b?c.disable(this.D):c.enable(this.D));this.vb&&this.Bw&&Th(this.vb,function(c){c instanceof pz&&c.Ya(!b||z.contains(this.Bw,c.ce()))},this);return b};t.R={YM:""};t.vU=function(b){this.vb=b;this.Bw=["toggleFullScreen"].concat("+code")};t.z=function(){YF.n.z.call(this);this.vb=k};
a.eG=function(b,c,d){for(b=b.D.field;c!==b;){if(d(c))return c;c=c.parentNode}},a.dG=function(b){var c,d=Xq();d&&b.D.field.contains(d.Gb())?(c=d.Z(),b=(c=eG(b,c,bG))?"1":"2"):b="0";return{state:b,wm:d,code:c}};
t.trigger=function(){var b=dG(this),c=b.wm,d=b.code;switch(b.state){case "1":var e=!La(Jc(d)),b=ID(d);e?(d.parentNode.removeChild(d),b&&ct(b,j)):(c=c.Z()&&c.ka()?new qD(c):k,e=Na(d.innerHTML),ot(O.filter(new mt(d,n,j),nt))&&(e="<br>"+e),b&&"BR"!==b.tagName&&(e+="<br>"),b=ic(e),d.parentNode.replaceChild(b,d),c.restore());break;case "2":this.us(c,La(c.Qc())?cG(c.ee()):ZF?"\n":"")}};
t.cj=function(b,c){var d=document.createElement(b);d.id=Nh(Mh.U());return c(d,function(){d=I(d.id);d.removeAttribute("id");return d})};
t.Ig=function(){var b=this.D,c=this.D.field,d,e=new wo(bG,n,k,c),g=K("div",{style:"display:none"});dt(e,new Rf(4,0,0,0));e.Vl=new Rf(4,0,0,0)||k;e.Yt=150;e.ds=100;e.rh(g);e.className="hc-lang-select";N(e,"beforeshow",function(b){d=b.target.anchor;e.ed(new co(d,1));if(d.lang){var b=h,c,g=d.lang;(c=(c=z.find(VF,function(b){return b[0]===g||z.contains(b[1],g)}))&&WF(c))&&b.Ea(c.value);h.Ff(j)}else h.sk("选择语言")});N(e,"beforehide",function(b){d=k;h.Ea(k);if((b=b.target)&&c.contains(b)&&bG(b))return n});
var h=new UF;h.aa(g);N(h,"change",function(b){d&&(d.lang=b.WS.value,e.F(n))});this.xq={Zw:of(e),KZ:of(h),H:function(){e.H();h.H()}};Vc(b,this.xq);N(b,"delayedchange",this.UT,n,this);N(b.field,"paste",this.Ex,n,this)};t.UT=function(){var b=this.xq&&this.xq.Zw();b&&(b.V()&&b.anchor)&&b.pa()};
t.Ex=function(b){var c=dG(this),d=c.wm,e=c.code;if("1"===c.state)if(c=b.Zb.clipboardData)c.types&&z.contains(c.types,"text/plain")&&(b.preventDefault(),c=c.getData("text/plain"),b=document.createTextNode(c),d.ug(b),ct(b));else if(window.clipboardData){if(c=window.clipboardData.getData("Text")){b.preventDefault();var g=c;this.cj("i",function(b,c){d.ug(b);b=c();g=Ja(g);pc(document.createTextNode(g),b)})}}else{var h=d.wa(),b=d.Qc().length,l=(e.firstChild?Ys(e.firstChild):0)-h-b;setTimeout(function(){var b=
cG(e.innerHTML);Ac(e,b);b=(e.firstChild?Ys(e.firstChild):0)-l;e.firstChild&&Zq(e.firstChild,Math.max(h,b)).select()})}};
t.Bx=function(b){if(13===b.keyCode)return this.wx(b);if(40===b.keyCode){var c=dG(this),d=c.wm,b=c.code;if("1"===c.state){for(var e=c=d.ka(),g=[];e&&e!==b;)g.push([e.parentNode.childNodes.length,z.indexOf(e.parentNode.childNodes,e)]),e=e.parentNode;g=!g.length||z.every(g,function(b){return b[0]===b[1]+1});e=aG(c);if(g&&!(g=!e))e&&(c=c.nodeValue,d=d.Ka(),e=d===c.length||ZF&&d===c.length-1&&"\n"===c.slice(-1)),g=e;g&&(ID(b)||nc(document.createElement("br"),b))}}};
t.wx=function(b){var c=dG(this),d=c.wm;if("1"===c.state)return b.preventDefault(),A?this.cj("i",function(b,c){d.ug(b);setTimeout(function(){var d=document.createTextNode("\r");b=c();pc(d,b);ct(d)})}):document.queryCommandSupported("insertLineBreak")?document.execCommand("insertLineBreak"):(b=document.createTextNode("\n"),d.insertNode(b),ct(b)),this.D.He(),j};
t.us=function(b,c){var d=this.G,e;b.cd();var g;var h=sD(b,j),l=h.ga,m,p=this.D.field;g=eG(this,l,KD(HD,tf($F)))||p;var r=function(b){return b.parentNode.insertBefore(document.createTextNode(""),b)};if(aG(l)){var w=l.parentNode;!l.nodeValue&&w!==p&&Mt(w)?(m=r(w),l=r(m),w.parentNode.removeChild(w)):m=A&&h.offset===l.length?nc(document.createTextNode(""),l):l.splitText(h.offset)}else"BR"===l.tagName&&(m=l,l=r(l));if(m){for(var B,h=l,l=m;h!=g&&(B=h.parentNode);){m=h;h=l;for(l=B.cloneNode(n);m.nextSibling;)l.appendChild(m.nextSibling);
h&&l.insertBefore(h,l.firstChild);h=B}B=l;m=B.firstChild;kc(g,B.childNodes);g=m}else g=k;g?(e=document.createElement("PRE"),g.parentNode.insertBefore(e,g)):this.cj("PRE",function(c,d){b.insertNode(c);e=d()});!c&&A&&(c=" ");e.lang=d.YM;Ac(e,c);Mt(e)?Lt(e.firstChild):ct(e.lastChild);d=e;ID(d)||nc(document.createElement("br"),d)};hB["+code"]={kb:j,T:"插入代码",Aa:"+code",Oa:"tr-icon tr-code",factory:iA};a.fG=function(){Uv.call(this);this.US=k};y(fG,Uv);a.gG=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/,a.hG=function(b){b.push("<br>")};t=fG.prototype;t.md=s("RemoveFormatting");t.Qe=function(b){return"+removeFormat"==b};t.of=function(b){"+removeFormat"==b&&!ww(this.D).isCollapsed()&&(b=this.US||v(this.YH,this),iG(this,b),nD(this).za().execCommand("RemoveFormat",n,i),or&&iG(this,function(b){var d=Gb("528")?/&nbsp;/g:/\u00A0/g;return b.replace(d," ")}))};
t.Xr=function(b,c,d){return!d?n:" "==c?(this.D.execCommand("+removeFormat"),j):n};
a.jG=function(b,c){for(var d=b.D.m();c&&c!=d;){if("TABLE"==c.tagName)return c;c=c.parentNode}return k},a.iG=function(b,c){var d=ww(b.D);if(!(1<d.vj())){if(C){var e=FD(d,b.D.m()),g=jG(b,e.Z()),h=jG(b,e.ka());if(g||h){if(g==h)return;var l,m=d;l=g;var d=h,e=new zD(m),p=m.Z(),r=m.wa(),w=m.ka(),m=m.Ka(),B=nD(b);if(l){var H=B.createTextNode("");nc(H,l);p=H;r=0}d&&(H=B.createTextNode(""),mc(H,d),w=H,m=0);Jq(p,r,w,m).select();l=e;g||(d=L(kD(l,j)),b.LA=d);h||(d=L(kD(l,n)),b.tw=d);d=ww(b.D);e=FD(d,b.D.m())}e.select();
d=e}p=d;d=nD(b).w("div");e=p.be();cr?d.appendChild(e.cloneContents()):br&&(r=p.Qc(),r=r.replace(/\r\n/g,"\r"),w=r.length,p=w-r.replace(/^[\s\xa0]+/,"").length,r=w-Ma(r).length,e.moveStart("character",p),e.moveEnd("character",-r),p=e.htmlText,"Formatted"==e.queryCommandValue("formatBlock")&&(p=Na(e.htmlText)),d.innerHTML=p);p=c(d.innerHTML);B=ww(b.D);d=nD(b);r=fb();e=fb();p='<span id="'+r+'"></span>'+p+'<span id="'+e+'"></span>';m=fb();w='<span id="'+m+'"></span>';if(br){H=B.Ke(0).be();H.pasteHTML(w);
for(var G;(G=H.parentElement())&&Mt(G)&&!yD(G);){B=G.nodeName;if("TD"==B||"TR"==B||"TH"==B)break;L(G)}H.pasteHTML(p);(m=d.m(m))&&L(m)}else if(cr){d.za().execCommand("insertImage",n,m);B=RegExp("<[^<]*"+m+"[^>]*>");G=ww(b.D).Gb();3==G.nodeType&&(G=G.parentNode);for(;!B.test(G.innerHTML);)G=G.parentNode;if(C)G.innerHTML=G.innerHTML.replace(B,p);else{G.innerHTML=G.innerHTML.replace(B,w);for(G=m=d.m(m);(G=m.parentNode)&&Mt(G)&&!yD(G);){B=G.nodeName;if("TD"==B||"TR"==B||"TH"==B)break;nc(m,G);L(G)}G.innerHTML=
G.innerHTML.replace(RegExp(w,"i"),p)}}G=d.m(r);d=d.m(e);Jq(G,0,d,d.childNodes.length).select();L(G);L(d);C&&l&&(d=ww(b.D),G=b.D.m(),b.LA&&(G.insertBefore(b.LA,G.firstChild),b.LA=k),b.tw&&(G.appendChild(b.tw),b.tw=k),G=k,e=kD(l,j),p=kD(l,n),e&&p&&(G=Jq(e,0,p,0)),pD((g?G:d).Z(),(g?G:d).wa(),(h?G:d).ka(),(h?G:d).Ka()).select(),l.H())}};
t.YH=function(b){var c=document.createElement("div");c.innerHTML=b;for(var b=[],c=[c.childNodes,0],d=[],e=0,g=[],h=0,l=0;0<=l;l-=2){for(var m=n;0<h&&l<=g[h-1];)h--,m=j;m&&hG(b);for(m=n;0<e&&l<=d[e-1];)e--,m=j;m&&hG(b);for(var m=c[l],p=c[l+1];p<m.length;){var r=m[p++],w=r.nodeName,B=this.IE(r);if(B!=k)b.push(B);else{switch(w){case "#text":r=0<e?r.nodeValue:Ia(r.nodeValue);r=Wa(r);b.push(r);continue;case "P":hG(b);hG(b);break;case "BR":hG(b);continue;case "TABLE":hG(b);g[h++]=l;break;case "PRE":case "XMP":d[e++]=
l;break;case "STYLE":case "SCRIPT":case "SELECT":continue;case "A":if(r.href&&""!=r.href){b.push("<a href='");b.push(r.href);b.push("'>");b.push(this.YH(r.innerHTML));b.push("</a>");continue}else break;case "IMG":b.push("<img src='");b.push(r.src);b.push("'");"0"==r.border&&b.push(" border='0'");b.push(">");continue;case "TD":r.previousSibling&&b.push(" ");break;case "TR":r.previousSibling&&hG(b);break;case "DIV":if(B=r.parentNode,B.firstChild==r&&gG.test(B.tagName))break;default:gG.test(w)&&hG(b)}r=
r.childNodes;0<r.length&&(c[l++]=m,c[l++]=p,m=r,p=0)}}}return b.join("").replace(/\xa0|[ \t]+/g," ")};t.IE=s(k);a.kG=function(){fG.call(this)};y(kG,fG);kG.prototype.IE=function(b){var c;if("IMG"!==b.nodeName)return k;c=[];c.push('<img src="');c.push(Wa(b.src));c.push('"');b.getAttribute("eeimg")&&b.getAttribute("alt")&&c.push(' eeimg="'+Wa(b.getAttribute("eeimg"))+'" alt="'+Wa(b.getAttribute("alt"))+'"');c.push(">");return c.join("")};a.lG=function(b){CE.call(this,b);this.S=new qe(this);this.tB="http://upload."+gh.qp+":"+location.port+"/upload";this.bM=!A};y(lG,CE);a.mG=function(b){kd.call(this,"ok");var c=b[0];this.Wl=c;this.wH=c.replace("_m.jpg","_r.jpg");this.SH=b[1];this.RH=b[2]};y(mG,kd);t=lG.prototype;t.Ch=Xk('<div class="zm-img-uploader"><iframe src="about:blank" name="av_up_frame" style="position: absolute; height: 0; width: 0; left: -9000px; "></iframe><div class="zg-section zm-img-uploader-tab"><a href="javascript:;" class="tab-nav selected">上传图片</a> 或 <a href="javascript:;" class="tab-nav">引用站外图片</a></div><form class="zg-clear" target="av_up_frame" method="POST" enctype="multipart/form-data" action="<%= uploadURL %>"><div class="tab-content selected <% if (canStylize) { %>inline<% } %>"><% if (canStylize) { %><input type="file" name="upload_file" style="opacity:0;height:0;width:0;font-size:0;position:absolute;"><a href="javascript:;" class="browser zg-btn-blue">选择图片</a><% } else { %><input type="file" name="upload_file"><% } %></div><div class="tab-content"><input type="text" autocomplete="off" name="upload_file_url" class="zm-editable-editor-input zg-form-text-input"><a href="javascript:;" class="insert zg-btn-blue zm-uploader-button-fix">确认</a></div><span style="display: none; " class="zm-img-uploader-loading">正在上传</span><span style="display: none; " class="zm-img-uploader-error">上传图片失败，请稍后重试</span></form><div class="zg-gray">请不要上传与回答问题无关的图片，详细请看 <a href="http://www.zhihu.com/question/20064580" target="_blank">知乎图片使用规范</a></div><div class="zm-command"><a class="cancel" href="javascript:;">取消</a></div></div>');
t.Pv=function(){var b=ic(this.Ch({uploadURL:this.tB,canStylize:this.bM}));F.forEach({form:"form",VA:".zm-img-uploader-tab",kh:".zm-img-uploader-loading",nf:".zm-img-uploader-error",aJ:"input[type=text]",Wn:"input[type=file]",NC:".browser",Cv:".cancel",jQ:".insert"},function(c,e){this[e]=$(c,b).get(0)},this);this.S.e(Y,Xl,this.av).e(this.Wn,"change",this.mT).e(this.jQ,"click",this.lQ).e(this.Cv,"click",function(){this.ox();this.hide()}).e(this.VA,"click",function(b){b=$(b.target);b.is("a")&&!b.is(".selected")&&
nG(this,b.index())});this.kD=b;Wg||(nG(this,1),$(this.VA).replaceWith("<strong>输入站外图片地址：</strong>"));this.NC&&this.S.e(this.NC,"click",function(){this.Wn.click()});var c=new DE(this);c.lb("插入图片").Na(this.kD);c=GE(c);mi(c,k);return c};t.mT=function(){if(this.Wn.value){var b=this.Wn.value,b=String(b).toLowerCase();(!b?0:z.some([".jpg",".jpeg",".gif",".png"],function(c){return Fa(b,c)}))?(this.aJ.value="",Q(this.kh,j),Q(this.nf,n),this.form.submit()):oG(this,"图片不是 .jpg、.png 或 .gif 格式，无法上传。")}};
t.lQ=function(){var b=Hk(this.aJ.value);b?Ea(b,"http://")?(this.Wn.value="",Q(this.kh,j),Q(this.nf,n),this.form.submit()):oG(this,"我们目前不支持该协议。"):oG(this,"请填写图片地址。")};a.nG=function(b,c){function d(b){b.eq(c).addClass("selected").siblings().removeClass("selected")}var e=$(".tab-nav",b.VA),g=$(".tab-content",b.form);Q(b.nf,n);var h=g.eq(c);h.find("input").val("");d(e);d(g);h.find(":text").focus()},a.oG=function(b,c){Q(b.kh,n);b.nf.innerHTML=c;Q(b.nf,j)};t.av=function(b){Q(this.kh,n);this.tk(b.qb)};
t.tk=function(b){b&&!b.r?(this.dispatchEvent(this.Fn(b.msg)),this.hide()):oG(this,b.msg)};t.Fn=function(b){return new mG(b)};t.z=function(){this.S.H();this.S=k;lG.n.z.call(this)};a.pG=function(){HE.call(this,"image");this.S=new qe(this)};y(pG,HE);t=pG.prototype;t.md=of("ImageDialogPlugin");t.of=function(b,c){var d=this.D;return!d.xf&&(d.dg(),!d.xf)?n:pG.n.of.call(this,b,c)};
t.Aj=function(b){if(b&&"mouseup"===b.type){var c=b.target;c&&"IMG"===c.nodeName&&(b=ID(c),b||(b=document.createElement("br"),nc(b,c)),Lt(b))}};t.fo=function(b){pG.n.fo.call(this,b)};t.Ov=function(b){b=new lG(b);this.S.e(b,"ok",this.mo).e(b,"cancel",this.px);return b};t.z=function(){pG.n.z.call(this);this.S.H()};
t.mo=function(b){JE(this);var c=nD(this),d;d=b.wH?c.w("IMG",{"class":"origin_image zh-lightbox-thumb","data-original":b.wH,title:"点击查看原图",src:b.Wl}):c.w("IMG",{"class":"content_image",src:b.Wl});b.SH&&d.setAttribute("data-rawwidth",b.SH);b.RH&&d.setAttribute("data-rawheight",b.RH);b=ww(this.D);if(ED(b))b.ug(d),A||(ct(d,n),c.Ta().focus()),Yv(this.D),this.D.He();else return k;this.S.Sc()};t.px=function(){this.S.Sc()};a.qG=function(b){CE.call(this,b);this.S=new qe(this)};y(qG,CE);a.rG=function(b,c,d,e,g){kd.call(this,"ok");this.aW=b;this.ZV=c;this.$V=g;this.VU=d;this.poster=e};y(rG,kd);t=qG.prototype;t.show=function(){qG.n.show.call(this);this.uu.focus()};t.hide=function(){qG.n.hide.call(this)};
t.Pv=function(){var b="http://upload."+gh.qp+":"+location.port+"/upload_video",b=this.jd.w("div","zm-img-uploader zm-img-uploader-upload-tab-selected",[this.jd.w("div","zg-section",this.jd.w("strong",k,"输入视频页地址：")),this.E_=this.jd.w("iframe",{id:"video_up_frame",src:"about:_blank",name:"video_up_frame",style:"visible:hidden;position:absolute;height:0;width:0;left:-9000px"}),this.Xn=this.jd.w("form",{"class":"zg-section-title",target:"video_up_frame",method:"post",enctype:"multipart/form-data",action:b},
[this.uu=this.jd.w("input",{type:"text","class":"zg-form-text-input",name:"upload_file_url",autocomplete:"off"}),this.Dn=this.jd.w("a",{"class":"zg-btn-blue zm-uploader-button-fix",name:"save",href:"javascript:;"},"确定"),this.jd.w("div","zm-video-uploader-info",[this.kh=this.jd.w("span",{style:"display:none","class":"zm-img-uploader-loading"},"正在上传"),this.nf=this.jd.w("span",{style:"display:none","class":"zm-img-uploader-error"},"插入视频失败，请稍后重试")])]),this.UP=this.jd.w("div","zg-gray"),this.$i=this.jd.w("div",
"zm-command",[this.Cv=this.jd.w("a",{href:"javascript:;"},"取消")])]);this.UP.innerHTML='我们目前支持<a class="zg-link-gray" target="_blank" href="http://youku.com">优酷</a>、<a class="zg-link-gray" target="_blank" href="http://tudou.com">土豆</a>、<a href="http://video.sina.com.cn/" class="zg-link-gray" target="_blank">新浪</a>、<a href="http://v.qq.com/" class="zg-link-gray" target="_blank">腾讯</a>、<a href="http://www.56.com/" class="zg-link-gray" target="_blank">56</a>、<a href="http://tv.sohu.com/" class="zg-link-gray" target="_blank">搜狐</a>、<a href="http://www.iqiyi.com/" class="zg-link-gray" target="_blank">爱奇艺</a>视频服务。<br />请不要上传与回答问题无关的视频，详细请看 <a href="http://www.zhihu.com/question/20118966" target="_blank">知乎视频使用规范</a>';
this.S.e(this.Cv,"click",function(){this.ox();this.hide()}).e(this.Dn,"click",this.HH).e(this.$i,"click",this.na).e(this.Xn,"submit",function(){return sG(this,this.uu.value)}).e(Y,Xl,this.av);this.kD=b;var c=new DE(this);c.lb("插入视频").Na(b);b=GE(c);mi(b,k);return b};a.sG=function(b,c){c=Hk(c);if(!c)return n;var d=c.match(/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[\-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi);d||(Q(b.kh,n),b.nf.innerHTML="我们无法识别你输入的视频页地址",Q(b.nf,j));return d};
t.HH=function(){if(this.uu.value){var b=Hk(this.uu.value);b&&sG(this,b)&&(Q(this.kh,j),Q(this.nf,n),this.Xn.submit())}};t.na=function(b){"save"===(b.target&&b.target.name)&&this.HH()};t.av=function(b){Q(this.kh,n);this.tk(b.qb)};t.tk=function(b){b&&!b.r?(this.dispatchEvent(this.Fn(b.msg[0],b.msg[1],b.msg[2],b.msg[3],b.msg[4])),this.hide()):(b=b.msg,Q(this.kh,n),this.nf.innerHTML=b,Q(this.nf,j))};t.Fn=function(b,c,d,e,g){return new rG(b,c,d,e,g)};t.z=function(){this.S.H();this.S=k;qG.n.z.call(this)};
a.tG=function(){HE.call(this,DD);this.S=new qe(this)};y(tG,HE);t=tG.prototype;t.md=of("VideoDialogPlugin");t.of=function(b,c){var d=this.D;return!d.xf&&(d.dg(),!d.xf)?n:tG.n.of.call(this,b,c)};t.fo=function(b){tG.n.fo.call(this,b)};t.Ov=function(b){b=new qG(b);this.S.e(b,"ok",this.mo).e(b,"cancel",this.px);return b};t.z=function(){tG.n.z.call(this);this.S.H()};
t.mo=function(b){JE(this);var c=nD(this),d=c.w("embed");F.forEach({type:"application/x-shockwave-flash",allowscriptaccess:"always",allowfullscreen:"true",wmode:"opaque","class":"video",width:"420",height:"350",src:b.aW,"data-poster":b.poster,"data-name":b.$V,"data-videoid":b.ZV,"data-sourceurl":b.VU},function(b,c){d.setAttribute(c,b)});b=lD(d);Fa(b,'">')&&(b+="</embed>");var b=ic(b+" "),e=b.firstChild,g=ww(this.D);if(ED(g))g.ug(b),A?document.selection&&(c=document.selection.createRange(),c.move("character",
-1),c.select()):(ct(e),c.Ta().focus()),Yv(this.D),this.D.He();else return k;this.S.Sc()};t.px=function(){this.S.Sc()};a.Nt=j,a.uG=Uv.prototype.execCommand;Uv.prototype.execCommand=function(b){var c=this.D;return F.contains(OD,b)&&!c.xf?(c.dg(),n):uG.apply(this,arguments)};a.vG=HE.prototype.execCommand,a.wG=["+equation"];HE.prototype.execCommand=function(b){var c=this.D;return z.contains(wG,b)&&!c.xf&&(c.dg(),!c.xf)?n:vG.apply(this,arguments)};DD="video";JD=mb?"⌘":"ctrl";hB[DD]={Aa:DD,T:"插入视频",Oa:"tr-icon tr-video",factory:hA};hB["+equation"]={Aa:"+equation",T:nA.FX,Oa:"tr-icon tr-equation",factory:hA};
hB["+bold"].T="粗体 ("+JD+"+b)";hB["+italic"].T="斜体 ("+JD+"+i)";hB["+underline"].T="下划线 ("+JD+"+u)";hB["+superscript"].T="引用内容";hB["+insertOrderedList"].T="有序列表";hB["+insertUnorderedList"].T="无序列表";hB["+removeFormat"].T="清除格式";hB.image.T="插入图片";hB[DD].T="插入视频";hB["+equation"].T="插入公式";a.xG=function(){};ia(xG);
xG.prototype.Qg=function(b,c){this.gD=c;var d,e,g;e=J("zm-editable-toolbar-container",b);d=J("zm-editable-editor-outer",b);g=J("zm-editable-editor-field-element",b);var h=new Cw(g.id);h.UL=89;var l=[];c.enableFullScreen&&l.push("toggleFullScreen");l.push("+bold","+italic","+underline",new gF,"+blockquote","+code","+insertOrderedList","+insertUnorderedList","+equation");c.canUploadMedia_&&l.push(new gF,"image",DD);c.useRemoveFormat_&&l.push(new gF,"+removeFormat");var m=Vb(e);g=[];for(var p=0,r;r=
l[p];p++){if(oa(r)){var w=i;if(r=hB[r]){var w=r.factory||iA,B=r.Aa,H=r.T,G=r.caption,S=r.Oa,X=m||Vb(),w=w(B,H,G,S,k,X);r.kb&&(w.kb=j)}r=w}r&&g.push(r)}var l=Vb(e),ja=new xD(lz.U(),Op,l),l=hg(e);ja.Fi(l);ja.Ze(n);for(m=0;p=g[m];m++)rp(p,32,n),p.Fi(l),ja.J(p,j);ja.aa(e);new iF(h,ja);Vc(h,ja);mD(h,new ND);mD(h,new WE);if(c.loremIpsum_&&(mD(h,new XE(c.loremIpsum_)),C))h.on("load",function(){Ad(h.m(),"focus",function(){h.execCommand("clearlorem",j)})});mD(h,new hE);mD(h,new kG);mD(h,new aF);e=new YF;mD(h,
e);mD(h,new pG);mD(h,new tG);mD(h,new HF);mD(h,new DF);mD(h,new EF);mD(h,new RF);c.enableFullScreen&&(d=new lB({title:"写作模式",Fk:d}),mD(h,d));h.on("load",function(){c.useScraper_&&this.ts(h,ja)},n,this);return[h,ja]};xG.prototype.ts=function(b,c){var d=b.m(),e=new Qw;e.o(d);var g=K("div",{style:"display:none",className:"tr-spinner spinner-gray"});c.m().appendChild(g);e.on("willScrape",function(){Q(g,j)}).on("didScrape",function(){Q(g,n)});Vc(b,e)};
Ca("ZH.createRichTextEditor",function(b,c){return xG.U().Qg(b,c)});Lf("rich_text_editor");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/rich_text_editor.js
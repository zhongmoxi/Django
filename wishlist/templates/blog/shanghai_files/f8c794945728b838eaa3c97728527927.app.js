(function(a){with(a){
a.Xs=function(b,c){this.ga=b;this.offset=c},a.Ys=function(b){return b.length||b.childNodes.length},a.Zs=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Ys(b):(b=e,c=0)):(b=b.lastChild,c=Ys(b))}return new Xs(b,c)},a.$s=function(b,c){b!=k&&this.append.apply(this,arguments)};t=$s.prototype;t.Ph="";t.set=function(b){this.Ph=""+b};t.append=function(b,c,d){this.Ph+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.Ph+=arguments[e];return this};
t.clear=function(){this.Ph=""};t.Pr=u(48);t.toString=q("Ph");a.at=function(b){this.type="anon_change";this.mb=b};y(at,kd);a.Z=function(b,c){return da[b]=c};Rf.prototype.expand=Z(62,function(b,c,d,e){ra(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});Hp.prototype.expand=Z(61,function(){this.Pa(j)});Wh.prototype.wp=Z(60,function(b){Xh(this);this.Zk=b});
Di.prototype.wp=Z(59,function(b){this.Zk=b;this.Da&&Ei(this)});op.prototype.Gm=Z(55,function(b){this.Na(b)});ae.prototype.Ei=Z(54,ca("MG"));Wh.prototype.ly=Z(53,function(){return this.Pj||150>za()-this.ty});fq.prototype.Gb=Z(52,function(){var b=this.yc();return 1==b.nodeType?b:b.parentNode});Mr.prototype.We=Z(50,function(b){this.W.St(b)});Cj.prototype.getDay=Z(49,function(){return this.ba.getDay()});$s.prototype.Pr=Z(48,function(){return this.Ph.length});En.prototype.fireEvent=Z(37,function(b){this.dispatchEvent(b)});
Cj.prototype.setTime=Z(36,function(b){this.ba.setTime(b)});go.prototype.Qc=Z(31,function(){return Ic(this.m())});rq.prototype.Qc=Z(30,function(){return this.Q.toString()});wq.prototype.Qc=Z(29,function(){return this.Q.text});Gq.prototype.Qc=Z(28,function(){return Kq(this).Qc()});Mq.prototype.Qc=Z(27,s(""));Sq.prototype.Qc=Z(26,function(){return z.map(hq(this),function(b){return b.Qc()}).join("")});
Tb.prototype.Qv=Z(21,function(b,c,d){for(var e=this.Ja,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});kp.prototype.Ff=Z(20,function(b,c){var d=b.Md(),e=this.P()+"-collapse-left",g=this.P()+"-collapse-right";b.oj(d?g:e,!!(c&1));b.oj(d?e:g,!!(c&2))});vp.prototype.Ff=Z(19,function(b){this.N.Ff(this,b)});
ai.prototype.Dp=Z(18,ca("ek"));op.prototype.Dp=Z(17,ca("ek"));
kf.prototype.zq=Z(14,function(b,c,d){var e=za(),g=d?d:e,h=this.vl.Vg.length?this.vl.Vg.pop():this.vl.fl();h.Dr=2;h.Cr=g;h.type=c;h.dD=b;b=(b=this.GZ)&&b.isTracing()?b.totalVarAlloc:-1;h.gJ=b;this.Lv++;if(d){d=this.$f.length;for(b=0;b<d;b++)if(this.$f[b].Cr>g){z.wo(this.$f,h,b);break}b==d&&this.$f.push(h)}else this.$f.push(h);if(g=h.type)h=this.wk.get(g),h||(h=this.Op.Vg.length?this.Op.Vg.pop():this.Op.fl(),h.type=g,this.wk.set(g,h)),h.count++;this.qu+=za()-e});Mp.prototype.Vw=Z(12,function(){return Pp});
Wr.prototype.Nr=Z(0,q("Ma"));
a.bt=function(b){b.iy=j;b.uD=xg(b.m()).height;Br+=b.uD;z.forEach(zr,function(b){b&&(!b.iy&&b.Bl)&&b.mp()})},a.ct=function(b,c){var d=b.parentNode,e=z.indexOf(d.childNodes,b)+(c?0:1),d=Zs(d,e,c);A&&(Gb("9")&&1==d.ga.nodeType&&"HR"==d.ga.tagName)&&(e=d.ga,d.ga=e.parentNode,d.offset=z.indexOf(d.ga.childNodes,e)+(c?0:1));Zq(d.ga,d.offset).select()},a.dt=function(b,c){b.Iy=c==k||c instanceof Rf?c:new Rf(c,i,i,i);b.V()&&b.pa()},a.et=function(b,c){if(zm(b))b.selectionStart=c,b.selectionEnd=c;else if(A){var c=
Cm(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},a.ft=function(b){var c={};z.forEach(b.data.Hb(),function(b){c[b]=this.data.get(b)},b);return c},a.gt=function(b){b.bc()&&b.fire()},a.ht=function(b,c){return b.Pd.get(c)},a.it=function(b,c,d){var e=Pi,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",content:"你对该问题的回答、赞同和关注行为将以实名显示。"};
Hi(b?g:h,function(g){if(g){var h=new V(j),p="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||hh.oa);h.on("success",function(){var c=Le(h);c&&!c.r&&e.dispatchEvent(new at(b))});h.ajax(p,r)}c&&c(g)})},a.jt=function(b,c){return b.Yb&&c?z.indexOf(b.Yb,c):-1},a.kt=function(b){return b!=k},a.lt=function(b){return!/[^\t\n\r ]/.test(b)},a.mt=function(b,c,d){this.TG=b;this.aU=!!d;b&&!c&&this.next()};y(mt,Qd);
mt.prototype.next=function(){var b=this.TG;b||f(O.fb);this.TG=this.aU?b.previousSibling:b.nextSibling;return b};a.nt=function(b){return 1==b.nodeType||3==b.nodeType&&!lt(b.nodeValue)},a.ot=function(b){try{return b.next()}catch(c){return k}},a.pt=function(b,c,d){la(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);mt.call(this,b.childNodes[d],j,c)};y(pt,mt);
a.qt=function(b,c,d,e,g,h){oa(b)?(this.Sd="y"==b?c:0,this.Od="m"==b?c:0,this.Dd="d"==b?c:0,this.od="h"==b?c:0,this.pd="n"==b?c:0,this.vd="s"==b?c:0):(this.Sd=b||0,this.Od=c||0,this.Dd=d||0,this.od=e||0,this.pd=g||0,this.vd=h||0)};t=qt.prototype;
t.Dk=function(b){var c=Math.min(this.Sd,this.Od,this.Dd,this.od,this.pd,this.vd),d=Math.max(this.Sd,this.Od,this.Dd,this.od,this.pd,this.vd);if(0>c&&0<d)return k;if(!b&&0==c&&0==d)return"PT0S";d=[];0>c&&d.push("-");d.push("P");(this.Sd||b)&&d.push(Math.abs(this.Sd)+"Y");(this.Od||b)&&d.push(Math.abs(this.Od)+"M");(this.Dd||b)&&d.push(Math.abs(this.Dd)+"D");if(this.od||this.pd||this.vd||b)d.push("T"),(this.od||b)&&d.push(Math.abs(this.od)+"H"),(this.pd||b)&&d.push(Math.abs(this.pd)+"M"),(this.vd||
b)&&d.push(Math.abs(this.vd)+"S");return d.join("")};t.Zf=function(b){return b.Sd==this.Sd&&b.Od==this.Od&&b.Dd==this.Dd&&b.od==this.od&&b.pd==this.pd&&b.vd==this.vd};t.clone=function(){return new qt(this.Sd,this.Od,this.Dd,this.od,this.pd,this.vd)};t.bJ=function(b){return new qt(this.Sd*b,this.Od*b,this.Dd*b,this.od*b,this.pd*b,this.vd*b)};t.add=function(b){this.Sd+=b.Sd;this.Od+=b.Od;this.Dd+=b.Dd;this.od+=b.od;this.pd+=b.pd;this.vd+=b.vd};
a.rt=function(b){return 1==b.length?"0"+b:b},a.st=/^#(?:[0-9a-f]{3}){1,2}$/i,a.tt=/Z|(?:([-+])(\d{2})(?::?(\d{2}))?)$/,a.ut=/^(\d{2})(?::?(\d{2})(?::?(\d{2})(\.\d+)?)?)?$/,a.vt=/^(\d{4})(?:(?:-?(\d{2})(?:-?(\d{2}))?)|(?:-?(\d{3}))|(?:-?W(\d{2})(?:-?([1-7]))?))?$/,a.wt=function(b,c){var d=$.extend({all:n},wt.R,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?n:j};wt.R={paddingTop:0};
a.xt=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.yt=/#(.)(.)(.)/,a.zt=function(b){var c=b.body,b=b.documentElement;return new Pb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.At=function(b){for(var c;c=!b||1!=b.nodeType?k:ot(O.filter(new pt(b,n),nt));)b=c;return b},a.Bt=function(b,c,d){Xp.call(this,b,0,d?"添加父话题":"添加子话题");this.my=d;this.Lf=c;this.qs="";this.aI="/topic/parent/remove";this.NY=j};y(Bt,Xp);t=Bt.prototype;
t.o=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))Bt.n.o.call(this,b),this.ie(j),Q(this.mE,n)};t.vf=function(b){var c;this.my&&(c="/topic/autocomplete?no_create=true");Bt.n.vf.call(this,b,c);this.O.zf.jE=n};t.qk=function(){return v(function(b,c){return z.filter(b,function(b){return 3>=b.length?n:z.every(this.data,function(e){return e[1]===b[2]?c===b[1]?(b[0]="plain_text",b[1]='"'+c+'"已在现有列表中',j):n:j})},this)},this)};
t.df=function(b,c){this.jh||(this.jh=j,this.xhr=new V(j),P(this.h(),this.xhr,"complete",this.$u),b||(b=-1),this.my?this.xhr.ajax("/topic/add","tid="+this.Lf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.Lf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.tE=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.dp=function(b){if(!this.ma||!this.ma.bc()){var c=new V(j);this.h().e(c,"success",function(){var d=Le(c);d.r?U(d.msg):(Zp(this),this.Xe(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.my?c.ajax(this.aI,"cid="+this.Lf+"&pid="+b):c.ajax(this.aI,"pid="+this.Lf+"&cid="+b);this.ma=c}};a.Ct=function(b,c){this.Vh=b instanceof Pb?b:new Pb(b,c)};y(Ct,bo);Ct.prototype.pa=function(b,c,d,e){var g=zt(Ub(b)),h=this.Vh.x+g.x,g=this.Vh.y+g.y,l=Nm(b),h=h-l.x,g=g-l.y;Om(new Pb(h,g),b,c,d,k,k,e)};
a.Dt=function(b,c){if(b){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({EJ:wt},al,c||{});if(!d.EJ(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.tC?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}}},a.Et=function(b,c){c.all=j;return wt(b,c)},a.Ft=function(b){var c=b.match(xt);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.Gt=function(b){st.test(b)||f(Error("'"+
b+"' is not a valid hex color"));4==b.length&&(b=b.replace(yt,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.Ht={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",
firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",
lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",
mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",
rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},
a.It=function(b,c,d,e,g,h,l){this.ba=pa(b)?new Date(b,c||0,d||1,e||0,g||0,h||0,l||0):new Date(b?b.getTime():za())};y(It,Cj);t=It.prototype;t.getHours=function(){return this.ba.getHours()};t.getMinutes=function(){return this.ba.getMinutes()};t.getSeconds=function(){return this.ba.getSeconds()};t.getUTCHours=function(){return this.ba.getUTCHours()};t.setHours=function(b){this.ba.setHours(b)};t.setMinutes=function(b){this.ba.setMinutes(b)};t.setSeconds=function(b){this.ba.setSeconds(b)};
t.setMilliseconds=function(b){this.ba.setMilliseconds(b)};t.setUTCHours=function(b){this.ba.setUTCHours(b)};t.add=function(b){Cj.prototype.add.call(this,b);b.od&&this.setHours(this.ba.getHours()+b.od);b.pd&&this.setMinutes(this.ba.getMinutes()+b.pd);b.vd&&this.setSeconds(this.ba.getSeconds()+b.vd)};
t.Dk=function(b,c){var d=Cj.prototype.Dk.call(this,b);return b?d+" "+bb(this.getHours())+":"+bb(this.getMinutes())+":"+bb(this.getSeconds())+(c?Dj(this):""):d+"T"+bb(this.getHours())+bb(this.getMinutes())+bb(this.getSeconds())+(c?Dj(this):"")};a.Jt=function(b){return Cj.prototype.Dk.call(b,j)+"T"+bb(b.getHours())+":"+bb(b.getMinutes())+":"+bb(b.getSeconds())+Dj(b)};t.Zf=function(b){return this.getTime()==b.getTime()};t.toString=function(){return this.Dk()};
t.clone=function(){var b=new It(this.ba);b.Ug=this.Ug;b.yl=this.yl;return b};a.Kt=/[^\d]+$/,a.Lt=function(b){Zq(At(b),0).select()},a.Mt=function(b,c){var d=Jc(b);if(b.getElementsByTagName)for(var e in xr)if(b.tagName==e||0<b.getElementsByTagName(e).length)return n;return!c&&" "==d||lt(d)},a.Nt=j,a.Ot=function(b){if(b=gq(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Pt=function(b){Xp.call(this);this.vD=k;this.ad="例如：互联网、医学、法律、数学...";this.data=b||[]};
y(Pt,Xp);t=Pt.prototype;
t.o=function(b){this.g=b;this.af=J("zm-tag-editor-labels",this.g);this.ie(j);this.Be();this.Sa();this.ag=I("zh-expert-topics");this.en=I("zh-active-topics");if(this.ag)$(this.ag).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(oc(this.en,d[0],0),Mk(d[0])):L(d[0]);z.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Qt(this);this.dispatchEvent("remove")},this));if(this.en)$(this.en).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");oc(this.ag,b[0],0);Mk(b[0]);Qt(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.Bm()};t.Tn=function(){this.hc||(this.hc=K("div","zm-tag-editor-editor",[this.lf=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=I("profile-expert-edit-input")])]),this.ad&&(this.ry=new Io(this.ad),this.ry.o(this.Ra),this.Ra.title=this.ad),nc(this.hc,this.af),this.vf(this.lf))};
t.vf=function(b){this.O=new Uo("/topic/autocomplete",this.Ra,k,k,b,j);this.O.Hf(j);this.O.ri=this.je;this.O.Ep(this.qk());this.O.Aw=[this.ad];this.h().e(this.O,"select",this.Uo);this.h().e(this.O,tm.Jh.Ri,this.Zu);this.h().e(this.O,tm.Jh.Ri,this.Xu);this.h().e(this.O,tm.Jh.cK,function(){$(this.O.N.g).hide()})};t.Xu=function(){if(0===this.O.Xa.length){var b=K("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.Ra).val()+" 的话题");$(this.O.N.g).html(b).show()}};
t.Uo=function(){var b=z.slice(this.O.fg(),1);b&&3<b.length&&(this.zD=b,this.df(b))};t.df=function(b){this.data.push(b[1]);var c=$(this.ag).find("[data-url-token='"+b[1]+"']")[0];c?Mk(c):(fk("TopicMediumV2",{member_url_token:R[1],topic_url_token:b[1]},this.hr,this),$(this.en).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.hr=function(b){b=$(b)[0];oc(this.ag,b,0);Mk(b);Qt(this)};t.Xe=ba();
t.Bm=function(){if(!gh.Bc){var b=this;this.Xf&&this.Xf.H();var c=new dm;c.wr="expert-item-moving";em(c,this.ag,4);c.B();this.Xf=c;this.h().e(this.Xf,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.ag).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})});this.h().e(this.Xf,"beforedragstart",function(){return J("editing",this.ag)?n:j})}};
a.Qt=function(b){var c=$(b.ag).children().length;6<c&&L($(b.ag).children()[6]);Q(I("zh-profile-expert-empty"),0>=c);0<c&&Q(I("zh-profile-expert-warning"),n);Q(I("active-topics-wrap"),$(b.en).children().length);b.Bm()};t.qk=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Rt=function(b){Xp.call(this,b,0);this.qs="";this.LC="/topic/ignore"};y(Rt,Bt);
Rt.prototype.df=function(b){this.jh||(this.jh=j,this.xhr=new V(j),P(this.h(),this.xhr,"complete",this.$u),this.xhr.ajax(this.LC,"tid="+b+"&method=add"))};Rt.prototype.dp=function(b){this.jh||(this.jh=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",function(){Zp(this);this.Xe();this.jh=n}),this.xhr.ajax(this.LC,"tid="+b+"&method=del"))};a.St=function(){Xp.call(this,k,k,"搜索话题");this.vD=k;this.ad="";this.data=[kh[0]]};y(St,Xp);t=St.prototype;
t.o=function(b){this.g=b;this.af=J("zm-tag-editor-labels",this.g);this.ie(j);this.Be();this.Sa()};t.Tn=function(){this.hc||(this.hc=K("div","zm-tag-editor-editor",[this.Pn=K("div","zg-section zg-clear"),this.lf=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=I("zh-topic-merge-input"),K("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.mE=I("zh-topic-merge-btn")])]),nc(this.hc,this.af),this.vf(this.lf))};
t.vf=function(b){this.O=new Uo("/topic/autocomplete",this.Ra,k,k,b,j);this.O.Hf(j);this.O.ri=this.je;this.O.Ep(this.qk());this.O.Aw=[this.ad];this.h().e(this.O,"select",this.Uo);this.h().e(this.O,tm.Jh.Ri,this.Zu)};t.qk=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.Uo=function(){var b=z.slice(this.O.fg(),1);b&&3<b.length&&(this.zD=b,this.df(b[3],b[0]))};
t.df=function(b,c){var d=this;setTimeout(function(){d.Ra.value=c});this.vD=b};t.Xe=ba();a.Tt=function(b){Xp.call(this,[],0);this.tD=this.Gs=k;this.FC="/reviewq/question?queue_id="+b+"&task_id="};y(Tt,Xp);Tt.prototype.GS=function(){this.locked=n;var b=Le(this.kB);b&&b.r?U(b.msg):(this.data=b.msg,this.ie(j),Zp(this))};a.Ut=function(b,c,d){T.call(this,d);this.N=c||Mp.U();this.zb=b||this.N.Vw()};y(Ut,T);t=Ut.prototype;t.py=k;t.pb=k;t.N=k;t.zb=k;t.nb=j;t.jc=j;t.Lw=j;t.Ib=-1;t.oc=k;t.mg=n;t.uL=n;t.RS=j;
t.Lg=k;t.lc=function(){return this.py||this.N.lc(this)};t.Or=function(){return this.pb||(this.pb=new gl(this.lc()))};t.w=function(){this.g=this.N.w(this)};t.fa=function(){return this.N.fa(this.m())};t.Kc=function(b){return this.N.Kc(b)};t.$=function(b){this.g=this.N.o(this,b);"none"==b.style.display&&(this.nb=n)};
t.C=function(){Ut.n.C.call(this);Th(this,function(b){b.Da&&Vt(this,b)},this);var b=this.m();this.N.Pe(this);this.F(this.nb,j);this.h().e(this,"enter",this.vx).e(this,"highlight",this.zx).e(this,"unhighlight",this.Ix).e(this,"open",this.aP).e(this,"close",this.iO).e(b,"mousedown",this.Me).e(Ub(b),"mouseup",this.pO).e(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.hO);this.oi()&&Wt(this,j)};
a.Wt=function(b,c){var d=b.h(),e=b.lc();c?d.e(e,"focus",b.Le).e(e,"blur",b.$c).e(b.Or(),"key",b.$b):d.ya(e,"focus",b.Le).ya(e,"blur",b.$c).ya(b.Or(),"key",b.$b)};t.ab=function(){this.Tb(-1);this.oc&&this.oc.ub(n);this.mg=n;Ut.n.ab.call(this)};t.z=function(){Ut.n.z.call(this);this.pb&&(this.pb.H(),this.pb=k);this.N=this.oc=this.Lg=this.py=k};t.vx=s(j);
t.zx=function(b){var c=jt(this,b.target);if(-1<c&&c!=this.Ib){var d=Xt(this);d&&d.wd(n);this.Ib=c;d=Xt(this);this.mg&&d.setActive(j);this.RS&&(this.oc&&d!=this.oc)&&(d.Ub&64?d.ub(j):this.oc.ub(n))}Rc(this.m(),Yc.$m,b.target.m().id)};t.Ix=function(b){b.target==Xt(this)&&(this.Ib=-1);Rc(this.m(),Yc.$m,"")};t.aP=function(b){if((b=b.target)&&b!=this.oc&&b.getParent()==this)this.oc&&this.oc.ub(n),this.oc=b};t.iO=function(b){b.target==this.oc&&(this.oc=k)};
t.Me=function(b){this.jc&&(this.mg=j);var c=this.lc();c&&Fc(c)?c.focus():b.preventDefault()};t.pO=function(){this.mg=n};t.hO=function(b){var c;a:{c=b.target;if(this.Lg)for(var d=this.m();c&&c!==d;){var e=c.id;if(e in this.Lg){c=this.Lg[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.Me(b);break;case "mouseup":c.hg(b);break;case "mouseover":c.nd(b);break;case "mouseout":c.ki(b);break;case "contextmenu":c.jo(b)}};t.Le=ba();t.$c=function(){this.Tb(-1);this.mg=n;this.oc&&this.oc.ub(n)};
t.$b=function(b){return this.isEnabled()&&this.V()&&(0!=Uh(this)||this.py)&&this.uf(b)?(b.preventDefault(),b.stopPropagation(),j):n};
t.uf=function(b){var c=Xt(this);if(c&&"function"==typeof c.$b&&c.$b(b)||this.oc&&this.oc!=c&&"function"==typeof this.oc.$b&&this.oc.$b(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return n;switch(b.keyCode){case 27:if(this.oi())this.lc().blur();else return n;break;case 36:Yt(this);break;case 35:Zt(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.zb==Pp)$t(this);else return n;break;case 37:if(this.zb==Op)this.Md()?au(this):$t(this);else return n;break;case 40:if(this.zb==
Pp)au(this);else return n;break;case 39:if(this.zb==Op)this.Md()?$t(this):au(this);else return n;break;default:return n}return j};a.Vt=function(b,c){var d=c.m(),d=d.id||(d.id=c.ce());b.Lg||(b.Lg={});b.Lg[d]=c};t.J=function(b,c){Ut.n.J.call(this,b,c)};t.Uk=function(b,c,d){b.vk|=2;b.vk|=64;(this.oi()||!this.uL)&&rp(b,32,n);b.Bp(n);Ut.n.Uk.call(this,b,c,d);b.Da&&this.Da&&Vt(this,b);c<=this.Ib&&this.Ib++};
t.removeChild=function(b,c){if(b=oa(b)?Rh(this,b):b){var d=jt(this,b);-1!=d&&(d==this.Ib?b.wd(n):d<this.Ib&&this.Ib--);(d=b.m())&&(d.id&&this.Lg)&&F.remove(this.Lg,d.id)}b=Ut.n.removeChild.call(this,b,c);b.Bp(j);return b};t.Cp=function(b){this.m()&&f(Error("Component already rendered"));this.zb=b};t.V=q("nb");
t.F=function(b,c){if(c||this.nb!=b&&this.dispatchEvent(b?"show":"hide")){this.nb=b;var d=this.m();if(d){Q(d,b);if(this.oi()&&(d=this.lc()))d.tabIndex=this.jc&&this.nb?0:-1;c||this.dispatchEvent(this.nb?"aftershow":"afterhide")}return j}return n};t.isEnabled=q("jc");
t.Ya=function(b){if(this.jc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.jc=j,Th(this,function(b){b.GJ?delete b.GJ:b.Ya(j)})):(Th(this,function(b){b.isEnabled()?b.Ya(n):b.GJ=j}),this.mg=this.jc=n),this.oi()){var c=this.lc();c&&(c.tabIndex=b&&this.nb?0:-1)}};t.oi=q("Lw");t.Ze=function(b){b!=this.Lw&&this.Da&&Wt(this,b);this.Lw=b;if(this.jc&&this.nb){var c=this.lc();c&&(c.tabIndex=b?0:-1)}};t.Tb=function(b){(b=Vh(this,b))?b.wd(j):-1<this.Ib&&Xt(this).wd(n)};
t.wd=function(b){this.Tb(jt(this,b))};a.Xt=function(b){return Vh(b,b.Ib)},a.Yt=function(b){Zt(b,function(b,d){return(b+1)%d},Uh(b)-1)},a.au=function(b){Zt(b,function(b,d){return(b+1)%d},b.Ib)},a.$t=function(b){Zt(b,function(b,d){b--;return 0>b?d-1:b},b.Ib)},a.Zt=function(b,c,d){for(var d=0>d?jt(b,b.oc):d,e=Uh(b),d=c.call(b,d,e),g=0;g<=e;){var h=Vh(b,d);if(h&&b.RC(h)){b.lA(d);break}g++;d=c.call(b,d,e)}};t.RC=function(b){return b.V()&&b.isEnabled()&&!!(b.Ub&2)};t.lA=function(b){this.Tb(b)};
a.bu=function(b,c){Ct.call(this,b,c)};y(bu,Ct);bu.prototype.Go=0;bu.prototype.Im=ca("Go");bu.prototype.pa=function(b,c,d,e){var g=dg(b),g=ig(g),h;h=Vb(b);h=bc(h.Ja);h=new Pb(this.Vh.x+h.scrollLeft,this.Vh.y+h.scrollTop);var l=c,m=Om(h,b,l,d,g,10,e);if(0!=(m&496)){if(m&16||m&32)l^=2;if(m&64||m&128)l^=1;m=Om(h,b,l,d,g,10,e);0!=(m&496)&&Om(h,b,c,d,g,this.Go,e)}};a.cu=function(b,c,d,e){co.call(this,b,c);this.Go=d?5:0;this.xz=e||i};y(cu,co);cu.prototype.bo=q("Go");cu.prototype.Im=ca("Go");
cu.prototype.pa=function(b,c,d,e){var g=Pm(this.element,this.Uf,b,c,k,d,10,e,this.xz);if(g&496){var h=du(g,this.Uf),c=du(g,c),g=Pm(this.element,h,b,c,k,d,10,e,this.xz);g&496&&(h=du(g,h),c=du(g,c),Pm(this.element,h,b,c,k,d,this.bo(),e,this.xz))}};
a.du=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.eu={},a.fu={},a.gu=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<ac().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=zt(document);window.scrollTo(g.x,g.y+c-d)})}},a.hu=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=
Math.floor(b/604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.iu=function(){var b=R;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.ju=function(b,c){return!ma(b)?"匿名用户":['<a data-tip="p$t$',
b[1],'" href="/people/',b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',b[0],"</a>"].join("")},a.ku=function(b){if(0===b||1===b)return"匿名用户";var c=K("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.lu=function(b){if(0===b||1===b)return K("span");if(ma(b)){var c=K("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},K("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.mu=function(b){return 1===
b?j:ma(b)?b[3]===R[3]:n},a.nu=function(b,c){return $.post("/roundtable/"+b,{action:"add_question",url_token:c})},a.ou=function(b,c,d,e,g,h){h&&(e&&(e=$.proxy(e,h)),g&&(g=$.proxy(g,h)));$.post("/node/"+b,{method:c,params:d},function(b){b&&b.r?g&&g(b):e&&e(b)})},a.pu=function(b,c){return $.post("/question/askpeople",{qid:b,uid:c,op:"remove"})},a.qu=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.ru=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,
params:{answer_id:b}})},a.su=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},a.tu=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(st.test(d))return c.bs=Gt(d),c.type="hex",c;d=Ft(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=rt(e.toString(16));b=rt(b.toString(16));d=
rt(d.toString(16));c.bs="#"+e+b+d;c.type="rgb";return c}if(Ht&&(d=Ht[b.toLowerCase()]))return c.bs=d,c.type="named",c;f(Error(b+" is not a valid color string"))},a.uu=function(b){var c=new It(2E3),b=La(b),d=-1==b.indexOf("T")?" ":"T",b=b.split(d);var e=b[0].match(vt);if(e){var g=Number(e[2]),h=Number(e[3]),l=Number(e[4]),d=Number(e[5]),m=Number(e[6])||1;c.setFullYear(Number(e[1]));l?(c.setDate(1),c.setMonth(0),c.add(new qt("d",l-1))):d?(c.setMonth(0),c.setDate(1),e=c.getDay()||7,c.add(new qt("d",
(4>=e?1-e:8-e)+(Number(m)+7*(Number(d)-1))-1))):(g&&(c.setDate(1),c.setMonth(g-1)),h&&c.setDate(h));d=j}else d=n;if(d&&!(d=2>b.length))b=b[1],d=b.match(tt),m=0,d&&("Z"!=d[0]&&(m=60*d[2]+Number(d[3]),m*="-"==d[1]?1:-1),m-=c.getTimezoneOffset(),b=b.substr(0,b.length-d[0].length)),(d=b.match(ut))?(c.setHours(Number(d[1])),c.setMinutes(Number(d[2])||0),c.setSeconds(Number(d[3])||0),c.setMilliseconds(d[4]?1E3*d[4]:0),0!=m&&c.setTime(c.getTime()+6E4*m),d=j):d=n;return d?c:k},a.vu={eK:["公元前","公元"],dK:["公元前",
"公元"],nK:"1 2 3 4 5 6 7 8 9 10 11 12".split(" "),AK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),mK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),bn:"一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月".split(" "),xK:"1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月".split(" "),CK:"一月 二月 三月 四月 五月 六月 七月 八月 九月 十月 十一月 十二月".split(" "),PK:"星期日 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),EK:"星期日 星期一 星期二 星期三 星期四 星期五 星期六".split(" "),YB:"周日 周一 周二 周三 周四 周五 周六".split(" "),DK:"周日 周一 周二 周三 周四 周五 周六".split(" "),RB:"日一二三四五六".split(""),
BK:"日一二三四五六".split(""),yK:["1季","2季","3季","4季"],pK:["第1季度","第2季度","第3季度","第4季度"],VJ:["上午","下午"],OB:["y年M月d日EEEE","y年M月d日","yyyy-M-d","yy-M-d"],HK:["zzzzah时mm分ss秒","zah时mm分ss秒","ah:mm:ss","ah:mm"],Ku:6,Qu:[5,6],Lu:5},a.wu=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return n;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return n;
case 0:return!C;default:return 166>b.keyCode||183<b.keyCode}},a.xu={},a.yu=function(b){var c=Ub(b),d=A&&b.currentStyle;if(d&&Oc(Vb(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=yg(b,d.width,"width","pixelWidth"),b=yg(b,d.height,"height","pixelHeight"),new Rb(c,b);d=xg(b);c=Ag(b);b=jg(b);return new Rb(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.zu=function(b,c){var d=Vb(c),e=k;if(A)d=e=d.za().createStyleSheet(),A?d.cssText=b:d.innerHTML=b;else{var g=
Wb(d.Ja,"head",i,i)[0];g||(e=Wb(d.Ja,"body",i,i)[0],g=d.w("head"),e.parentNode.insertBefore(g,e));var h=e=d.w("style");A?h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.Au=function(b,c){var d=b.style[gb(c)];return"undefined"!==typeof d?d:b.style[Xf(b,c)]||""},a.Bu=function(b){var c=arguments,d=c.length;return function(){for(var b,g=0;g<d;g++)b=c[g].apply(this,arguments);return b}},a.Cu=function(){f(Error("unimplemented abstract method"))},a.Du=function(){M.call(this)};y(Du,Dn);
Du.prototype.B=function(){this.os=I("help-index");(new Ar).o(this.os);var b=window.location.href,c="";0<b.indexOf("#")&&(c=b.substring(b.indexOf("#")),b=b.substring(0,b.indexOf("#")));"/help"===b.substring(b.length-5)&&(b+="/faq");var d=Xb("a",k,this.os);z.forEach(d,function(d){(d.href===b||d.href===b+c)&&Kc(d,function(b){"UL"===b.tagName&&E.add(b,"force-display");"LI"===b.tagName&&E.add(b,"current")})},this);this.h().e(this.os,"click",this.HO)};
Du.prototype.HO=function(b){if((b=Qk(this.os,b.target))&&0<b.href.indexOf("#")){var c=Lc(b,"ul",k),c=Xb("li",k,c);z.forEach(c,function(b){E.remove(b,"current")},this);E.add(b.parentNode,"current")}};a.Eu=function(b){M.call(this);this.view=this.name=k;F.extend(this.options={},this.R,b||{})};y(Eu,Kd);a.Fu={},a.Gu=function(b,c){function d(c){Eu.call(this,c);this.name=b}y(d,Eu);ya(d.prototype,c);Fu[b]=d};Eu.prototype.R={};Eu.prototype.h=function(){return this.Zg||(this.Zg=new qe(this))};Eu.prototype.B=ba();Eu.prototype.z=function(){Eu.n.z.call(this);this.view&&(F.remove(this.view.td,this.name),this.view=k);this.Zg&&(this.Zg.H(),this.Zg=k)};a.Hu=function(b){T.call(this);F.extend(this.G={},this.R,b||{});this.source=this.G.source;this.promise=$.Deferred().resolve();this.td={}};y(Hu,T);t=Hu.prototype;t.R={source:k,ra:["autoload","shortcut"],wh:j,vn:"zg-btn-white zu-button-more"};t.ra=function(b,c){var d,e=Fu[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.Da?d.B(this):this.h().e(this,"initialized",function(){d.B(this)});this.td[b]=d;return this};
t.aj=function(){!this.Sf&&this.G.wh&&(this.Sf=this.xv(),nc(this.Sf,this.g),this.h().e(this.Sf,"click",this.Dy))};t.C=function(){Hu.n.C.call(this);this.aj();z.forEach(this.Pb(),this.hr,this);z.forEach(this.G.ra,this.ra,this);this.dispatchEvent("initialized")};t.z=function(){F.forEach(this.td,function(b){b.H()});this.td=k;Hu.n.z.call(this)};a.Iu=function(b,c,d){b.Da&&z.forEach(b.Pb(),c,d);b.h().e(b,"itemcreated",function(b){c.call(d,b.item)})};t.Pb=function(){return rc(this.g)};
t.hr=function(b,c){this.ak(b,c);this.dispatchEvent({type:"itemcreated",item:b,index:c})};t.ak=ha;a.Ju=function(b){b.Sf&&(L(b.Sf),b.Sf=k);b.dispatchEvent("complete")};t.fS=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.aa(c);this.dispatchEvent("next");(d||b.next===n)&&Ju(this)}};t.aa=function(b,c){var b=$.isArray(b)?b.join(""):b,d=ic(b+" ");z.forEach($.makeArray(rc(d)),this.hr,this);oc(this.g,d,c)};
t.Dy=function(){this.dispatchEvent("beforeloadnext")!==n&&"pending"!==this.promise.state()&&(this.II(j),this.promise=this.source().done(v(this.fS,this)).always(v(xa(this.II,n),this)))};t.ld=q("Sf");t.xv=function(){return K("a",{"aria-role":"button","class":this.G.vn},"更多")};t.II=function(b){this.Sf&&(this.Sf.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",E.enable(this.Sf,"loading",b))};a.Lu=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,m,p,r,w,B){if("%"==r)return"%";var H=d.shift();"undefined"==typeof H&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=H;return Ku[r].apply(k,arguments)})},a.Ku={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+ab(" ",d-b.length):
ab(" ",d-b.length)+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+ab(" ",b):(c=0<=c.indexOf("0",0)?"0":" ",e=h+ab(c,b)+e);return e},d:function(b,c,d,e,g,h,l,m){return Ku.f(parseInt(b,10),c,d,e,0,h,l,m)}};Ku.i=Ku.d;Ku.u=Ku.d;Gu("activeSource",{R:{$L:"%d 条新动态",vn:"zu-main-feed-fresh-button",T_:ha},B:function(b){this.data=[];this.button=this.xv();mc(this.button,b.m());this.h().e(this.button,"click",function(){b.aa(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!qa(d.H))&&f(Error("Source must return a disposable object."));this.jN=d},setData:function(b){this.data=b;this.OR()},OR:function(){var b=this.data.length;Ac(this.button,
Lu(this.options.$L,b));Q(this.button,!!b)},xv:function(){return K("a",{href:"javascript:;",style:"display:none","class":this.options.vn})},H:function(){Eu.prototype.H.call(this);Xc(this.jN);this.options=k;this.button&&(L(this.button),this.button=k)}});a.Mu=function(){M.call(this);this.size=k;this.WY=Ag(document.body).top;this.ha=new qe(this);this.Sp=k;this.cN=250;this.bh()};y(Mu,Kd);ia(Mu);Mu.prototype.bh=function(){this.size=ac();var b=this.Sp=new Wn(this.update,this.cN,this);this.ha.e(window,"scroll",b.fire,n,b).e(window,"resize",b.fire,n,b)};Mu.prototype.h=q("ha");Mu.prototype.z=function(){Mu.n.z.call(this);this.ha.H();this.ha=k;this.Sp.H();this.Sp=k};Mu.prototype.update=function(){this.size=ac();this.dispatchEvent("update")};
a.Ou=function(b,c,d){var e=Nu;e.ha.e(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.ha.ya(this,"update",h))})},a.Nu=Mu.U();$(function(){Nu.update()});Gu("autoload",{R:{fU:function(b){return 0!==b%3}},B:function(b){if(b.ld()&&R.Ia()){var c=this,d=Nu;c.h().e(d,"update",function(d){var e;e=ua(c);var l=wd[e];if(l){var m=la("abouttosee"),p=la(i);m&&p?(l=vd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!m&&!p?j:z.some(l,function(b){return m&&"abouttosee"==b.type||p&&b.capture==i})}else e=n;e&&(ug(b.ld())&&400>=b.ld().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.h().e(b,"complete",this.H).e(b,"next",function(){e+=
1;this.options.fU(e)&&this.enable()});this.enable()}},enable:function(){P(this.h(),this,"abouttosee",function(){this.view.Dy()})}});Gu("childConstructor",{R:{dj:k,factory:k},B:function(b){qa(this.options.dj)&&Iu(b,this.HM,this);qa(this.options.factory)&&Iu(b,this.tT,this)},HM:function(b){var c=new this.options.dj;this.view.J(c);c.o(b)},tT:function(b){var c=this.options.factory(b);this.view.J(c);c.o(b)}});Gu("locationSource",{R:{Ms:20,param:k,gp:n,offset:function(b){return b.length}},B:function(b){function c(b){return{start:d.gp?z.Ve(b).id.split("-")[1]:0,offset:d.offset(b)}}var d=this.options,e=d.url||location.href,g=b.Pb().length;(!g||g<d.Ms)&&Ju(b);b.source=function(){return $.post(e,(d.param||c)(b.Pb())).then(function(c){if(!c.r){var c=c.msg,e=c[0];pa(e)&&e<d.Ms&&Ju(b);return{results:c[1]}}})}}});Gu("nodeSource",{R:{VC:j},B:function(b){var c=$(b.m()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0,c=e.limit,h=e.pagesize;this.options.VC&&(c&&b.Pb().length<c)&&Ju(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Pb().length})}).then(function(b){var c=j;h&&(!b.r&&b.msg.length<h)&&(c=n);return!b.r&&{results:b.msg,next:c}})}}});Gu("shortcut",{R:{items:">div"},B:function(b){b.Pb().length&&(this.So=new Un(this.options),this.So.o(b.m()),this.h().e(this.So,"action",function(c){c.data.index>=c.data.size&&b.ld()&&ug(b.ld())&&b.ld().click()}))},H:function(){Eu.prototype.H.call(this);this.So&&(this.So.H(),this.So=k)}});a.Pu=function(b){F.extend(this.G={},this.R,b||{});this.content="";this.Hc=this.cf=this.ve=k;this.Fd=n;this.valid=j};y(Pu,T);t=Pu.prototype;t.R={oV:"textarea.content",PC:".toggle-expand",gV:".summary",jD:"zm-editable-content",Kr:n};
t.C=function(){Pu.n.C.call(this);var b=this.g,c=this.G;c.Kr?(this.ve=$("."+c.jD,b),this.content=this.ve.val(),this.Hc=$(c.PC,b)):(this.content=$(c.oV,b).remove().val(),this.ve=$(c.gV,b),this.Hc=$(c.PC,this.ve));if(this.ve.length){if(this.Hc.length)this.Hc.click(n).on("click",$.proxy(this.expand,this));this.ve.on("click",$.proxy(this.jP,this))}else this.valid=n,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.ld=function(){return this.Hc.get(0)};t.ib=q("content");
t.Pa=function(b){b?this.expand():this.collapse()};t.jP=function(b){var c=Xq();if(!c||!c.Qc())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),b.stopPropagation(),this.expand())};t.expand=function(){!this.Fd&&this.dispatchEvent("beforeexpand")!==n&&(this.Fd=j,this.G.Kr?(this.ve.removeClass("fixed-summary"),this.Hc.remove()):(this.cf?this.cf.show():this.ve.length&&(this.cf=$("<div>",{html:this.content,"class":this.G.jD}).insertBefore(this.ve)),this.ve.hide()),this.dispatchEvent("expand"))};
t.collapse=function(){this.Fd&&(this.Fd=n,this.cf&&this.cf.hide(),this.G.Kr?this.ve.addClass("fixed-summary"):this.ve.show())};Gu("expandLimit",{R:{bJ:3},B:function(b){var c=cj.create("ExpandLimit");c.get("expandCount")||c.$e("expandCount","0");R.Ia()||(this.h().e(b,"beforeexpand",function(b){var e=parseInt(c.get("expandCount"),10)||0;if(b.target instanceof Pu&&(b=e+1,c.$e("expandCount",b),b>=this.options.bJ))return new on("expand"),n}),this.h().e(b,"beforeloadnext",function(){new on("expand");return n}))}});a.Qu=function(b){Hu.call(this,b)};y(Qu,Hu);a.Ru=function(){M.call(this)};y(Ru,Kd);t=Ru.prototype;t.$B={question:"问题",comment:"评论",answer:"回答",favlist:"收藏",member:"用户",message:"私信",image:"图片",video:"视频",post:"文章"};t.Sv="report-dialog";t.sG="loading";t.LN='<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %>请选择理由</div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
t.Ww=q("On");t.yv=function(){var b=new Di;gi(b,j);b.Nn=j;mi(b,oi);b.addEventListener(ni,this.mO,n,this);Vc(b,this);return b};t.mO=function(b){if("ok"===b.key)return(b=$("form",this.On.m()).valid())&&this.submit(),b};
t.open=function(b,c,d){var e=this.On=this.yv();e.lb(this.AE(b));e.Na(this.zv());e.F(j);E.add(e.m(),this.Sv);E.add(e.m(),this.sG);this.GE(b).then(v(function(g){e.Na(Xk(this.LN,{each:z.forEach,options:g,headnote:d}));E.remove(e.m(),this.sG);e.pa();e.uh(450);this.ww={type:b,id:c};this.pv(b,g)},this))};t.XE=ba();
t.pv=function(b,c){var d=this,e=$(this.On.m()),g=$("form",e),h=$(".reason-text",e);e.on("change",":radio",function(b){b=$(b.target);e.find("li").removeClass("checked");b.parentsUntil(g,"li").addClass("checked");var m=this.value,p=z.find(c,function(b){return m===String(b.value)});d.XE(p);p="0"===m;h.toggle(p);p&&h.placeholder();b.closest("li").find("ul, :text").length||g.valid()});e.find("ul ul").on("change",":radio",function(b){$(b.delegateTarget).parent().find(".group-description").text($(this).data("description"))});
g.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",e).length}}},messages:{reason:"请选择理由",detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",g)})};t.zv=s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>');a.Su=function(){M.call(this)};y(Su,Ru);Su.prototype.GE=v(Vs(function(b){return $.getJSON(Ga("/report/%s/options",b))}),fa);Su.prototype.AE=function(b){return Ga("为什么举报这个%s？",this.$B[b]||"条目")};Su.prototype.submit=function(){var b=this.Ww(),c=$($("form",this.On.m())[0]).serialize()+"&"+$.param(this.ww);$.post("/report",c).done(function(c){b.F(n);c.r?U(c.msg):U("您的举报我们已经收到，处理完成后会私信告知处理结果。",2E3)});Y.Y({type:"ga_click_report",data:{type:this.ww.type}})};
a.Tu=rn(function(b,c,d){Y.Y({type:"ga_click_report_box",data:{type:b}});(new Su).open(b,c,d)},j);a.Uu=function(){M.call(this);this.Re="zm-pm-item"};y(Uu,Dn);Uu.prototype.B=function(){var b=I("zh-create-pm");b&&this.h().e(b,"click",this.MR);var b=I("zh-pm-item-wrap"),c=new Qu;c.ra("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.o(b);this.h().e(b,"click",this.na);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})})};
Uu.prototype.MR=rn(function(){var b;this.Ij();this.Sb.show();Zo(this.Sb,-1);(b=Xa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Sb.St(b)},j);Uu.prototype.Ij=function(){this.Sb||(this.Sb=new Vo({At:j}))};
Uu.prototype.na=function(b){if(b=Qk(this.z_,b.target)){var c=b.name,d=Mc(b,this.Re);if(!d||!b.name)return j;var e=$(d).data(),g=e.member,h=e.name;switch(c){case "reply":rn(v(function(){this.Ij();this.Sb.show();var b=this.Sb,c=e.type;b.Rp=e.token;b.bB=c;Zo(this.Sb,g,h,n);this.Sb.ac.focus()},this),j)();break;case "delete":var l=d.getAttribute("data-token");Hi("删除私信会话","你确定要删除与 "+h+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",function(){var b=Le(c);b.r?U(b.msg):window.location.reload()});
c.ajax("/inbox/delete","type=thread&token="+l)}},this);break;case "edit":b=this.Cg,Q(this.Uc,j),Q(b,n),this.Ii=-1}}};a.Vu=function(){M.call(this);this.Re="zm-pm-item"};y(Vu,Dn);
Vu.prototype.B=function(){this.Ps=I("zh-pm-detail-item-wrap");this.h().e(this.Ps,"click",this.na);var b=I("zh-pm-editor-form");if(b){this.Sb=new Vo({At:j});this.Sb.bq=n;this.Sb.rh(b);this.Sb.show();if(b=this.Pb()[0]){var b=$(b).data(),c=this.Sb,d=b.type;c.Rp=b.token;c.bB=d;Zo(this.Sb,b.member,b.name)}else b=lh,Zo(this.Sb,b.id,b.Rw);this.Sb.focus()}else this.Sb=new Vo({At:j});this.Pb().length&&(b=new Qu,b.ra("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),
b.o(this.Ps))};Vu.prototype.Pb=function(){return rc(this.Ps)};
Vu.prototype.na=function(b){var c=Qk(this.Ps,b.target);if(c&&(b=c.name,c=Mc(c,this.Re))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Sb.show();var b=this.Sb,e=c.type;b.Rp=d;b.bB=e;Zo(this.Sb,c.member,c.name,n);this.Sb.focus();break;case "delete":Hi("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);P(this.h(),c,"success",function(){var b=Le(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this);break;case "report":Tu("message",d,"被举报私信将会被管理员查阅")}}};a.Wu=function(){};y(Wu,fp);ia(Wu);Wu.prototype.P=s("goog-menuheader");a.Xu=function(b,c,d){op.call(this,b,d||Wu.U(),c);rp(this,1,n);rp(this,2,n);rp(this,4,n);rp(this,32,n);this.da=1};y(Xu,op);mp("goog-menuheader",function(){return new Xu(k)});a.Yu=function(){this.Fv=[]};y(Yu,fp);ia(Yu);a.Zu=function(b,c){var d=b.Fv[c];if(!d){switch(c){case 0:d=b.P()+"-highlight";break;case 1:d=b.P()+"-checkbox";break;case 2:d=b.P()+"-content"}b.Fv[c]=d}return d};t=Yu.prototype;t.xc=function(){return Zc.jK};t.w=function(b){var c=b.L().w("div",this.sf(b).join(" "),$u(this,b.ib(),b.L()));av(this,b,c,!!(b.Ub&8)||!!(b.Ub&16));hp(this,b,c);return c};t.fa=function(b){return b&&b.firstChild};
t.o=function(b,c){var d=tc(c),e=Zu(this,2);d&&E.has(d,e)||c.appendChild($u(this,c.childNodes,b.L()));E.has(c,"goog-option")&&(b.xp(j),this.xp(b,c,j));return Yu.n.o.call(this,b,c)};t.Na=function(b,c){var d=this.fa(b),e=bv(this,b)?d.firstChild:k;Yu.n.Na.call(this,b,c);e&&!bv(this,b)&&d.insertBefore(e,d.firstChild||k)};a.$u=function(b,c,d){b=Zu(b,2);return d.w("div",b,c)};t.Gi=function(b,c,d){c&&(Qc(c,d?Zc.lK:this.xc()),av(this,b,c,d))};t.xp=function(b,c,d){c&&(Qc(c,d?Zc.kK:this.xc()),av(this,b,c,d))};
a.bv=function(b,c){var d=b.fa(c);if(d){var d=d.firstChild,e=Zu(b,1);return!!d&&E.has(d,e)}return n},a.av=function(b,c,d,e){e!=bv(b,d)&&(E.enable(d,"goog-option",e),d=b.fa(d),e?(b=Zu(b,1),d.insertBefore(c.L().w("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.$n=function(b){switch(b){case 2:return Zu(this,0);case 16:case 8:return"goog-option-selected";default:return Yu.n.$n.call(this,b)}};
t.hx=function(b){var c=Zu(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return Yu.n.hx.call(this,b)}};t.P=s("goog-menuitem");a.cv=function(b,c,d,e){op.call(this,b,e||Yu.U(),d);this.Ea(c)};y(cv,op);t=cv.prototype;t.X=function(){var b=this.Vy;return b!=k?b:this.Wg()};t.Ea=ca("Vy");t.Gi=function(b){rp(this,8,b);this.fe()&&!b&&this.Vc(n);var c=this.m();c&&this.N.Gi(this,c,b)};t.xp=function(b){rp(this,16,b);var c=this.m();c&&this.N.xp(this,c,b)};
t.Wg=function(){var b=this.ib();return ma(b)?(b=z.map(b,function(b){var d=E.get(b);return z.contains(d,"goog-menuitem-accel")||z.contains(d,"goog-menuitem-mnemonic-separator")?"":Jc(b)}).join(""),Ka(b)):cv.n.Wg.call(this)};t.hg=function(b){var c=this.getParent();if(c){var d=c.tH;c.tH=k;if(c=d&&pa(b.clientX))c=new Pb(b.clientX,b.clientY),c=d==c?j:!d||!c?n:d.x==c.x&&d.y==c.y;if(c)return}cv.n.hg.call(this,b)};t.uf=function(b){return b.keyCode==this.Ty&&this.ke(b)?j:cv.n.uf.call(this,b)};t.VN=q("Ty");
mp("goog-menuitem",function(){return new cv(k)});a.dv=function(){};y(dv,Mp);ia(dv);t=dv.prototype;t.xc=function(){return Zc.iK};t.Kc=function(b){return"UL"==b.tagName||dv.n.Kc.call(this,b)};t.ao=function(b){return"HR"==b.tagName?new Lp:dv.n.ao.call(this,b)};t.Tf=function(b,c){return vc(b.m(),c)};t.P=s("goog-menu");t.Pe=function(b){dv.n.Pe.call(this,b);Rc(b.m(),Yc.Rk,"true")};a.ev=function(b){Lp.call(this,Kp.U(),b)};y(ev,Lp);mp("goog-menuseparator",function(){return new Lp});a.fv=function(b,c){Ut.call(this,Pp,c||dv.U(),b);this.Ze(n)};y(fv,Ut);t=fv.prototype;t.gn=j;t.vL=n;t.P=function(){return this.N.P()};t.Tf=function(b){if(this.N.Tf(this,b))return j;for(var c=0,d=Uh(this);c<d;c++){var e=Vh(this,c);if("function"==typeof e.Tf&&e.Tf(b))return j}return n};t.Ha=function(b){this.J(b,j)};t.Si=function(b,c){this.Uk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.H()};t.ii=function(b){return Vh(this,b)};t.Hl=function(){return Uh(this)};
t.Pb=function(){var b=[];Th(this,function(c){b.push(c)});return b};t.ed=function(b,c){var d=this.V();d||Q(this.m(),j);og(this.m(),b,c);d||Q(this.m(),n)};t.F=function(b,c,d){(c=fv.n.F.call(this,b,c))&&(b&&this.Da&&this.gn)&&this.lc().focus();this.tH=b&&d&&pa(d.clientX)?new Pb(d.clientX,d.clientY):k;return c};t.vx=function(b){this.gn&&this.lc().focus();return fv.n.vx.call(this,b)};t.RC=function(b){return(this.vL||b.isEnabled())&&b.V()&&!!(b.Ub&2)};
t.$=function(b){var c=this.N,d;d=this.L();d=Wb(d.Ja,"div",c.P()+"-content",b);for(var e=d.length,g=0;g<e;g++)Np(c,this,d[g]);fv.n.$.call(this,b)};t.uf=function(b){var c=fv.n.uf.call(this,b);c||Th(this,function(d){!c&&(d.VN&&d.Ty==b.keyCode)&&(this.isEnabled()&&this.wd(d),c=d.$b(b))},this);return c};t.Tb=function(b){fv.n.Tb.call(this,b);(b=Vh(this,b))&&kg(b.m(),this.m())};a.gv=function(b,c,d){T.call(this);this.offset=this.Hi=0;this.DU=d;this.pN=b;this.url=c||window.location.href;this.fh="zm-item";this.sd={}};y(gv,T);t=gv.prototype;t.vB=!ub;t.uB=!ub;t.sh=ca("fh");t.B=function(){this.cc=I("zh-load-more");this.o(this.pN)};
t.C=function(){gv.n.C.call(this);this.kn=1;hv(this);this.Pk=$(this.cc);this.cc&&iv(this)&&(this.h().e(this.cc,"click",function(){this.zo=j;this.Ih&&"pending"===this.Ih.state()&&1===this.kn?(this.Ih.done(v(this.Af,this)),this.wA=j,jv(this,j)):this.nz()}),this.vB&&(this.cB=new Wn(this.kz,100,this),this.h().e(window,"scroll",function(){this.cB.fire()})));kv(this,this.Pb())};a.jv=function(b,c){c?b.Pk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.Pk.html("更多").prop("disabled",n)};
t.kz=function(){var b=this.cc;if(b&&ug(b)&&1E3>=b.getBoundingClientRect().top-ac().height&&!(this.qt||this.Ih&&"pending"===this.Ih.state()))this.uB&&(3===this.kn?(this.kn=1,this.wA=n):(this.zo=n,this.kn++,this.wA=j)),lv(this)};t.nz=function(){this.vB&&this.qt?(this.Af(this.qt),this.qt=k):(jv(this,j),lv(this))};
a.iv=function(b){var c=b.Pb();b.offset=b.et?b.et(c):c.length;if(b.as)return c=b.as(),Q(b.cc,c),c;if(b.cc){if("-1"===b.Pk.attr("data-next")||!c||10>c.length)return b.Pk.hide(),n;b.Pk.removeClass("hidden").show()}return j},a.lv=function(b,c,d){d=d||ha;if(!(b.Ih&&"pending"===b.Ih.state())){var e=b.JH($.extend(b.sd,{offset:b.offset,start:b.Hi}));b.Ih=$.post(b.url,e).done(d).done($.proxy(function(b){this.vB&&!c?this.wA?this.Af(b):(this.qt=b,jv(this,n)):this.Af(b)},b));1!==b.kn&&jv(b,j);return b.Ih}};
t.JH=aa();t.Af=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.cc.setAttribute("data-next",g));0<d&&(this.kv(e),this.offset=this.et?this.et(this.Pb()):this.offset+d);c=j;c=this.as?this.as(b):!(-1===g||10>d);Q(this.cc,c);jv(this,n);mv(this)}};a.mv=function(b){b.dispatchEvent({data:{zo:b.zo,uB:b.uB},type:"afterload"})};t.Pb=function(){return Yb(this.fh,this.g)};t.CH=function(b){return b.id.split("-")[1]};
a.hv=function(b){var c=b.Pb(),d;if(b.DU)if(b.cc&&(d=b.cc.getAttribute("data-next")),d)b.Hi=d;else if(c=z.Ve(c))b.Hi=b.CH(c)};t.kv=function(b){var b=ma(b)?b.join(""):b,b=ic(b+" "),c=Yb(this.fh,b);kv(this,c);this.g.appendChild(b);hv(this)};a.kv=function(b,c){z.forEach(c,function(b){var c=this.ak(b);this.dispatchEvent({data:{item:b,IQ:c},type:"itemcreated"})},b)};t.ak=ha;a.nv=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.ov=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})};a.pv=function(b,c,d){T.call(this);this.wc=b;this.entryType=c||"answer";this.Ed=k;this.G=$.extend({},this.R,d||{})};y(pv,T);a.qv={we:1,Hg:-1,SB:0};pv.prototype.R={PV:"up",kN:"down",JM:"count",rt:"pressed"};F.extend(pv.prototype,qv);t=pv.prototype;t.da=qv.SB;
t.o=function(b){pv.n.o.call(this,b);var c=this.G,b=this.M=$(b);this.Iu=$("."+c.PV,b);this.Du=$("."+c.kN,b);this.BB=$("."+c.JM,b);c=this.Du.hasClass(this.G.rt);this.Iu.hasClass(this.G.rt)?this.da=qv.we:c&&(this.da=qv.Hg);rv(this);this.Iu.click($.proxy(this.hB,this));this.Du.click($.proxy(this.gB,this));return this};t.de=q("da");
t.dc=rn(function(b){if(b!==this.da&&F.Ng(qv,b)){this.dispatchEvent({type:"action",data:{state:b}});this.Ed&&"pending"===this.Ed.state()&&this.Ed.abort();var c=this.da,d=+this.BB.text(),e=0;b===qv.we?e=1:c===qv.we&&(e=-1);this.BB.text(d+e);this.da=b;rv(this);b={};b[qv.we]="vote_up";b[qv.Hg]="vote_down";b[qv.SB]="vote_neutral";this.Ed=("post"===this.entryType?nv:ru)(this.wc,b[this.da]);this.Ed.done(v(function(b){b.r||this.Te()},this))}},function(b){var c={};c[qv.we]="question_answer_vote_up";c[qv.Hg]=
"question_answer_vote_down";return{Ia:c[b],Kh:j}});t.IV=function(b){b===qv.we?Uk("vote","voteup","side_vote"):b===qv.Hg&&Uk("vote","votedown","side_vote")};t.hB=function(){this.dc(this.da===qv.Hg?qv.we:this.da^qv.we)};t.gB=function(){this.dc(this.da===qv.we?qv.Hg:this.da^qv.Hg)};
a.rv=function(b){var c=b.da,d=b.G,e=c===qv.we,c=c===qv.Hg,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.Iu.toggleClass(d.rt,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.Du.toggleClass(d.rt,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Te=function(){this.dispatchEvent("change")};a.sv=function(b){M.call(this);this.g=b;b=A||D&&!Gb("531")&&"TEXTAREA"==b.tagName;this.S=new qe(this);this.S.e(this.g,b?["keydown","paste","cut","drop","input"]:"input",this)};y(sv,Kd);sv.prototype.sa=k;
sv.prototype.handleEvent=function(b){if("input"==b.type)tv(this),(!tb||this.g==Ub(this.g).activeElement)&&this.dispatchEvent(uv(b));else if("keydown"!=b.type||wu(b)){var c="keydown"==b.type?this.g.value:k;A&&229==b.keyCode&&(c=k);var d=uv(b);tv(this);this.sa=Od(function(){this.sa=k;this.g.value!=c&&this.dispatchEvent(d)},0,this)}};a.tv=function(b){b.sa!=k&&(Ld.clearTimeout(b.sa),b.sa=k)},a.uv=function(b){b=new od(b.Zb);b.type="input";return b};
sv.prototype.z=function(){sv.n.z.call(this);this.S.H();tv(this);delete this.g};a.wv=function(b,c,d,e){M.call(this);this.Xd=b;this.$h=c;this.mh=d;this.RD=e||vv;this.Kj=new sv(b);N(this.Kj,"input",this.Wo,n,this);this.Zi()};y(wv,Kd);a.vv=0;t=wv.prototype;t.Wo=function(){this.Zi()};t.Zi=function(){var b=this.Pr();this.$h&&(0>this.mh-b?(Ac(this.$h,"已超出 "+(b-this.mh)+" 字"),E.add(this.$h,"zg-text-error")):(Ac(this.$h,"还可以输入 "+(this.mh-b)+" 字"),E.remove(this.$h,"zg-text-error")))};t.z=function(){wv.n.z.call(this);delete this.Xd;this.Kj.H();this.Kj=k};
t.isValid=function(){return 0<=this.mh-this.Xd.value.length};t.Pr=function(){return this.Xd.value.length};a.xv=function(b,c,d,e){wv.call(this,b,c,d,e)};y(xv,wv);xv.prototype.Pr=function(){return Sk(this.Xd.value)};a.zv=function(b,c){M.call(this);this.ca=k;this.wU.apply(this,b);this.B();this.show();yv(this,c)};y(zv,Dn);t=zv.prototype;t.Og={};t.B=function(){this.h().e(Pi,"question_title_change",function(){this.Og[this.Gh]=k});this.w();this.Sa()};t.show=function(){Av(this);this.Dc&&(this.Dc.checked=n,this.og());this.Cc&&(this.Cc.checked=n,this.og());Jp.U().refresh();this.ca.F(j)};t.hide=function(){this.ca.F(n)};t.wU=function(b,c,d,e){this.vh={title:b,type:c,CV:d,sd:e};this.Gh=c.type+":"+d};
a.Av=function(b){b.ca.lb(b.vh.title);b.Og[b.Gh]||(b.xhr=new V(j),P(b.h(),b.xhr,"success",b.xU),b.xhr.ajax("/"+b.vh.type+"/"+b.vh.CV+"/sharetext","","GET"));I("zh-webshare-sina-pm").value=b.Og[b.Gh]&&b.Og[b.Gh].sina||"加载中...";b.NI.Zi();Mo(b.HA);b.HA.ru();var c=b.Kk;c.ac.value=b.Og[b.Gh]&&b.Og[b.Gh].pm||"加载中...";c.gM&&c.gM.Zi();Mo(c.FH);c.FH.ru();Q(c.Uc,j);Q(c.Cg,n)};t.xU=function(){var b=Le(this.xhr);b&&b.r?U(b.msg):(this.Og[this.Gh]=b,Av(this))};
t.w=function(){var b=$($("#zh-webshare-dialog-tmpl").html())[0];b?(this.g=b,this.ca=new Di(k,n),mi(this.ca,k),this.ca.Nn=j,this.ca.fa().appendChild(this.g),this.Kk=new Vo({EH:"share"}),this.Kk.rb=this.ca,this.Kk.rh(I("tb-webshare-letter-content")),this.Kk.dl=n,this.Kk.B()):Tk("module WebshareDialog does not exist!")};t.pA=function(){this.Dc.checked=j;this.og()};t.oA=function(){this.Cc.checked=j;this.og()};
a.yv=function(b,c){var d=I(c+"-content"),e=I(c);z.forEach(b.jV,function(b){E.remove(b.parentNode,"active")});z.forEach(b.iV,function(b){Q(b,n)});E.add(e.parentNode,"active");Q(d,j);b.VT||(b.ca.pa(),b.VT=j)};
t.Sa=function(){var b=J("tab-navs",this.g);this.h().e(b,"click",this.BS);this.jV=$(".tab-nav > a",this.g);this.iV=Yb("zm-tab-content",this.g);this.cD=Yb("zm-command",this.g);this.h().e(this.cD[0],"click",this.na);this.h().e(this.cD[1],"click",this.na);this.Ez=I("zh-webshare-sina-pm");this.HA=new Oo(this.Ez);this.NI=new xv(this.Ez,I("zg-webshare-sina-counter"),140,vv);this.h().e(Y,"sina_callback",function(b){this.pA(b.qb.id,b.qb.name)}).e(Y,"qq_callback",function(b){this.oA(b.qb.id,b.qb.name)});this.mv();
b=J("zg-btn-blue",this.Kk.m());R.Jg||E.WI(b,"zg-btn-blue","zg-btn-disabled");this.h().e(b,"click",this.na)};t.mv=function(){this.Dc=J("sina-checkbox",this.g);this.h().e(this.Dc,"change",this.fp);this.Cc=J("qq-checkbox",this.g);this.h().e(this.Cc,"change",this.fp)};t.og=function(){var b=J("weibo-share-button",this.g),c=this.Dc.checked||this.Cc.checked;E.enable(b,"zg-btn-blue",c);E.enable(b,"zg-btn-disabled",!c)};
t.fp=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.Dc&&!vh.id||b===this.Cc&&!wh.id?(window.open(c),b.checked=n):this.og()};t.BS=function(b){(b=this.qf(b.target))&&yv(this,b.id)};
t.na=function(b){var c=this.qf(b.target);if(c)switch(c.name){case "send_sina":if(!E.has(c,"zg-btn-disabled")){var d=this.Ez.value;d&&this.Gh in this.Og&&(c=new Rk(j),c.add("content",d),d=[],this.Dc.checked&&d.push("sina"),this.Cc.checked&&d.push("qq"),c.add("via",d.join(",")),this.um(c),this.vh&&Y.Y({type:"ga_click_share_"+this.vh.type+"_weibo",data:{DJ:d}}))}break;case "send":if(!E.has(c,"zg-btn-disabled"))if(c=this.Kk,"-1"===String(c.Ii))Xo(c,"请填写收信人。");else if(d=c.ac.value,this.Gh in this.Og)if(La(d)){var e=
new Rk(j);e.add("talker_id",c.Ii);e.add("content",d);e.add("via","pm");this.um(e);this.vh&&Y.Y("ga_click_share_"+this.vh.type+"_message")}else Xo(c,"请填写私信内容。");break;case "cancel":this.hide()}b.stopPropagation();b.preventDefault()};t.um=function(b){F.forEach(this.vh.sd,function(c,d){b.add(d,c)});this.xhr=new V(j);P(this.h(),this.xhr,"complete",this.bv);this.xhr.ajax("/"+this.vh.type+"/share",b.Pc())};t.bv=function(){var b=Le(this.xhr);b&&b.r?U(b.msg):(this.ca.F(n),U("分享发送完毕"))};t.V=function(){return this.ca.V()};a.Bv=void 0,a.Cv=[],a.Dv=[].slice,a.Ev=cl(550,function(){if(Cv.length){var b=Cv;R.Ia()&&(b={items:JSON.stringify(b)},$.post("/lastread/touch",b));Cv=[]}});Bv=function(){Cv.push(Dv.call(arguments));Ev()};a.Fv=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.Gv=function(b){var c=[],b=b||document.styleSheets,d=la(i)?i:n;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)z.extend(c,Gv(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)z.extend(c,Gv(b[e]))}else{var h=Fv(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&z.extend(c,Gv(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.Hv=/a(:(link|visited|active|hover))?/,a.Iv=function(){this.Ln="";this.qh=[]};Iv.prototype.clone=function(){var b=new Iv;b.qh=this.qh.concat();b.Ln=this.Ln;return b};
a.Jv=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.Ln=e.join("")},a.Kv=/(^|;|{)\s*color:([^;]+);/g,a.Mv=function(b){this.Cz=[];this.gv={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new Lv(b[d]);c.push(e)}this.yi=c}},a.Lv=function(b){var c=Nv[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.JF=b;this.aR=d;this.ZI={};Nv[b]=this},a.Nv={},a.Ov=function(b,c){var d=c.uid,e=b.ZI[d];if("undefined"!=typeof e)return e;var g=b.aR,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=n:g&&g!=c.id?l=n:h&&!c.mM[h]&&(l=n);return b.ZI[d]=l},a.Qv=function(b){var c=ua(b),d=Pv[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=E.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.mM=g;d.unshift(e)}while(b=b.parentNode);
this.UG=d;this.uid=ua(this);Pv[c]=this},a.Pv={},a.Rv={},a.Sv="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Tv="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Uv=function(){M.call(this);this.jc=this.yq()};y(Uv,Kd);t=Uv.prototype;t.D=k;t.LL=j;t.Qb=pe("goog.editor.Plugin");t.rJ=function(){this.D&&(this.disable(this.D),this.D=k)};t.enable=function(b){this.D==b?this.jc=j:this.Qb.log(fe,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.D==b?this.jc=n:this.Qb.log(fe,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.D==b?this.jc:n};t.yq=pf;t.DQ=pf;
t.z=function(){this.D&&this.rJ(this.D);Uv.n.z.call(this)};a.Vv=F.Um({Bx:1,LO:2,Wr:3,Aj:4,Xr:5,execCommand:6,queryCommandValue:7,IH:8,oM:10,nM:11}),a.Wv=F.Wh(8,10,11);Uv.prototype.execCommand=function(b,c){var d=this.DQ(b);d||(C&&Xv(this.D,j,j),this.D.Yh());try{var e=this.of.apply(this,arguments)}finally{d||(this.D.He(),Yv(this.D))}return e};Uv.prototype.Qe=s(n);a.Zv=function(b,c,d,e,g){this.iE=b;this.KA=c;this.Pq=d;this.nE=e;this.Dw=g||{}},a.$v=function(b,c){this.jW=b;this.qD=c},a.aw=function(b,c,d,e){var g=[];b.Pq&&b.KA&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.Pq&&g.push("height:",b.nE?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.qD&&g.push(d.qD);C&&b.KA&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Nt&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.iE,'" style="min-width:0;');C&&b.Pq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.KA?"100%":"auto"),b.nE?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));tb&&g.push(";outline:hidden");for(var h in b.Dw)g.push(";"+h+":"+b.Dw[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.hw=function(b,c){M.call(this);this.$g=this.id=b;this.hb=k;this.td={};this.Gj={};for(var d in Vv)this.Gj[d]=[];this.gl="";this.zk={};this.zk[bw]=1;this.zk[cw]=1;this.gy=this.Cs=n;this.pr=new Gj(this.PD,dw,this);this.nr={};for(var e in ew)this.nr[ew[e]]=0;C&&(this.Ae=new Gj(this.ho,fw,this));this.kc=new qe(this);this.kW=[];this.Vj=gw;this.nm=Vb(c||document);this.Rc=this.nm.m(this.id);this.Xk=this.nm.Ta()};y(hw,Kd);hw.prototype.field=k;hw.prototype.Rc=k;hw.prototype.Qb=pe("goog.editor.Field");
a.bw="change",a.cw="delayedchange",a.ew={IW:"cvc",yX:"load",IY:"unload",yW:"beforechange",GW:bw,NW:cw,zW:"beforefocus",WW:"focus",BW:"blur",AW:"beforetab",lX:"ifrsz",lY:"selectionchange"},a.gw=0,a.iw=k;t=hw.prototype;t.ah=n;t.yJ=n;t.vu=n;t.m=q("field");t.addListener=function(b,c,d,e){var g=this.m();gr&&(g&&this.sc())&&(g=g.ownerDocument);this.kc.e(g,b,c,d,e)};t.tj=function(b){return this.td[b]};a.fw=15,a.dw=250;hw.prototype.sc=qf;hw.prototype.Ao=qf;hw.prototype.FI=pf;a.jw={46:j,8:j};A||(jw[9]=j);
a.kw={86:j,88:j};A&&(jw[229]=j);a.lw=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in jw;return(b.ctrlKey||b.metaKey)&&b.keyCode in kw||c},a.mw=function(b,c){b.Vj=2;b.field=c;b.hb=Vb(c);b.Cs=n;b.gy=n;c.setAttribute("g_editable","true")};
hw.prototype.Iv=function(){this.kc&&this.kc.Sc();if((Pg||Qg)&&this.sc()&&this.FI()){try{var b=this.hb.Ta();b.removeEventListener("keydown",this.sn,n);b.removeEventListener("touchend",this.sn,n)}catch(c){}delete this.sn}if(tb&&this.sc()){try{b=this.hb.Ta(),b.removeEventListener("focus",this.tv,n),b.removeEventListener("blur",this.sv,n)}catch(d){}delete this.tv;delete this.sv}this.Ae&&this.Ae.stop();this.pr.stop()};
hw.prototype.z=function(){(1==this.Vj||this.Ld())&&this.Qb.Ik("Disposing a field that is in use.");this.Rc&&this.execCommand("clearlorem");this.Vj=gw;for(var b in this.td){var c=this.td[b];c.yq()||c.disable(this)}this.hb=this.field=k;this.Iv();this.xl&&(Dd(this.xl),this.xl=k);this.nm=k;this.kc&&(this.kc.H(),this.kc=k);for(;b=this.kW.pop();)b.H();iw==this.id&&(iw=k);for(var d in this.td)b=this.td[d],b.LL&&b.H();delete this.td;hw.n.z.call(this)};
a.nw=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];hw.prototype.sA=function(){if(dr||!this.sc())this.kc.e(this.m(),"DOMSubtreeModified",this.Cx);else{var b=this.hb.za();this.kc.e(b,nw,this.Cx,j);this.kc.e(b,"DOMAttrModified",v(this.LE,this,this.Cx),j)}};
a.ow=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||C&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),n;var d;if(!(d=c.charCode))d=lw(c)?j:!(!C||c.ctrlKey||c.metaKey||C&&!c.charCode);b.lx=d;b.lx&&b.Yh();return j},a.pw={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.qw={65:j,86:j,88:j},a.rw={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=hw.prototype;
t.yo=function(b,c){for(var d=this.Gj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||Wv[b])&&h[Vv[b]].apply(h,e))return j}return n};t.qQ=function(b,c){for(var d=this.Gj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||Wv[b])&&h[Vv[b]].apply(h,e)}};t.xt=function(b,c,d){for(var e=this.Gj[b],g=z.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||Wv[b])g[0]=l[Vv[b]].apply(l,g)}return g[0]};
a.sw=function(b,c,d){var e={},b=b.xt(8,c||"",e);Wf(d,e);d.innerHTML=b};t.tf=function(b){(C||ow(this,b))&&!this.yo(1,b)&&nr&&tw(this,b)};t.MO=function(b){if(C){if(!ow(this,b))return}else this.lx=j,this.Yh();!this.yo(2,b)&&!nr&&tw(this,b)};t.NO=function(b){!C&&(this.lx||lw(b))&&this.ho();this.yo(3,b);uw(this,"selectionchange")||(pw[b.keyCode]||(b.ctrlKey||b.metaKey)&&qw[b.keyCode])&&this.wI.start()};
a.tw=function(b,c){if(!c.altKey){var d=mb?c.metaKey:c.ctrlKey;if(d||rw[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.yo(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.Gj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.Qe(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Ld()&&this.xf;if(oa(b))return this.ut(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.ut(b[e],c);return d};t.ut=function(b,c){for(var d=this.Gj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.Qe(b)&&(c||g.yq()))return g.queryCommandValue(b)}return c?k:n};t.LE=function(b,c){if(!uw(this,bw)){var d=c.Zb;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Cx=function(b){uw(this,bw)||(b=b.xE?b.Zb:b,b.target.firebugIgnore||(this.gy=this.Cs=j,this.Ae.start()))};t.Ur=function(){A&&this.execCommand("clearlorem",j);C&&this.gw();this.He()};a.vw=function(b){var c;return b.sc()&&(c=b.hb)?(b=c.Ta())&&b.frameElement:k},a.ww=function(b){return(b=b.hb&&b.hb.Ta())&&Xq(b)},a.Yv=function(b,c,d){if(!uw(b,"selectionchange")){var e=ww(b),e=e&&e.Gb();b.xf=!!e&&vc(b.m(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",x_:c&&c.type});b.yo(4,c,d)}};
t.hP=function(){var b=this.vI;this.vI=k;Yv(this,i,b)};t.Yh=function(){uw(this,"beforechange")||this.dispatchEvent("beforechange")};a.Xv=function(b,c,d){c&&(b.Ae&&gt(b.Ae),b.zk[bw]=1);d&&(xw(b),b.zk[cw]=1)},a.yw=function(b,c,d){!c&&b.Ae&&gt(b.Ae);b.zk[bw]=0;b.zk[cw]=0;c&&b.ho();d&&b.PD()},a.uw=function(b,c){return!!b.zk[c]||b.nr[c]&&500>=za()-b.nr[c]};t.He=function(b){yw(this,j,b)};t.ho=function(){uw(this,bw)||(this.Ae&&this.Ae.stop(),this.gy=this.Cs=j,uw(this,cw)||this.pr.start())};
t.PD=function(){uw(this,cw)||(this.pr.stop(),this.Cs=n,this.dispatchEvent(cw))};a.xw=function(b){b.Ae&&gt(b.Ae);gt(b.pr)};t.gw=function(){this.OD();this.QD()};t.OD=function(){uw(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.QD=function(){if(!uw(this,"focus")){iw=this.id;this.xf=j;this.dispatchEvent("focus");if(C){var b=this.m(),c=ww(this);if(c){var d=jq(c);0==kq(c)&&(!d||d==b||"BODY"==d.tagName)&&Lt(b)}}!er&&this.sc()&&this.hb.Ta().parent.getSelection().removeAllRanges()}};
t.tr=function(){uw(this,"blur")||(iw==this.id&&(iw=k),this.xf=n,this.dispatchEvent("blur"))};a.zw=function(b){Lc(b.target,"A")&&b.preventDefault()};t.xj=function(b){iw=this.id;if(A){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.nm.Ta().open(c.href)}this.vu=j};t.ux=function(){this.vu=n};t.UE=function(b){if(!this.yJ||this.vu)this.vu=n,Yv(this,b),A&&(this.vI=b.target,this.wI.start())};t.UO=function(b){Yv(this,b)};
t.Dl=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Ld()){var b=this.Rc;b||this.Qb.log(ee,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.m(),b=c.cloneNode(n),c=c.innerHTML;A&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.qQ(11,b);return this.xt(10,b.innerHTML)};
t.ne=function(b,c,d,e){if(1==this.Vj)this.Qb.log(fe,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&Xv(this,n,j);b=c;if(c=this.m()){if(this.sc()&&D)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Rc;c&&sw(this,b,c);e&&this.execCommand("updatelorem");this.Ld()&&(d?(C&&gt(this.Ae),yw(this)):this.He())}};
t.mB=function(){var b=this.hb.za();b.designMode="on";jr&&b.execCommand("styleWithCSS",n,n)};t.LF=function(){this.gl&&Aw(this)&&zu(this.gl,this.m())};t.Ld=function(){return 2==this.Vj};t.focus=function(){if(!Nt&&this.sc())this.hb.Ta().focus();else{if(tb)var b=this.Xk.pageXOffset,c=this.Xk.pageYOffset;this.m().focus();tb&&this.Xk.scrollTo(b,c)}};t.dg=function(){(br||D)&&Bw(this);this.focus()};a.Bw=function(b){var c=b.m();if(c){var d=At(c);c==d?Zq(c,0).select():ct(d,j);Yv(b)}};
t.ie=function(b){this.Vj=1;var c=this.Rc;this.nodeName=c.nodeName;this.N_=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.Gy(b)};t.Gy=function(b){var c=this.Rc;if(c){var c=c.innerHTML,d={},c=this.xt(8,c,d),e=this.nm.w("IFRAME",this.EE());if(Aw(this)){var g=v(this.vF,this,e,c,d);this.xl=N(e,"load",g,j);b&&(e.src=b)}this.AC(e);Aw(this)||this.vF(e,c,d)}};
t.Vr=function(){A&&Ot(this.hb.Ta());iw!=this.id&&this.execCommand("updatelorem");if((Pg||Qg)&&this.sc()&&this.FI()){var b=this.hb.Ta();this.sn=v(b.focus,b);b.addEventListener("keydown",this.sn,n);b.addEventListener("touchend",this.sn,n)}tb&&this.sc()?(this.tv=v(this.gw,this),this.sv=v(this.tr,this),b=this.hb.Ta(),b.addEventListener("focus",this.tv,n),b.addEventListener("blur",this.sv,n)):(mr?(this.addListener("focus",this.QD),this.addListener(md,this.OD)):this.addListener("focus",this.gw),this.addListener("blur",
this.tr,C));if(C)this.sA();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.Yh);var c=this.He,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.Ur)}this.addListener(D?"dragend":"dragdrop",this.Ur);this.addListener("keydown",this.tf);this.addListener("keypress",this.MO);this.addListener("keyup",this.NO);this.wI=new Gj(this.hP,250,this);kr&&this.addListener("click",zw);this.addListener("mousedown",
this.xj);this.yJ?(this.kc.e(this.hb.za(),"mouseup",this.UE),this.addListener("dragstart",this.ux)):this.addListener("mouseup",this.UE);this.addListener("mouseover",this.UO);this.LF();yw(this);this.Qb.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.td)this.td[e].enable(this)};a.Aw=function(b){if(!la(b.jy)&&(b.jy=n,A&&b.sc())){for(var c=b.nm.Ta();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.jy="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.jy};
t.AC=function(b){var c=this.Rc;b.className=c.className;b.id=c.id;pc(b,c)};t.Xw=function(b){var c=Oc(Vb(this.Rc));return new Zv(this.id,c,n,n,b)};t.MJ=function(b,c,d){d=this.Xw(d);Aw(this)?(b=(b.contentDocument||b.contentWindow.document).body,Nt&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.iE,Wf(b,d.Dw),b.innerHTML=c):aw(d,c,new $v(this.m(),this.gl),b)};
t.vF=function(b,c,d){this.xl&&(Dd(this.xl),this.xl=k);b.OY="true";this.MJ(b,c,d);mw(this,(b.contentDocument||b.contentWindow.document).body);!Nt&&this.sc()&&this.mB();this.Vr()};t.EE=function(){var b="padding:0;"+this.Rc.style.cssText;Fa(b,";")||(b+=";");b+="background-color:white;";A&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.Cw=function(b,c){hw.call(this,b,c)},a.Dw=void 0;y(Cw,hw);t=Cw.prototype;t.Qb=pe("goog.editor.SeamlessField");t.RF=n;t.vQ=n;t.Ao=q("RF");t.YE=function(){uw(this,bw)||Ew(this)};
t.IA=function(){if(this.Kp?0:this.Kp=j){var b=n,c=vw(this);if(c){var d,e=vw(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(Au(e,"height"),10)&&Wf(e,"height","1px");if(Oc(Vb(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=Dw))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),pg(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,L(e),e=Dw=g;e=d+e}d=e;this.hR&&(d=Math.max(d,this.hR));parseInt(Au(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.Kp=n;b&&this.dispatchEvent("ifrsz")}};
a.Ew=function(b){if(b.Kp?0:b.Kp=j){var c=vw(b),d=b.m(),e=n;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(Au(c,"width"),10)!=l&&(g=Ag(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.Ao()&&parseInt(Au(c,"height"),10)!=h&&(g||(g=Ag(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.Kp=n;e&&b.dispatchEvent("ifrsz")}},a.Fw=function(b){b.m()&&(Ew(b),b.Ao()||b.IA())};t.Nx="";a.Gw=n;t=Cw.prototype;t.sc=function(){return!Nt};
t.sA=function(){Cw.n.sA.call(this);if(this.sc()){var b=vw(this).ownerDocument;this.kc.e(b,nw,this.YE,j);this.PQ=Ad(this.hb.Ta(),"load",this.IA,j,this);this.kc.e(b,"DOMAttrModified",v(this.LE,this,this.YE),j)}};t.ho=function(){uw(this,bw)||(Cw.n.ho.call(this),this.sc()&&this.IA())};
t.tr=function(){if(!uw(this,"blur")&&(Cw.n.tr.call(this),!Nt&&!er)){var b=this.hb.Ta(),c=n;Dd(this.jG);this.jG=Ad(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.hb){var b=ww(this),e=this.hb.Ta();Ot(e);b&&(b.collapse(j),b.select())}},this),0)}};t.mB=function(){Cw.n.mB.call(this);var b=this.hb.za();b.execCommand("enableInlineTableEditing",n,"false");b.execCommand("enableObjectResizing",n,"false")};
t.LF=function(){!this.sc()&&!Gw&&(this.gl&&zu(this.gl,this.m()),Gw=j)};t.Gy=function(b){if(this.sc())Cw.n.Gy.call(this,b);else if(b=this.Rc)mw(this,b),b.contentEditable=j,sw(this,b.innerHTML,b),this.Vr()};t.Vr=function(){if(this.sc()){var b=this;fa.setTimeout(function(){Fw(b)},0)}Cw.n.Vr.call(this)};t.EE=function(){return{frameBorder:0,style:"padding:0;"}};
t.AC=function(b){if(!this.vQ){var c=this.Rc;c&&(this.RF="auto"==$f(c,"overflowY"))}var c=this.Rc,d=Vb(c),e=c.style.width,g=c.style.height;Wf(c,"visibility","hidden");var d=d.w("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=yu(c),d=h.width,h=h.height,l="";this.Ao()&&(l="&nbsp;",Wf(c,"position","relative"),Wf(c,"overflow","visible"),Wf(b,"position","absolute"),Wf(b,"top","0"),Wf(b,"left","0"));pg(c,d,h);Oc(Vb(c))&&(this.w_=
c.style.lineHeight,Wf(c,"lineHeight","0"));c.innerHTML=l;pg(b,d,h);pg(c,e,g);Wf(c,"visibility","");c.appendChild(b);Aw(this)||(c=b.contentWindow.document,Oc(Vb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.Xw=function(b){var c=this.Rc;if(c)return new Zv(this.id,Oc(Vb(c)),j,this.Ao(),b);f(Error("no field"))};
t.MJ=function(b,c,d){Wf(b,"visibility","hidden");var d=this.Xw(d),e=this.Rc,g=this.gl;if(!this.Nx){var h=this.Rc;if(h){var l=h.ownerDocument,m=ua(l);if(!Rv[m]){for(var p=ua(l),r=[],l=Gv(l.styleSheets),w=0,B;B=l[w];w++)if((B=Fv(B))&&B.length)for(var H=0,G=B.length;H<G;H++){var S=new Iv,X;X=S;var ja=B[H],Oa=ja.style;if(Oa){var Qa=i,Va=i;Oa&&(Qa=ja.selectorText)&&(Va=Oa.cssText)?A&&(Va+="/* */"):ja.cssText&&(Va=/([^\{]+)\{/,Qa=Va.exec(ja.cssText)[1],Va=ja.cssText.replace(Va,"").replace(/\}[^\}]*$/g,
""));if(Qa){ja=X;ja.qh=[];Qa=Qa.split(/,\s*/gm);for(Oa=0;Oa<Qa.length;Oa++){var oe=Qa[Oa];0<oe.length&&ja.qh.push(new Mv(oe))}X.Ln=Va;X=j}else X=n}else X=n;X&&r.push(S)}Rv[p]=r}p=Rv[m];m=[];for(r=0;r<p.length;r++)m.push(p[r].clone());l=new Qv(h);w=new Lv("body");for(p=0;p<m.length;p++){B=m[p].qh;r=B.length;for(H=0;H<r;H++){G=B[H];S=G;X=l.uid;if(S.gv[X])X=S.gv[X];else{for(var Va=0,Oa=Qa=ja=k,oe=l.UG,gE=oe.length,Yj=0;Yj<=S.yi.length;Yj++){for(Qa=S.yi[Yj];Va<gE;){var Rx=oe[Va];if(Qa&&Ov(Qa,Rx)){ja=
{ZD:Va,xI:Yj};Va++;break}else Oa&&Ov(Oa,Rx)&&(ja={ZD:Va,xI:Yj-1});Va++}Oa=Qa}X=S.gv[X]=ja}X&&(S=X.xI,G=G.yi,Va=G.length-1,X.ZD==l.UG.length-1||S<Va?(G=G.concat(),G.splice(0,S+1,w),S=new Mv,S.yi=G,B.push(S)):0<S&&S==Va&&(S=new Mv,S.yi=[w,G[Va]],B.push(S)))}}l=new Iv;h=h.currentStyle||Ub(h).defaultView.getComputedStyle(h,"")||{};p=new Mv;p.yi=[new Lv("html")];l.qh=[p];w={};for(p=0;r=Sv[p];p++)w[r]=h[gb(r)];Jv(l,w);m.push(l);l=new Iv;w=new Mv;w.yi=[new Lv("body")];B={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(p=0;r=Tv[p];p++)B[r]=h[gb(r)];Jv(l,B,j);l.qh=[w];m.push(l);h=[];r=m.length;for(p=0;p<r;p++){B=m[p];l=h;H=B.qh.length;w=n;for(G=0;G<H;G++){S=B.qh[G].yi;X=S.length;for(Va=0;Va<X;Va++)l.push(S[Va].JF," ");G<H-1&&l.push(",");C&&!Gb("1.9a")&&(w=w||Hv.test(S[X-1].JF))}B=B.Ln;w&&(B=B.replace(Kv,"$1 color: $2 ! important; "));l.push("{",B,"}\n")}this.Nx=h.join("")}}e=new $v(e,g+this.Nx);d.Pq&&(g=Ag(e.jW),(g.top||g.left||g.right||g.bottom)&&Wf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));aw(d,c,e,b);Fw(this);Wf(b,"visibility","visible")};t.Iv=function(){Dd(this.jG);Dd(this.PQ);Cw.n.Iv.call(this)};a.Hw={};Hw._default_={ax:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},El:Cu,Fl:Cu,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},zy:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
Hw.answer={El:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},Fl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},KL:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
Hw.question={El:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},Fl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
Hw.favlist={El:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},Fl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
Hw.post={ax:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},El:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},Fl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},zy:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
Hw.roundtable={ax:function(b){return $.get("/node/RoundtableCommentV2",{params:{comment_id:b}})},El:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},Fl:function(b){return $.get("/node/RoundtableCommentListV2",{params:{roundtable_id:b}})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},zy:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},
remove:function(b){return $.post("/node/RoundtableCommentV2",{method:"remove_comment",params:{comment_id:b}})}};a.Jw=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.Gc=new Iw(c)};y(Jw,kd);a.Iw=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};Iw.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.Kw=function(){M.call(this)};y(Kw,Ru);a.Lw=function(b,c,d){$.post(b,c).done(function(b){if(b.r)U(b.msg);else{var c=b.msg;if(c){if(c.refresh){setTimeout(function(){window.location.reload()},2E3);return}if(c.redirect){window.location.href=c.redirect;return}}U("操作成功！");d&&d(b)}})},a.Mw=void 0,a.Nw=Vs($.getJSON);Mw=function(b,c){return Nw(Ga("/manage/%s/options?action=%s",b,c))};t=Kw.prototype;t.MB={remove:"删除",lock:"锁定",unlock:"解除锁定",collapse:"折叠",uncollapse:"解除折叠",mute:"隔离",unmute:"解除隔离"};
t.GE=function(b){return Mw(b,this.Cl())};t.yv=function(){var b=Kw.n.yv.call(this);b.uc.set("ok",this.MB[this.Cl()]);return b};t.Cl=function(){return $(this.wv).data("op").split("-")[0]};t.AE=function(b){return Ga("确定要%s该%s？",this.MB[this.Cl()],this.$B[b]||"条目")};t.zI=function(b){$(".footnote",this.Ww().m()).text(b)};
t.XE=function(b){b&&(b.trackable?(b=$.extend({action:"get_member_info",reason:b.value},this.ww),$.post("/manage",b).then(function(b){return Ga("用户已被警告 %s 次，禁言 %s 次",b.warn_num,b.ban_num)}).then(v(this.zI,this))):this.zI(""))};t.submit=function(){var b=$(this.wv).data(),c=b.action,b=b.content,d=$($("form",this.On.m())[0]).serialize();b&&(d+="&"+b);Lw(c,d,this.cl)};t.z=function(){this.cl=this.wv=k;Kw.n.z.call(this)};
t.open=function(b,c,d,e){this.wv=b;this.MY=d;this.cl=e||ea.r_;Kw.n.open.call(this,c.type,c.id,"")};a.Ow=function(b){T.call(this);F.extend(this.G={},this.R,b||{});this.Sk=new Rd;this.Pf=k};y(Ow,T);t=Ow.prototype;t.R={trigger:{A:"data-editable"},TK:"hc-actionbar",GQ:"checked",HU:100,GP:100};
t.C=function(){Ow.n.C.call(this);this.nn=K("div");document.body.appendChild(this.nn);var b=this.G,c=new wo(b.trigger,n,k,this.g);c.Yt=b.HU;c.ds=b.GP;c.rh(this.nn);N(c,"trigger",function(b){c.ed(new co(b.anchor,1))});N(c,"beforeshow",function(b){this.Pf=b.target.anchor;this.aa()},n,this);c.className=b.TK;this.LP=c};t.Zw=q("LP");
a.Pw=function(b,c){var d=b.G.GQ,e=rc(b.nn),g=z.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||E.has(g,d))return n;z.forEach(e,function(b){E.remove(b,d)});E.add(g,d);return j};t.ZL=function(b,c,d){c=K("div",{title:b.T,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[K("i","icon icon-actionbar-"+b.name)]);wg(c,j);this.h().e(c,"click",function(){Pw(this,b.name)&&b.bl(this.Pf)});return c};
t.aa=function(){this.nn.innerHTML="";kc(this.nn,z.map(F.La(this.Sk.mu()),this.ZL,this))};a.Qw=function(b){T.call(this);F.extend(this.G={},this.R,b||{})};y(Qw,T);Qw.prototype.R={mF:{},HL:j};
Qw.prototype.C=function(){Qw.n.C.call(this);var b=this,c=this.g;if(this.G.HL){var d=new Ow({});d.Sk.set("link",{name:"link",T:"链接",bl:function(b){Ac(b,b.href)}||ha});d.Sk.set("text",{name:"text",T:"文本",bl:function(b){Ac(b,b.getAttribute("data-title"))}||ha});d.o(c);var e=d.Zw();dt(e,new Rf(2,0,0,0));e.Vl=new Rf(2,0,0,0)||k;var g=d.h();g.e(e,"beforeshow",function(b){var b=b.target.anchor,c=Ic(b);c===b.href?Pw(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),Pw(d,"text"))}).e(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&Rw(b))return n});var h;g.e(e,"show",function(b){h=b.target.anchor;E.add(h,"hover")}).e(e,"hide",function(){h&&(E.remove(h,"hover"),h=k)});this.xq=d}this.h().e(c,"paste",function(){setTimeout(function(){var c=b.G,d=b.g,e=Cc(d,function(b){return 3===b.nodeType&&!Sw(b,d,function(b){return Rw(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=Xq(),B=h&&iq(h);z.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Tw,function(b){Ea(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=ic(d),B===b&&(g=c.lastChild),pc(c,b))});g&&ct(g);var H=c.mF,c=z.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=z.contains(Uw,b.protocol))c=Ic(b),Ea(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=z.map(c,function(b){return Vw(b.href).done(function(c){var e=H;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
Xq();if(e){var g=e.Z(),h=e.wa(),l=e.ka(),m=e.Ka();vc(c,g)&&(g=b,h=0);vc(c,l)&&(l=b,m=0);d(function(){g===b&&l===b?ct(b):Jq(g,h,l,m).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){Ac(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){pc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).e(c,"keydown",this.yP)};
Qw.prototype.yP=function(b){var c=yh(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=Xq(),e=c.Z(),g=c.ka(),h=this.g,l,m=Sw(e,h,Rw)||g!==e&&(l||(l=Sw(g,h,Rw)));if(m){var p=Ic(m),r=c.wa(),w=c.Ka();if(m.getAttribute("data-editable")&&p===m.href){var B=n;l=l||Sw(g,h,Rw)||m;var h=m.contains(e),H=l.contains(g);if(d)h&&(e=m,r=0,B=j),H&&(g=l,w=Ys(l),B=j),B&&Jq(e,r,g,w).select();else if(h&&H&&l===m){if(!c.isCollapsed()||!(0===r||p.length===r))b.preventDefault(),ct(m)}else h&&
(e=m.nextSibling,r=0,B=j),H&&(g=l.previousSibling,w=Ys(g),B=j),B&&Jq(e,r,g,w).select()}}}};a.Tw=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Uw=["http:","https:"],a.Sw=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.Rw=function(b){return"A"===b.nodeName},a.Vw=Vs(function(b){return $.post("/scraper",{url:b})});a.Ww=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.Fd=this.tg=n;this.le="写下你的评论…";this.placeholder='<p style="color:#999">'+this.le+"</p>";this.bm="";this.ia=-1;this.qG=$.Deferred().resolve();this.Kz=this.Ss=k;this.$C="zm-comment-box";this.Fh=k;(b=Hw[c])||f(Error("API not found"));this.Ui=$.extend({},Hw._default_,b);F.extend(this.G={},this.R,d||{})};y(Ww,T);t=Ww.prototype;t.R={nG:n,autofocus:j,ow:"empty",Re:"zm-item-comment"};
t.$=function(b){Ww.n.$.call(this,b);Xw(this);Yw(this);this.Fd=j;z.forEach(Zw(this),this.hz,this)};a.$w=function(b,c,d){var e=J(b.$C,c);d&&(b.Fh=d);e?b.o(e):(b.tg=j,b.aa(c))};t.FL="zm-comment-bubble";t.wC="."+Ww.prototype.FL;t.Bu=function(b){return $(b,this.g)};t.w=function(){this.g=K("div",{"class":this.$C,style:"display:none"});this.Yd()};t.cj=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
t.z=function(){Ww.n.z.call(this);this.field=this.eD=this.Cn=this.oC=this.Fh=this.Kz=this.oG=k};a.ax=function(b){var c=b.ql,d=c.m();if(c.Dl()!==b.placeholder){c.ne(n,b.placeholder);var e=["click","focus","keydown"],g=function(){c.ne(n,this.bm||"");this.field.lastChild?ct(this.field.lastChild):c.dg();Bd(d,e,g,n,this)};N(d,e,g,n,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&vc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};
t.ts=function(b){(b=b.m&&b.m())&&(new Qw({mF:{image:ha}})).o(b)};t.ss=function(b,c){if(b.m){var d=(new nj).add("type",this.type+"_comment").add("resource_id",this.id),e=b.m();this.k_=d=new Or(e,{cn:{source:"/people/autocomplete?"+d.toString()},dk:J("zu-main")});new Kr(e,{Wz:Qr});qa(c)&&c(d)}};
t.NU=rn(function(b){var c=J("zm-comment-content-wrap",b),d=J("zm-comment-form",c),e=b.getAttribute("data-id"),g=this,h;if(d){h=J("zm-comment-editable",d);if(ug(d)){if(wt(d))return Q(d,n)}else Q(d,j);bx(h)}else{b="";R.Ia()&&(b='<img class="avatar" src="'+R.SN()+'">');d=ic('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+b+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>');
c.appendChild(d);h=J("zm-comment-editable",d);var l=new Cw(h);l.ie();this.ss(l,function(){bx(h)});this.ts(l);var c=J("zm-comment-close",d),b=J("zm-comment-submit",d),m=function(){var b=La(l.Dl()),c=La(Ic(h));b&&c?cx(g,{content:b,TT:e},function(b){b.r||(Q(d,n),l.ne(n,""),(b=z.Ve(Zw(g)))&&Dt(b,{offsetTop:100,tC:j}))}):(U("请填写内容"),h.focus())};N(c,"click",function(){Q(d,n)});N(b,"click",m);N(h,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))m(),b.preventDefault()})}Dt(d,100)},function(){return{Ia:{question:"question_comment_reply",
answer:"question_answer_comment_reply"}[this.type],Kh:j}});a.bx=function(b){b.focus();b=lq(b);b.collapse();b.select()},a.Yw=function(b){var c=location.hash.slice(1).split("-"),d="comment"===c[0]&&c[1];d&&(b=z.find(Zw(b),function(b){return b.getAttribute("data-id")===d}),Mk(b),Dt(b))},a.Zw=function(b){return $(b.Cn).children(".zm-item-comment").get()};t.Xt=function(b){E.enable(this.eD,"expanded",b)};
t.Ji=function(b,c){this.dispatchEvent(new Jw("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:pa(c)?c:this.bb()}))};t.wj=function(){this.Fd?dx(this):this.tg=j};t.dS=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.zq(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&ex(this)};
t.na=function(b){var c=Qk(this.g,b.target);if(c&&c.name){var d=Mc(c,this.G.Re);b.preventDefault();switch(c.name){case "reply_comment":this.NU(d);break;case "cancelanon":b=$(this.g).parents(".feed-item-hook").data("qid");it(0,k,b);break;case "delcomment":this.Ql(c);break;case "like_comment":this.PO(c);break;case "author_delcomment":var e=this,g=Mc(c,this.G.Re),h=g.getAttribute("data-id"),b=$(".zm-item-link-avatar",g).prop("href");$.get(b+"/block",function(b){var c=Hi("删除评论","你确定要删除这条评论吗？"+('<p style="margin-top: 0.2em;color:#999;'+
(b.r||b.msg?"display:none":"")+'"><label><input type="checkbox">同时将此人屏蔽</label></p>'),function(b){if(b){var b=$(":checkbox",c.m()).prop("checked"),d=xa(L,g);e.Ui.KL(h,Number(b)).done(v(function(){qa(d)&&d();this.ia-=1;fx(this)},e))}},e)});break;case "admin_delcomment":var l=Mc(c,this.G.Re);(new Kw).open(c,{id:l.getAttribute("data-id"),type:"comment"},v(function(){L(l);this.ia-=1;fx(this)},this));break;case "closeform":ex(this);break;case "report":this.Yr(c);b.stopPropagation();break;case "addnew":this.zq();
break;case "load-more":this.Ji("comments_all"),this.oG(c)}}};
t.oG=function(b){this.Ss&&"pending"===this.Ss.state()||(b&&E.add(b,"loading"),this.Ss=this.Kz||this.pG(),this.Ss.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=Zw(this);d.length&&(c=z.filter(c,function(b){return!z.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=z.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),z.forEach(c,this.yC,this),b&&L(b));kc(this.Cn,c)}},this)))};
t.PO=rn(function(b){var c=$(b),d=Mc(b,this.G.Re),b=$(".like-num",d),e=d.getAttribute("data-id");(d=!c.hasClass("liked"))&&this.Ji("like_comment");this.Ui.zy(e,d);var e=$("em",b),g=+e.text()+(d?1:-1);b.toggleClass("liked",d).toggleClass("nil",0>=g).attr("data-tip","s$r$"+g+" 人觉得这个很赞");e.text(g);c.toggleClass("liked",d);Fk(c[0],d?"取消赞":"赞")},j);a.ex=function(b){0<b.bb()?(b.bm=b.ib(),b.Xt(n),ax(b)):b.Fh?b.collapse():b.Xt();b.Ge()};t.expand=function(){this.Pa(j)};t.collapse=function(){this.Pa(n)};
t.Ac=q("Fd");t.Pa=function(b){if(b!==this.Fd){b&&(this.Bu(this.wC).hide(),this.Yd());this.Fd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");Q(this.g,this.Fd);var c=v(function(){b&&gx(this);this.dispatchEvent(b?"expand":"collapse");this.Al&&!b&&(Gr(this.Al),Dt(this.Al.g))},this),d;b&&this.tg?(d=dx(this))&&d.done(c):setTimeout(c);this.Fh&&(b?(this.ZS=Ic(this.Fh),Fk(this.Fh,"收起评论")):Fk(this.Fh,0>this.ia?this.ZS:this.ia?this.ia+" 条评论":"添加评论"))}};t.yg=function(){this.Pa(!this.Fd)};
a.gx=function(b){if(b.Fh){var c=$(b.Fh);b.Bu(b.wC).show().css("left",c.position().left+c.width()/2)}},a.dx=function(b){if("pending"!==b.qG.state()){b.ab();b.g.innerHTML=b.cj();b.expand();var c=b.Ui.El(b.id,b.G.nG).done(v(b.MT,b));return b.qG=c}};t.pG=function(){return this.Ui.Fl(this.id)};a.hx=function(b,c,d,e){var c=$(c),g=$(d);d?($(".zm-command, .zm-comment-info",b.g).hide(),$(b.field).hide().after(g).after(c)):c.insertAfter(b.field);e&&e.call(b,c,g)};
t.MT=function(b){b=ic(La(b));Q(b,this.Fd);z.forEach($("."+this.G.Re,b).get(),this.hz,this);this.tg=n;this.ab();pc(b,this.g);this.g=b;Xw(this)};
a.Xw=function(b){F.forEach({oC:".load-more",Cn:".zm-comment-list",eD:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.g)[0]},b);b.field&&b.field.setAttribute("aria-label",b.le);if(Ug){var c=b.field;c.setAttribute("contentEditable",j);var d=b.ql={m:function(){return c},Dl:function(){return c.innerHTML},ne:function(b,d){c.innerHTML=d},dg:function(){Lt(c)}};b.ss(d);b.ts(d)}else{var e=K("textarea",{placeholder:b.le,"class":"zm-comment-textarea"});pc(e,b.field);new Oo(e,
22);b.field=e;b.ql={m:function(){return e},Dl:function(){return e.value},ne:function(){e.value="";e.style.height=bg(22,j)},dg:function(){e.focus()}}}b.h().e(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.bm=Mt(this.field)?"":this.ib())});R.Ia()&&!R.Jg&&hx(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function d(){el.U().F(j)}b.on("click",d);c.on("click",
d)});R.Ia()||hx(b,'<div class="signin-mask-tip-comment"></div>',k,function(c,d){function e(){new on({question:"question_comment_box",answer:"question_answer_comment_box"}[b.type])}c.on("click",e);d.on("click",e)});ax(b);b.h().e(b.g,"click",b.na).e(b.field,"keydown",b.dS).e(Pi,"anon_change",b.wj).e(b.ql.m(),["click","focus"],xa(b.Xt,j)).e(b.ql.m(),"focus",xa(b.Ji,"add_comment_start"));b.ia=Number(b.g.getAttribute("data-count"));$(b.g).on("focusin focusout","."+b.G.Re,function(b){$(this).toggleClass("focusin",
"focusin"===b.type)});!ub&&b.oC&&(b.Kz=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.pG,b)));fx(b);gx(b)},a.fx=function(b){var c=b.G,d=!b.bb();E.enable(b.g,c.ow,d);d&&b.field&&c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.ib=function(){var b=La(this.ql.Dl());return b===this.placeholder?"":b};t.zq=function(){var b=this.ib(),c=La(Ic(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?cx(this,b):(U("请填写内容"),this.field.focus())};t.bb=q("ia");
a.cx=function(b,c,d){if(!(b.vm&&"pending"===b.vm.state())){var e;ra(c)&&(e=c.TT,c=c.content);var c=Na(c),g=new Rd;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.Ui.add(g.mu());c.done($.proxy(b.bO,b)).done(d);b.vm=c;b.bm=b.ib();b.Ji("add_comment_submit")}};t.bO=function(b){if(b.r)return U(b.msg);this.Ui.ax(b.msg).done($.proxy(this.NT,this));this.ql.ne("");ax(this);this.Xt(n)};t.hz=function(b){this.yC(b)};
t.yC=function(b){if(uh("auth_f_manage")&&!("favlist"===this.type||$(".del",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft",b))}};t.NT=function(b){this.bm="";b=ic(b);this.Cn.appendChild(b);this.hz(b);this.ia+=1;fx(this)};
t.Yr=function(b){b=Mc(b,this.G.Re).getAttribute("data-id");Tu("comment",b)};t.Ql=function(b){var c=Mc(b,this.G.Re),d=c.getAttribute("data-id");Hi("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(L,c);this.Ui.remove(d).done(v(function(){qa(g)&&g();this.ia-=1;fx(this)},this))}},this)};t.Yd=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.bm)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Ge=function(){$(window).off("beforeunload.CommentForm")};
a.ix=function(b){if(!b.Al&&!gh.Bc){var c=Mc(b.g,"zm-item-meta");if(c){var d=J("zm-meta-panel",c);d&&(b.Al=new Ir(k,c),b.Al.Ah="comment",b.Al.o(d))}}};a.jx=function(b){T.call(this);this.entryType=b};y(jx,T);t=jx.prototype;t.gE="zm-item-expanded";t.Rj=k;t.C=function(){jx.n.C.call(this);var b=$(this.g),c={};$("meta[itemprop]",b).each(function(){var b=$(this);c[b.attr("itemprop")]=b.attr("content")});this.wc=c[this.entryType+"-id"];this.Un=c[this.entryType+"-url-token"];this.Br=c;this.ov();this.Of()};
t.ov=function(b){var c={'a[name="expand"]':function(b){this.Pa(j);this.Co&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Pa(n)},'a[name="toggleExpanded"]':this.yg,'a[name="ignore"]':this.yx,".js-close":this.bF,".js-unhide":this.jF,".js-hiderelated":this.aF,".js-report":this.fP,'a[name="dislike"]':this.nO};F.extend(c,b||{});F.forEach(c,function(b,c){$(this.g).on("click",c,$.proxy(b,this))},this);var d=$(".zm-meta-panel",this.g);F.forEach({'a[name="toggle-comment"]':function(b){var c;
this.nu();c=this.va.Ac();d.toggleClass("focusin",c);c&&(b=parseInt(Ic(b.currentTarget),10)||0,this.va.Ji("view_comments",b))},'a[name="share"]':this.Id},function(b,c){d.on("click",c,$.proxy(b,this))},this)};t.fP=function(){Tu(this.entryType,this.wc)};t.Jy=function(){Bv(this.entryType,this.Un,"read")};t.Ky=function(){Bv(this.entryType,this.Un,"touch")};t.Ac=function(){return E.has(this.g,this.gE)};t.yg=function(){this.Pa(!this.Ac())};
t.Pa=function(b){if(b===this.Ac())return n;b&&yu(this.g).height<ac().height&&1<$("a.collapse",this.g).length&&$("a.collapse",this.g).eq(0).remove();E.enable(this.g,this.gE,b);this.dispatchEvent(b?"expand":"collapse");return j};t.QS=function(){window.open(J(this.Rj,this.g).href)};t.bF=function(){$(this.g).fadeOut(150,function(){$(this).remove()})};t.jF=ha;t.aF=ha;t.Id=function(){new zv(arguments,"tb-webshare-sina")};
t.nO=function(){var b=$(this.g),c=$(".feed-item-inner",this.g),d=$(".dislike-wrap",this.g),e=d.data();d.one("click",".revert",function(){c.slideDown();d.slideUp();$.post("/topstory/item/uninterest/revert",e)}).one("click",".close",function(){b.slideUp(function(){b.remove()})}).on("click",".zg-unfollow",function(){var c=$(this).data(),d={roundtable:hk,column:gk};Hi("确定取消关注？",Lu("确定取消关注%s吗？",c.title),function(e){e&&(d[c.follow](c.token,n),b.slideUp(function(){b.remove()}))},this)});$.post("/topstory/item/uninterest",
e).done(function(){c.slideUp();d.slideDown()})};t.nu=function(){if(!this.va){var b=$(".toggle-comment",this.g)[0];this.va=new Ww(this.wc,this.entryType);this.J(this.va);$w(this.va,$(".zm-item-meta",this.g).get(0),b);ix(this.va)}this.va.yg()};t.NE=function(){this.va?this.va.field.focus():this.nu()};t.Of=function(){this.Lm=Dk.KJ(this.g);Ck(Bk(this.Lm,"shift+o",this.QS,this),{group:"操作",name:"新窗口打开条目"})};a.kx=function(b){T.call(this);this.bW="votebar-mobile";this.dw="votebar-mobile-dialog";this.cW=b;L(b.m());E.add(b.m(),this.bW);Vc(this,b);this.h().e(b,"action",function(){this.rb&&this.rb.F(n)})};y(kx,T);kx.prototype.$=function(b){kx.n.$.call(this,b);this.h().e(b,"click",this.TS)};kx.prototype.MQ='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
kx.prototype.TS=function(){this.rb&&this.rb.H();var b=new Di(k,n);b.Nn=j;b.wp(j);b.JN=j;var c=b.fa();c.appendChild(this.cW.m());c.appendChild(ic(this.MQ));E.add(b.m(),this.dw);b.F(j);this.rb=b;Vc(this,b)};a.lx=function(){jx.call(this,"post")};y(lx,jx);t=lx.prototype;t.Rj="post-link";
t.C=function(){lx.n.C.call(this);var b=this.eu=new Pu;this.J(b);Vc(this,b);this.h().e(b,"expand",function(){this.Pa(j)});b.o(this.g);b.ld()&&P(this.h(),b,"expand",this.Jy);Ou(this.g,this.Ky,this);if(b=J("zm-votebar",this.g))this.tc=new pv(this.wc,this.entryType),Vc(this,this.tc),this.tc.o(b),(b=J("votenum-mobile",this.g))&&(new kx(this.tc)).o(b);if(b=J("zm-item-vote-info",this.g)){var c=this.h0=new mx(this.wc,this.entryType);Vc(this,c);c.o(b);this.tc&&this.h().e(this.tc,"change",function(){c.jk()}).e(c,
"change",function(){var b=J("zm-item-vote-count",this.g),e=$(".zm-votebar .count",this.g)[0];b&&Fk(b,c.bb());e&&Fk(e,c.bb())})}};t.Id=function(){lx.n.Id.call(this,"分享文章","post",this.wc,{post_id:this.wc})};t.Pa=function(b){lx.n.Pa.call(this,b)&&(b||gu($(".entry-body",this.g)[0]),this.eu.Pa(b),this.rA(b))};t.rA=function(b){var c=this.vo();c&&Fr(c,b)};
t.vo=function(){if(this.gq)return this.gq;var b=!ub,c=J("zm-editable-content",this.g),d=this.tc&&this.tc.m();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.gq=new Ir(k,c),this.J(b),b.Ah="votebar",b.yz=50,b.o(d))};t.yx=function(){$(".feed-hide-options",this.g).show().siblings().hide();$.post(Lu("/post/uninterest"),{id:this.wc})};t.jF=function(){$(".feed-hide-options",this.g).hide().siblings().show();$.post(Lu("/post/undo_uninterest"),{id:this.wc})};
t.aF=function(b){var b=$(b.currentTarget),c=b.data();Hi(b.attr("title"),Lu("确定%s吗？",b.text()),function(b){b&&(this.bF(),$.post(Lu("/%s/uninterest",c.type),{id:c.id}))},this)};
t.Of=function(){lx.n.Of.call(this);Ck(Bk(this.Lm,"v",function(){this.tc&&this.tc.hB()},this),{group:"操作",name:"赞同"});Ck(Bk(this.Lm,"d",function(){this.tc&&this.tc.gB()},this),{group:"操作",name:"反对"});Ck(Bk(Ck(Bk(Ck(Bk(Ck(Bk(this.Lm,"o",this.yg,this),{group:"操作",name:"显示全部/收起"}),"c",this.nu,this),{group:"操作",name:"打开评论"}),"f x",this.Id,this),{group:"操作",name:"分享"}),"shift+c",this.NE,this),{group:"操作",name:"定位到评论框"})};a.nx=function(b){jx.call(this,b)};y(nx,jx);nx.prototype.Rj="question_link";nx.prototype.yx=function(){var b=this.Br["question-id"];this.dispatchEvent({type:"ignore",key:"question-id",value:b});$.post("/question/uninterest",{qid:b})};a.ox=function(){jx.call(this,"question")};y(ox,nx);ox.prototype.C=function(){ox.n.C.call(this);Ou(this.g,function(){Bv("question",this.Un,"touch")},this)};ox.prototype.Id=function(){ox.n.Id.call(this,"分享问题","question",this.Un,{qid:this.wc})};
ox.prototype.Of=function(){ox.n.Of.call(this);Ck(Bk(Ck(Bk(Ck(Bk(this.Lm,"c",this.nu,this),{group:"操作",name:"打开评论"}),"f x",this.Id,this),{group:"操作",name:"分享"}),"shift+c",this.NE,this),{group:"操作",name:"定位到评论框"})};a.px=function(){jx.call(this,"answer")};y(px,nx);a.qx=function(b){return J("zm-item-answer",b)||J("entry-body",b)};t=px.prototype;t.C=function(){px.n.C.call(this);this.uC=qx(this.g);this.Co=this.uC.getAttribute("data-isowner");this.Yx();this.Xl()};t.Id=ha;
t.Pa=function(b){px.n.Pa.call(this,b)&&(b||(gu(this.Kg.m()),rx(this,n)),b&&this.Xl(),this.Kg.rA(b),this.Kg.eu.Pa(b))};t.Yx=function(){var b=J("zm-item-answer-author-wrap",this.g);b&&(b=J("zm-list-avatar",b),jk.add(b))};t.Xl=function(){this.Kg=new sx(this.Br["question-id"],{wb:this.Br["question-url-token"]},this.wc);var b=J("zm-item-meta",this.g);this.Kg.nc=b;this.J(this.Kg);this.Kg.o(this.uC);b=this.Kg.eu;this.h().e(b,"expand",function(){this.Pa(j)});this.Xl=ha};
t.Of=function(){px.n.Of.call(this);Ck(Bk(this.Lm,"o",this.yg,this),{group:"操作",name:"显示全部/收起"})};t.ov=function(){px.n.ov.call(this,{"a[name=expandQuestionDetail]":function(){rx(this,j)}})};a.rx=function(b,c){$(".feed-question-detail-item",b.g).toggleClass("question-detail-expanded",c)};a.tx=function(){jx.call(this,"roundtable")};y(tx,jx);tx.prototype.Rj="roundtable_link";tx.prototype.yx=function(){$.post("/roundtable/"+this.Un,{action:"mute"});this.dispatchEvent({type:"ignore",key:"roundtable-id",value:this.wc})};a.ux=function(b){var c=b.getAttribute("data-type");return(c={p:lx,a:px,q:ox,r:tx}[c])?new c:qx(b)?new px:new T};a.vx=function(b,c,d){gv.call(this,b,c,d)};y(vx,gv);vx.prototype.ak=function(b){var c=ux(b);this.J(c);c.o(b);c instanceof px&&c.Pa(n)};a.wx=function(){M.call(this);this.ca=k;this.ta=0;this.Ay=[];this.Os=[];this.fB="最多输入 20 字";this.bw="最多输入 256 字"};y(wx,Dn);a.xx=k,a.yx=function(){xx||(xx=new wx);return xx};t=wx.prototype;t.B=function(b){b||this.Qr()};
t.w=function(){this.UD=j;this.g=K("div",k,[this.Sj=K("div",k,[this.ih=K("div","zm-favo-list-content"),this.gC=K("div","zh-favo-add-new-wrap zm-command",this.$U=K("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.Jv=K("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.Yu=K("div","zh-favo-add-new-wrap zm-command",this.tM=K("a",{href:"javascript:;","class":""},"取消"),this.aV=K("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.Pw=
K("div",{style:"display:none"},[K("div",k,["标题",this.eB=K("span",{"class":"zh-favo-add-title-error"},"请填写标题")]),K("div","zg-section",this.Tj=K("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),K("div",k,"描述（可选）"),K("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.cm=K("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.uT=K("label",k,[this.AQ=K("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),K("strong",k," 公开 "),K("span","zg-gray-normal",
"公开后不能设置为私密")]),this.KQ=K("br"),this.rT=K("label",k,[this.zQ=K("input",{type:"radio",value:"private",name:"mode"}),K("strong",k," 私密 "),K("span","zg-gray-normal","只有你可以查看这个收藏夹")]),K("div","zm-command",[this.PA=K("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.Zq=K("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.fC=K("a",{"class":"zg-btn-blue"},"确认创建")])])]);Q(this.eB,n);Q(this.Yu,n);(new Io(this.fB)).o(this.Tj);(new Io(this.bw)).o(this.cm);z.forEach(this.Ay,function(b){zx(this,b)},this);
this.Ay.length||(this.ih.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',Q(this.Yu,j),Q(this.gC,n));this.ca=new Di(k,n);mi(this.ca,k);this.ca.fa().appendChild(this.g);this.h().e(this.ca,"afterhide",function(){this.Ge()})};
a.zx=function(b,c,d){var e=I("zh-fav-list-item-place-holder");e&&Q(e,n);b.Lz=c[5]?"":K("a","zm-fav-list-item-lock zg-locked");e=K("span","zm-favo-list-item-title");Ac(e,c[1]);e=K("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Lz,e,K("span",{className:"zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+c[4]+" 人关注"})]);b.Lz&&b.Lz.setAttribute("data-tip","s$b$私密收藏夹");e.setAttribute("data-lid",c[0]);z.contains(b.Os,c[0])&&E.add(e,"zm-favo-list-item-link-active");
c=J("zm-favo-list-item-link",b.ih);d&&c?mc(e,c):b.ih.appendChild(e)};
t.Sa=function(){this.h().e(this.PA,"click",function(){this.ta?Ax(this,0):Bx(this)}).e(this.$U,"click",function(){Y.Y({type:"ga_click_add_collection"});Ax(this,1)}).e(this.Jv,"click",function(){Bx(this)}).e(this.aV,"click",function(){Y.Y({type:"ga_click_add_collection"});Ax(this,1)}).e(this.tM,"click",function(){Bx(this)}).e(this.Zq,"click",function(){Bx(this)}).e(this.fC,"click",this.Bf).e(this.ih,"click",this.vS).e(this.Tj,"change",function(){Q(this.eB,n)})};
t.vS=function(b){var c=Lc(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=n;E.has(c,"zm-favo-list-item-link-active")?(d=j,this.xD=b):this.sD=b;c=new Rk;c.add("answer_id",this.ta);c.add("favlist_id",b);this.gA=new V(j);this.locked=j;P(this.h(),this.gA,"complete",this.oL);this.gA.ajax(d?"/collection/remove":"/collection/add",c.Pc())}};
t.oL=function(){this.locked=n;this.Jv.innerHTML="关闭";var b=Le(this.gA);b&&!b.r?(b=Yb("zm-favo-list-item-link",this.ih),z.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=J("num",b),g=parseInt(e.innerHTML,10);d===this.xD?(e.innerHTML=g-1+"",E.remove(b,"zm-favo-list-item-link-active")):d===this.sD&&(e.innerHTML=g+1+"",E.add(b,"zm-favo-list-item-link-active"))},this),this.sD=this.xD=k,Uk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
t.show=function(b){this.B(b);this.Ry&&(this.ca.F(j),this.Jv.innerHTML="关闭",this.ta?(Q(this.Zq,n),Ax(this,0)):(Ax(this,1),Q(this.PA,n),this.Zq.innerHTML="取消"))};
a.Ex=function(b,c,d,e){var g=I("zh-fav-head-title"),h=I("zh-fav-head-description-source"),c=c||(g?Ic(g):""),d=d||(h?Ic(h):"");b.wD=e||mh;b.UD?Cx(b):b.w();b.Ry=j;b.Sa();Ax(b,1);Q(b.PA,n);b.Zq.innerHTML="取消";b.fC.innerHTML="保存";b.ca.lb("编辑收藏夹");b.Tj.value=Za(c);b.cm.value=Za(d);b.wD[1]?(Q(b.uT,n),Q(b.rT,n),Q(b.KQ,n)):b.zQ.setAttribute("checked",j);b.aQ=Dx(b);b.ca.F(j);b.As=j};t.Qr=function(){(this.ta||!this.Ry)&&$.get("/collections/json",{answer_id:this.ta}).done(v(this.jS,this))};
a.Cx=function(b){var c=Yb("zm-favo-list-item-link",b.ih);z.forEach(c,function(b){var c=b.getAttribute("data-lid");E.remove(b,"zm-favo-list-item-link-active");z.contains(this.Os,+c)&&E.add(b,"zm-favo-list-item-link-active")},b)};t.jS=function(b){b&&!b.r&&(this.Ay=b.msg[0],this.Os=b.msg[1],this.UD?Cx(this):this.w(),this.Ry=j,this.Sa(),this.show(j))};
a.Ax=function(b,c){var d=!!c;b.ca.lb(0===c?"添加到收藏夹":"创建新收藏夹");Q(b.Sj,!d);Q(b.Pw,d);new Zl(b.Tj,b.fB);new Zl(b.cm,b.bw);if(1===c)$(b.Pw).on("change.FavoDiag","input, textarea, select",function(){b.Yd()});else $(b.Pw).off("change.FavoDiag"),b.Ge()},a.Dx=function(b){var c=new Rk,d=Hk(b.Tj.value),e=Wa(b.cm.value===b.bw?"":b.cm.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.AQ.checked?1:0);return c};
t.Bf=function(){var b=Hk(this.Tj.value);if(!b||b===this.fB)Q(this.eB,j);else{b=Dx(this);this.ta&&b.add("answer_id",this.ta);if(this.As){if(this.aQ.Pc()===b.Pc()){Bx(this);return}b.add("favlist_id",this.wD[0])}this.xhr=new V(j);P(this.h(),this.xhr,"complete",this.ZK);this.xhr.ajax(this.As?"/collection/update":"/collection/create",b.Pc())}};
t.ZK=function(){var b=Le(this.xhr);b&&!b.r?this.As?(Bx(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.As=n):this.ta?(Q(this.Yu,n),Q(this.gC,j),Ax(this,0),this.Os.push(b.msg[0]),zx(this,b.msg,j),this.Tj.value="",this.cm.value=""):(Bx(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.V=function(){return this.ca.V()};
a.Bx=function(b){b.ca.F(n);b.dispatchEvent(Fx);Y.Y({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.ih).length}})},a.Fx="close";wx.prototype.Yd=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};wx.prototype.Ge=function(){$(window).off("beforeunload.FavoDiag")};a.Gx=function(b){var c=b.type;if(!la(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return la(b.value)?b.value:k}},a.Hx=function(b,c){var d=b.elements[c];if(d.type)return Gx(d);for(var e=0;e<d.length;e++){var g=Gx(d[e]);if(g)return g}return k};a.Ix=function(){T.call(this)};y(Ix,T);Ix.prototype.$=function(b){Ix.n.$.call(this,b);this.h().e(Y,"sina_callback",this.im);this.h().e(Y,"qq_callback",this.im);this.h().e(Y,"qqconn_callback",this.im);this.h().e(I("zh-setting-page-bind-sina-unbindbtn"),"click",this.qz);this.h().e(I("zh-setting-page-bind-qq-unbindbtn"),"click",this.qz);this.h().e(I("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.qz)};
Ix.prototype.im=function(b){if("qq_callback"===b.type){var c=wh.name=b.qb.name,b=wh.id=b.qb.id;I("zh-setting-page-bind-qqname").innerHTML='<a href="http://t.qq.com/'+b+'" target="_blank">@'+c+"</a>";Jx(j)}else"sina_callback"===b.type?(c=vh.name=b.qb.name,b=vh.id=b.qb.id,I("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>",Kx(j)):"qqconn_callback"===b.type&&(I("zh-setting-page-bind-qqconnname").innerHTML=b.qb.name,Lx(j))};
Ix.prototype.qz=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qq:"腾讯微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new V(j);P(this.h(),d,"success",function(){var b=Le(d);b&&!b.r?"sina"===c?Kx():"qq"===c?Jx():"qqconn"===c&&Lx():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.Kx=function(b){Q(I("zh-setting-page-bind-sina-binded-wrap"),!!b);Q(I("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.Jx=function(b){Q(I("zh-setting-page-bind-qq-binded-wrap"),!!b);Q(I("zh-setting-page-bind-qq-tobind-wrap"),!b)},a.Lx=function(b){Q(I("zh-setting-page-bind-qqconn-binded-wrap"),!!b);Q(I("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.Mx=function(){T.call(this)};y(Mx,T);t=Mx.prototype;
t.$=function(b){Mx.n.$.call(this,b);if(b=J("profile-edit-avatar-btn"))this.ln=new Vl(Ul),this.ln.o(b),this.h().e(this.ln,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))}),this.h().e(this.ln,"success",function(b){$("img.zm-avatar-editor-preview").attr("src",b.src);$(".avatar-edit-preview-loading").remove()});this.O=[];var c=this;$(".editable-group",this.g).each(function(){var b=new Xm;c.O.push(b);b.o(this)});
b=I("zm-profile-edit-submit");this.h().e(b,"click",this.oz);(new Ix).o(this.g);$(this.g).on("change","input, textarea, select",function(){c.Yd()})};
t.C=function(){Mx.n.C.call(this);var b=I("zm-profile-progress-anim"),c=new Nx;c.addEventListener("update",function(){var d=100*c.X()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});z.forEach(this.O,function(b,d){c.watch({name:"name"+d,target:b,ci:["add","remove"],Uh:function(){return!!b.Ad.children().length}})},this);var d=this.g,e=I("zm-profile-edit-male"),g=I("zm-profile-edit-female"),h=I("zm-profile-edit-description"),l=$(".business-selection select")[0],m=I("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:I("zm-profile-edit-expert-enable"),ci:["change"],Uh:function(){return k!==Hx(d,"enable_expert")}}).watch({name:"expert_progress",target:m,ci:["change"],Uh:function(){return k!==Hx(d,"enable_expert")}}).watch({name:"gender_progress",target:e,ci:["change"],Uh:function(){return k!==Hx(d,"gender")}}).watch({name:"gender_progress",target:g,ci:["change"],Uh:function(){return k!==Hx(d,"gender")}}).watch({name:"desc_progress",target:h,ci:["blur"],Uh:function(){return!!La(h.value)}}).watch({name:"business_progress",
target:h,ci:["blur"],Uh:function(){return!!La(h.value)}}).watch({name:"headline_progress",target:l,ci:["blur"],Uh:function(){return!!La(l.value)}})};t.Yd=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Ge=function(){$(window).off("beforeunload.profileedit")};
t.oz=function(){function b(b){U(ma(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var m=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);m.push([b.data("title"),b.data("sub-title")||""])});var p=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=F.filter({avatar_path:this.ln?this.ln.getData():k,gender:c,headline:d,description:e,location:h,business:g,employment:l,education:m,enable_weibo:p,enable_expert:r},kt),w=v(function(){this.Ge();window.location.href="/people/"+R[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=Le(this)}catch(d){}c&&
!c.r&&qa(w)?w.call(this,c):qa(b)&&b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(cd(c)))};a.Nx=function(){this.Cz={}};y(Nx,Kd);Nx.prototype.update=function(b,c){this.Cz[b]=c;this.dispatchEvent({type:"update"});return this};Nx.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.Uh())},this);N(b.target,b.ci,c);c();return this};Nx.prototype.X=function(){var b=F.La(this.Cz);return b.length&&z.filter(b,Boolean).length/b.length};a.Ox=function(){this.mj="editing";T.call(this)};y(Ox,T);Ox.prototype.$=function(b){Ox.n.$.call(this,b);this.M=$(b);this.M.on("click",'a[href^="javascript"]',$.proxy(this.na,this));this.M.on("click",'a[href^="javascript"], input',n);this.M.on("click",".item",$.proxy(this.SS,this))};a.Px=function(b,c,d){if(!gh.Bc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.M).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
Ox.prototype.SS=function(b){var c=$(b.currentTarget),d=c.data("href"),b=b.metaKey||b.ctrlKey;d&&!c.hasClass(this.mj)&&(b?window.open(d):location.href=d)};
Ox.prototype.na=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.mj).closest(".skilled-topics").addClass(this.mj),Px(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.mj).closest(".skilled-topics").removeClass(this.mj),Px(this,d,j);else if("save"===b){var e=
new V(j);this.h().e(e,"success",function(){var b=Le(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.mj).closest(".skilled-topics").removeClass(this.mj),Px(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.Qx=function(){T.call(this)};y(Qx,T);
Qx.prototype.$=function(b){Qx.n.$.call(this);if(b&&(this.M=$(b),$(".editable-group",this.M).each(function(){(new Sx).o(this)}),(b=I("profile-header-description-input"))&&new Oo(b),(b=J("zm-profile-header-avatar-container"))&&E.has(b,"self"))){var c=new Vl(Ul);c.o(b);this.h().e(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.h().e(c,"success",function(b){b.src&&(J("zm-avatar-editor-preview").src=b.src,
ou("ProfileHeaderV2","save",{data:{avatar_path:c.getData()}},function(){$(".avatar-edit-preview-loading").remove()}))})}};a.Sx=function(){T.call(this)};y(Sx,T);t=Sx.prototype;t.$=function(b){Sx.n.$.call(this);this.M=$(b);this.se=$(".info-wrap",this.M);this.Td=$(".edit-wrap",this.M);this.pW=$(".title",this.se);this.oW=$("input",this.Td)};
t.C=function(){Sx.n.C.call(this);this.M.on("click","[name='edit']",$.proxy(function(){this.M.addClass("editing");var b=this.Td.find("input").get(0);b?b.focus():(b=this.Td.find("textarea").get(0))&&b.focus()},this));var b=this;this.wq=[];$("input[type=text]",this.M).each(function(){var c=new Ym("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.wq.push(c)});this.Td.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Td.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
t.save=function(){var b=this.M.data("name");if("location"===b){var b=this.Td.find("input.location"),c=this.Td.find("select"),d=this.Td.find("input.male").is(":checked")?1:0;ou("ProfileHeaderV2","save",{data:{location:[b.val()],business:c.val(),gender:d}},function(b){b=b.msg;b.location[0].html||(b.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>");b.business.html||(b.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>");
this.se.find("span.location").attr("title",b.location[0].text).html(b.location[0].html);this.se.find("span.business").attr("title",b.business.text).html(b.business.html);this.se.find("i.gender").removeClass("male female").addClass(1===parseInt(b.gender,10)?"male":"female");this.cancel()},this.wi,this)}else"employment"===b?(c=this.Td.find("input.employment"),b=this.Td.find("input.position"),c=c.val(),b=b.val(),ou("ProfileHeaderV2","save",{data:{employment:[[c,b]]}},function(b){b=b.msg;!b.employment[0][0].text&&
!b.employment[0][1].text?this.M.addClass("empty"):this.M.removeClass("empty");b.employment[0][0].html||(b.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>");b.employment[0][1].html||(b.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>");this.se.find(".employment").attr("title",b.employment[0][0].text).html(b.employment[0][0].html);this.se.find(".position").attr("title",b.employment[0][1].text).html(b.employment[0][1].html);
this.cancel()},this.wi,this)):"education"===b?(c=[this.Td.find("input.education"),this.Td.find("input.education-extra")],b=c[0].val(),c=c[1].val(),ou("ProfileHeaderV2","save",{data:{education:[[b,c]]}},function(b){b=b.msg;!b.education[0][0].text&&!b.education[0][1].text?this.M.addClass("empty"):this.M.removeClass("empty");b.education[0][0].html||(b.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>");b.education[0][1].html||(b.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>");
this.se.find(".education").attr("title",b.education[0][0].text).html(b.education[0][0].html);this.se.find(".education-extra").attr("title",b.education[0][1].text).html(b.education[0][1].html);this.cancel()},this.wi,this)):"description"===b&&(b=this.Td.find("textarea.description"),ou("ProfileHeaderV2","save",{data:{description:b.val()}},function(b){b=b.msg;b.description.text?this.M.removeClass("empty"):(b.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",
b.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",this.M.addClass("empty"));this.se.find(".fold-item .content").empty().html(b.description.fold_html);this.se.find(".unfold-item .content").html(b.description.unfold_html);b.description.shortened?this.se.removeClass("disable-fold"):this.se.addClass("disable-fold");this.cancel()},this.wi,this))};t.wi=function(b){U(b.msg)};t.cancel=function(){this.M.removeClass("editing")};a.Tx=function(){M.call(this);this.fh="zm-item";this.ZY="zm-item-top-btn";this.iU=j};y(Tx,Dn);t=Tx.prototype;t.B=function(b){this.Lb=b;this.h().e(b,"click",this.na);this.refresh()};t.sh=ca("fh");
t.na=function(b){if(b.target){var c=Qk(this.Lb,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Mc(b.target,this.fh),this.type&&(this.id&&this.action&&this.item)&&(this.OJ||(this.OJ=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",this.Af),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.XY=c))}};
t.Af=function(){if("cancel-top"===this.action)ej(this.item,j);else if("top"===this.action){var b=Yb(this.fh,this.Lb);this.D_=gg(this.item).y;b&&2<=b.length&&mc(L(this.item),J(this.fh,this.Lb));this.scroll();Mk(this.item);Q(J("zm-item-top-btn-top",this.item),n);Q(J("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.OJ=n};t.scroll=function(){if(this.iU){var b=J("zm-profile-section-wrap"),c=Pc(Vb((fa||window).document)).y;b&&0>gg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Yb(this.fh,this.Lb);b&&0<b.length&&z.forEach(b,function(b,d){if(0!==d){var e=J("zm-item-top-btn-top",b);e&&Q(e,j)}},this)};a.Ux=function(b,c){b.h().e(c,"next",b.refresh)};a.Vx=function(){this.Mw=["zg-btn-follow","zg-btn-unfollow"];this.Nw="people"};y(Vx,T);Vx.prototype.C=function(){this.h().e(this.g,"click",this.na)};Vx.prototype.na=function(b){var c=Qk(this.g,b.target);this.An&&this.An(c);c&&(c.name&&"focus"===c.name)&&tn(c,this.Nw,function(){c.getAttribute("data-followme")&&(E.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.Mw,{DZ:"question"===this.Nw?"关注问题":k})};Vx.prototype.yp=ca("An");a.Xx=function(b,c,d,e){M.call(this);this.Xd=b;this.$h=c;this.mh=d;this.RD=e||Wx;b.maxLength=d;this.Kj=new sv(b);N(this.Kj,"input",this.Wo,n,this);this.Zi()};y(Xx,Kd);a.Wx=0;Xx.prototype.Wo=function(){this.Zi()};Xx.prototype.Zi=function(){var b=this.Xd.value.length;if(b>this.mh){var c=this.Xd.scrollTop,d=this.Xd.scrollLeft;this.Xd.value=this.Xd.value.substring(0,this.mh);b=this.mh;this.Xd.scrollTop=c;this.Xd.scrollLeft=d}this.$h&&Ac(this.$h,1==this.RD?b:this.mh-b)};
Xx.prototype.z=function(){Xx.n.z.call(this);delete this.Xd;this.Kj.H();this.Kj=k};a.Yx=function(b){M.call(this);this.ca=k;this.oa=b;this.Kt=0;this.MH=""},a.Zx=void 0;y(Yx,Dn);t=Yx.prototype;t.B=function(){this.Yl||(this.Yl=j,this.w(),this.Sa())};t.Sa=function(){A||(new Io("搜索问题")).o(this.Uc);this.O=new Uo("/redirect-question/autocomplete",this.Uc,k,k,I("zh-question-redirect-diag-content"),n);this.O.jn=n;this.O.Hf(j);this.h().e(this.O,tm.Jh.Ri,bl);this.h().e(this.O,"select",this.wS).e(this.YL,"click",function(){this.ca.F(n)})};
t.wS=function(){var b=this.O.fg();if("search_link"===b[0])window.open("/search?q="+encodeURIComponent(b[1])+"&type=question");else{this.Uc.value="";var c=b[3],b=b[1];this.ca.F(n);this.Uc.value="";this.xhr=new V(j);P(this.h(),this.xhr,"complete",this.pL);this.xhr.ajax("/question/redirect","qid="+this.oa+"&rqid="+c);this.Kt=c;this.MH=b}};t.pL=function(){var b=Le(this.xhr);b&&(b.r?U(b.msg):this.ob?(this.ob.innerHTML="已经重定向",this.ob.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.w=function(){this.g=K("div",{id:"zh-question-redirect-diag"},["将问题跳转至",K("div",{id:"zh-question-redirect-diag-content"},this.Uc=K("input",{type:"text","class":"zg-form-text-input"})),K("div","zm-command",this.YL=K("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.ca=new Di(k,n);this.ca.lb("问题重定向");mi(this.ca,k);this.ca.fa().appendChild(this.g)};t.show=function(){this.B();this.ca.F(j)};a.$x={},a.$x=function(){M.call(this)};y($x,Dn);$x.Ou=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];$x.Lj=k;$x.U=function(){$x.Lj||($x.Lj=new $x,$x.Lj.B());return $x.Lj};t=$x.prototype;
t.B=function(){if(!this.g){this.w();this.Sa();var b=new fo(this.g);Xh(b);b.pF=j;b.wp(j);b.F(n);b.Hz=0;b.V()&&b.pa();dt(b,new Rf(13,0,0,-22));this.Gz=b}};t.Sa=function(){this.h().e(this.g,"click",this.uS)};t.uS=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.QM.CZ(b),this.Gz.F(n))};
t.w=function(){var b=K("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[K("div","zg-r5px zu-hovercard-inner",[K("div",{id:"zh-answer-flag-popup-header"},[K("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.uH=K("div",{id:"zh-answer-flog-options-wrap"})]),K("div","zu-hovercard-spin-top")]);z.forEach($x.Ou,function(b,d){var e=K("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.uH.appendChild(e)},this);document.body.appendChild(b);this.g=b};t.show=function(b,c){this.Gz.ed(new co(b,1));var d=c.JZ(),e=Yb("zm-menu-item-link",this.uH);z.forEach(e,function(b,c){Q(b,!z.contains(d,c))},this);this.Gz.F(j);this.QM=c};a.ay=function(){M.call(this)},a.by=void 0;y(ay,Dn);
ay.prototype.B=function(){this.w();this.h().e(this.zl,"change",function(){var b=this.zl.value;this.Oz.value="no"===b?"":$x.Ou[+b][1]}).e(this.$i,"click",function(b){"cancel"===b.target.name?this.ca.F(n):this.Oz.value&&"no"!==this.zl.value&&(this.Iw=new V(j),this.h().e(this.Iw,"complete",function(){var b=Le(this.Iw);b&&!b.r?(this.ob.innerHTML="已经标记",this.ca.F(n)):U(b.msg)}),b=Hk(this.Oz.value),this.Iw.ajax("/answer/flag","answer_id="+this.SK+"&flag="+this.zl.value+"&reason="+encodeURIComponent(b)))})};
ay.prototype.w=function(){this.g=K("div",k,[K("div","zg-section",[K("div",k,"标记："),this.zl=K("select")]),K("div",k,[K("div",k,"原因"),this.Oz=K("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.$i=K("div","zm-command",[K("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),K("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.zl.appendChild(K("option",{value:"no"},"选择标记原因"));z.forEach($x.Ou,function(b,c){this.zl.appendChild(K("option",
{value:c},b[0]))},this);this.ca=new Di(k,n);this.ca.lb("标记答案");mi(this.ca,k);this.ca.fa().appendChild(this.g)};ay.prototype.show=function(){this.ca.F(j)};a.cy=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":by||(by=new ay,by.B());c=by;c.ob=b;c.SK=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;Zx||(Zx=new Yx,Zx.B());d=Zx;d.ob=b;d.oa=b.id.split("-")[1];"redirect"===c?d.show():(Ji("/question/unredirect",k,"POST","qid="+d.oa+"&rqid="+d.Kt),d.ob.innerHTML="重定向已撤销",d.ob.setAttribute("data-disabled",1))}break;case "revert":var e=Hi("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new nj).add("revision",d).add("reason",c),m=new V(j);m.on("success",function(){var b=Le(m);b.r?U(b.msg):(e.F(n),b.msg?window.location.href=b.msg:location.reload())});m.ajax("/revert",c.toString());return n}}),g=J("content",e.fa());new Zl(g);new Oo(g,48);new Xx(g,k,200)}},a.dy=function(b){$(b).on("click",'a[name="revert"]',function(){cy(this)})};a.ey=function(){T.call(this)};y(ey,T);t=ey.prototype;t.B=function(){Fs.J(this);this.o(document.body)};
t.C=function(){ey.n.C.call(this);var b=J("zm-profile-header-operation");b&&(new Vx).o(b);(b=J("zm-profile-header"))&&(new Qx).o(b);(b=I("zh-profile-activity-wrap"))&&this.h().e(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");tn(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.Ow=b=I("zh-profile-page-force-to-rename"))&&this.h().e(b,"click",this.AV);this.ay();if(b=I("zh-profile-activity-page-list")){var c=new Qu({ra:["expandLimit"],
wh:j});c.ra("locationSource",{url:"/people/"+lh[1]+"/activities",Ms:10,gp:j});c.ra("childConstructor",{factory:ux});this.J(c);c.o(b);this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category","profile").fill("label","profile_feed")})}(b=J("zm-profile-fav-wrap"))&&this.h().e(b,"click",this.xN);(b=I("zm-profile-details-editform"))&&(new Mx).o(b);if(b=J("zm-profile-answer-sort"))this.Oh=new fv,this.Oh.Ha(this.CL=new cv("按时间排序")),this.Oh.Ha(this.DL=new cv("按投票排序")),this.Oh.Ha(this.BL=
new cv("问"+R[0]+"的问题")),this.Oh.aa(b),this.Oh.F(n),this.h().e(b,"click",function(b){this.Oh.F(j);b.stopPropagation();P(this.h(),document,"click",function(){this.Oh.F(n)})}),this.h().e(this.Oh,"action",this.iP);(b=I("zh-profile-edit-expert"))&&(new fy).o(b);var d=J("profile-expert-tip");d&&this.h().e(d,"click",function(b){var c=b.target;("enable"===c.name||"close"===c.name)&&ou("ProfileExpertTopicsV2",c.name,k,function(){"enable"===c.name?location.reload():ej(d,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new Ox).o(this)});
$(".zm-profile-module.skilled-topics").each(function(){(new Ox).o(this)});$(".zm-profile-module.active-topics").each(function(){(new Ox).o(this)});if(c=I("zh-profile-ask-list"))if(b=new Qu({ra:["autoload","locationSource"],wh:n}),this.J(b),b.o(c),c=J("zm-profile-section-list")){var e=new Tx;e.sh("zm-profile-section-item");Ux(e,b);e.B(c)}if(c=$("#zh-profile-answer-list > .zh-general-list").get(0)||$("#zh-profile-answer-list").get(0))if(b=new Qu({wh:n}),this.J(b),b.ra("childConstructor",{dj:px}).ra("expandLimit"),
b.o(c),this.h().e(b,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category","profile").fill("label","profile_answers_list")}),c=J("zm-profile-section-list"))e=new Tx,Ux(e,b),e.B(c);if(b=$("#zh-profile-log-list").get(0))c=new Qu,c.ra("locationSource",{gp:j}),this.J(c),c.o(b),dy(b);if(c=I("zh-profile-topic-list"))if(b=new Qu({ra:["autoload","locationSource"]}),this.J(b),this.h().e(b,"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(R[3]===lh[3]){var d=new Wr(j,
"/topic/bio/update","bio");d.tu=j;d.sd=["tid="+c];d.Ab='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.o(b)}}),b.o(c),c=J("zm-profile-section-list"))e=new Tx,e.sh("zm-profile-section-item"),Ux(e,b),e.B(c);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))c=new Qu({ra:["autoload","nodeSource"]}),this.J(c),c.o(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))c=new Qu({ra:["autoload","nodeSource"]}),this.J(c),c.o(b);if(b=$("#zh-profile-follows-list-old").get(0))c=new Qu({ra:["autoload",
"locationSource"]}),this.J(c),c.o(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))c=new Qu({ra:["autoload","nodeSource"],wh:n}),this.J(c),c.o(b);this.to();-1<location.search.indexOf("clean-followers-noti=1")&&(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){pn(new on,n)})};t.AV=function(){Hi("确定","确定要强制此用户改名吗？",function(b){b&&(I("realname_form").submit(),this.Ow.innerHTML="已发送",E.add(this.Ow,"zg-gray"),Fd(this.Ow))},this)};
t.to=function(){this.Jj();var b=I("zm-profile-header-pm-btn");b&&N(b,"click",Bu(function(b){b.preventDefault()},rn(function(){var c=new Vo;c.show();Zo(c,lh[3],lh[0]);Yo(c,b.href);c.ac.focus()},j)));var c=I("zh-profile-cancel-block");c&&this.h().e(c,"click",this.ZG);(c=I("zh-report-people"))&&this.h().e(c,"click",this.dI);(c=I("zh-profile-search-query-mirro"))&&new Zl(c,c.getAttribute("placeholder"))};
t.ZG=function(){Hi("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&gy(this,n)},this)};t.$k=function(){P(this.h(),document,"click",function(){this.jb.F(n)})};t.Jj=function(){var b=I("profile-side-op");b&&this.h().e(b,"click",this.zj)};t.iP=function(b){var c="";b.target===this.CL?c="time":b.target===this.DL?c="vote":b.target===this.BL&&(c="ask");location.href="/people/"+R[1]+"/answers?sort="+c};
t.zj=function(b){b=b.target.name;"block"===b?Hi("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&gy(this,j)},this):"report"===b?this.dI():"cancel-block"===b&&this.ZG()};t.dI=function(){Tu("member",lh[3])};a.gy=function(b,c){var d=new V(j);P(b.h(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+lh[1]+"/block","action="+(c?"add":"cancel"))};
t.xN=function(b){if(b&&b.target&&(b=Qk(this.g,b.target))){var c=J("zm-profile-fav-item-title",b),d=J("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],Ex(yx(),c,d,b))}};
t.ay=function(){if(this.eA=I("zh-profile-search-form")){var b=I("zh-profile-search-type");b&&this.h().e(b,"click",this.sS);this.rk=this.eA.getAttribute("data_type");this.h().e(this.eA,"submit",this.search);N(window,"popstate",function(b){var b=b.state,c;b&&b.st&&(c=I("zh-profile-search-query"),c.value=decodeURIComponent(b.st),hy(this,b.type),this.search(i,n),c.focus())},n,this);var b=(new yf(location)).Pc().get("pq"),c=(new yf(location)).Pc().get("type");c||(c="all");if(b&&c){var d=I("zh-profile-search-info");
d&&Q(d,j);hy(this,c);I("zh-profile-search-query").value=b;this.search(i,i,n)}}};t.sS=function(b){if((b=b.target)&&b.name)hy(this,b.name),this.search()};a.hy=function(b,c){var d=Yb("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)E.remove(d[e],"current"),d[e].name===c&&E.add(d[e],"current");b.rk=c};
t.search=function(b,c,d){this.We=I("zh-profile-search-query").value;this.Dm="/people/"+I("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.We){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.fA)return;b&&b.preventDefault();this.Em=new V(j);this.fA=j;this.h().e(this.Em,"complete",this.NJ);c&&window.history.pushState({st:encodeURIComponent(this.We),type:this.rk},"","?pq="+encodeURIComponent(this.We)+"&type="+this.rk);this.Em.ajax(this.Dm,"type="+this.rk+"&pq="+encodeURIComponent(this.We),
"","POST")}else b||(d?(this.We=I("zh-profile-search-query").value,this.Dm="/people/"+I("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.Dm+"?type="+this.rk+"&pq="+encodeURIComponent(this.We)):(this.Em=new V(j),this.fA=j,this.h().e(this.Em,"success",this.NJ),this.We=I("zh-profile-search-query").value,this.Dm="/people/"+I("zh-profile-search-form").getAttribute("data_url")+"/search",this.Em.ajax(this.Dm,"type="+this.rk+"&pq="+encodeURIComponent(this.We),"","POST")));
(b=I("zh-profile-search-info"))&&Q(b,j)}else b&&b.preventDefault()};
t.NJ=function(){this.fA=n;Ac(I("zh-profile-search-word"),this.We);var b=Le(this.Em);if(b&&!b.r){var c=I("zh-profile-search-list");if(c)if(0===b.msg[0])I("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";I("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Yb("zm-item",
c))&&b.length)this.Hi=b[b.length-1].id.split("-")[1];this.eb=k;this.eb=new vx(I(c.id),k,j);this.eb.B();this.eb.Hi=this.Hi;this.eb.url=this.Dm;this.eb.sd.pq=this.We;this.eb.sd.type=this.rk;I("zh-profile-search-query").focus()}}};a.fy=function(){T.call(this)};y(fy,T);
fy.prototype.$=function(b){this.g=b;this.Qa=new Pt;this.Qa.o(this.g);this.form=I("zm-profile-expert-editform");this.h().e(this.form,"submit",this.oz);this.h().e(this.Qa,["add","remove","sort"],function(){this.Yd()});$(".enable").on("change","input",$.proxy(function(){this.Yd()},this));var c=I("zh-profile-expert-warning");c&&this.h().e(c,"click",function(b){"close"===b.target.name&&ej(c)});$(".enable input[type='radio']").click(function(b){Q(I("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
fy.prototype.Yd=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};fy.prototype.Ge=function(){$(window).off("beforeunload.profile")};
fy.prototype.oz=function(b){b.preventDefault();z.map(this.Qa.data,function(b){return b[3]});var b=$(this.form).serializeArray()[0].value,c=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();ou("ProfileEditExpertTopicsV2","save",{settings:{enable_expert:b,expert_topic:c}},function(){this.Ge();window.location.href="/people/"+R[1]},k,this)};a.iy=function(b,c,d,e,g){gv.call(this,b,c,g);this.Kw=d||"people";this.EN=e||["zg-follow","zg-unfollow"]};y(iy,gv);iy.prototype.B=function(b){iy.n.B.call(this,b);this.Sa(this.g)};iy.prototype.wB=ca("wB");iy.prototype.Sa=function(b){if(this.wB){var c=new Vx,d=this.EN;c.Nw=this.Kw;c.Mw=d||c.Mw;this.An&&c.yp(this.An);c.o(b)}};iy.prototype.yp=ca("An");a.jy=function(){};t=jy.prototype;t.VB={"lock-question":"block","unlock-question":"unblock","mute-question":"mute","unmute-question":"unmute","remove-question":"delete","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete"};t.bx=ba();t.cx=function(b){var c=new nj(b),d=this.bx();if(!d)return Tk("OP META DATA ELEMENT DOES NOT PROVIDED");z.forEach(["question_id","task_id","answer_id","none_queue"],function(b){var g=d.getAttribute("data-"+b);g&&c.add(b,g)});return c};
a.ky=function(b,c){var d=Kw.MX[c];if(d){var e;e=[];(e=Bc(b,function(b){return 3===b.nodeType&&La(b.nodeValue)},e,j)?e[0]:i)&&Ac(e,b.getAttribute("data-label")||d.label);b.setAttribute("data-op",c)}else Tk("NO SUCH OP NAME")};t.jz=ba();t.PN=Ek(function(){var b=Kw.U();b.on("cancel",this.jz,n,this);return b});a.ly=function(b,c,d,e){var g=c.getAttribute("data-op");if(g){ky(c,g);var h=b.PN(),e=b.cx(e).add("action",b.VB[g]);h.R_(c,v(d||ha,b),"",e.toString());h.F(j)}};a.my=function(b){this.je=10;this.ad="搜索用户";this.path=b||"/people/autocomplete"};y(my,Dn);t=my.prototype;t.w=function(){var b=K("div","zg-section zm-tag-editor-command-buttons-wrap",[this.Ra=K("input","zg-form-text-input zg-mr15"),this.tI=K("span","zg-mr15"),this.GM=K("a",{"class":"zg-mr15 zg-btn-blue",href:"javascript:;",name:"add"},"移交")]);this.g.appendChild(b);this.ad&&((new Io(this.ad)).o(this.Ra),this.Ra.title=this.ad);this.vf(b);this.h().e(this.GM,"click",this.ep)};
t.vf=function(b){this.O=new Uo(this.path,this.Ra,k,k,b,j);this.O.Hf(j);this.O.ri=this.je;this.h().e(this.O,"select",this.oS)};t.ep=function(){this.iA&&this.dispatchEvent("select")};t.oS=function(){var b=this.O.fg().slice(1);this.iA=[b[3],b[0]];this.tI.innerHTML=b[0]};t.m=q("g");t.o=function(b){this.g=b;this.w()};t.hide=function(){Q(this.g,n);this.iA=k;this.tI.innerHTML=""};a.ny=function(b,c,d,e,g,h){Zr.call(this,e,c,d,h);this.oa=b;this.Co=this.nk=n;this.VS=g};y(ny,Zr);a.oy=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=ny.prototype;t.o=function(b){ny.n.o.call(this,b);this.h().e(Pi,"anon_change",this.wj)};t.wj=function(b){this.Co||E.enable(this.g,"zm-editable-disabled",b.mb)};
t.bj=function(){ny.n.bj.call(this);var b=K("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=K("select",{style:"1px solid #999 "}),d=K("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);z.forEach(oy,function(b,d){var e=K("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.Pz=K("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.I_=c,this.DG=K("span"),this.AT=
K("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.zT=K("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);mc(this.Pz,this.Cd);this.nk&&this.Ei(" * 必选","zg-gray-normal");var e=Xb("select",k,this.Pz)[0];this.h().e(e,"change",function(){Q(this.AT,"other"===e.value);this.Ei(" * 必选","zg-gray-normal")})};
t.Bf=function(b){var c=Xb("select",k,this.Pz)[0],d=c.value;if(this.nk){if("none"===d){this.Ei("请选择一个修改理由");return}if("other"===c.value&&(d=Hk(this.zT.value),!d)){this.Ei("请填写修改理由");return}}"title"===this.mr&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.Ei("还没有输入问号"):("none"===d&&(d=""),this.sd=["id="+this.oa+"&reason="+encodeURIComponent(d)+"&question_id="+this.oa],this.dispatchEvent("change"),ny.n.Bf.call(this,b),this.Ei("* 必选","zg-gray-normal"),this.nk=j)};
t.Ei=function(b,c){this.DG.innerHTML=b;E.set(this.DG,c||"zg-error-text")};t.eg=function(){return this.Hd&&this.VS?Ik(Ia(this.Ma.value)):ny.n.eg.call(this)};t.Yd=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Ge=function(){$(window).off("beforeunload.EditorWithReason")};t.xh=function(){ny.n.xh.call(this);this.Ge()};t.xd=function(){ny.n.xd.call(this);this.Yd()};a.py=function(){M.call(this);this.B_=[];this.By=0;this.jB=this.C_=k;this.FD=5;this.zP="/reviewq/handover"};y(py,Dn);ya(py.prototype,jy.prototype);t=py.prototype;t.bx=q("ea");t.cx=function(b){return jy.prototype.cx.call(this,b).add("queue_id",this.Mb).add("is_realm",this.ge)};t.jz=function(){this.locked=n};
t.B=function(b){this.g=b;this.Mb=(b=I("queue_id"))?b.value:0;this.ge=(b=I("is_realm"))?b.value:0;this.w();this.Sa();xu.zs||(b=new Md(1E3*this.FD),b.start(),this.h().e(b,Nd,this.QV));I("zh-load-more")&&(new iy(this.g,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j)).B();this.h().e(this.g,"click",this.na)};t.na=function(b){this.qx(b.target)};
t.QV=function(){var b=Yb("zm-review-queue-deadline");b&&b.length&&z.forEach(b,function(b){var d=b.getAttribute("data-lefttime");if(d)if(d=+d,2E3<d&&(d-=Math.floor(+new Date/1E3)),0>=d&&-1E3<d)b.innerHTML="已流通";else{60>d&&E.add(b,"zm-review-queue-time-warning");var e=Math.floor(d/60),g=d%60;b.setAttribute("data-lefttime",d-this.FD+"");b.innerHTML=(0<e?e+"分":"")+(g+"秒")}},this)};t.dL=function(){qy(this,["删除话题","已删除"],["delete_topic",""]);this.Vm();xu.zs||this.ea.setAttribute("data-lockdown")};
t.mx=u(51);t.tS=function(){this.qI=this.ck.iA;this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax(this.zP+"?queue_id="+this.Mb+"&is_realm="+this.ge,"action=assign&assigned_to="+this.qI[0]+"&task_id="+this.ea.getAttribute("data-task_id")+"&none_queue="+this.ea.getAttribute("data-none_queue"))};t.w=function(){this.Hj=I("zh-queue-new-info");var b=K("div",{style:"display:none"},this.hc=K("div","zu-review-queue-topic-editor",K("div","zm-tag-editor-labels")));nc(b,this.g)};
t.Sa=function(){xu.zs||this.uk()};t.uk=function(){this.xk=new V(n);P(this.h(),this.xk,"success",this.Dx);this.xk.ajax("/reviewq/sidebar?queue_id="+this.Mb,k,"GET")};t.Dx=function(){var b=Le(this.xk);if(!b||!b.r){var c=b.msg,b=Yb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e||(b.innerHTML=e))});setTimeout(v(this.uk,this),1E4)}};t.jL=function(){ry(this,this.ob,"已流通")};
a.ry=function(b,c,d){c=c||b.ob;d=d||"已处理";E.remove(c,"zg-btn-white");"pass"===c.name&&(c.innerHTML=d,xu.zs||(c.name=""));b.ea=Mc(c,"zm-item");b.Vm();(b=J("zm-review-queue-deadline",b.ea))&&Q(b,n)};t.eL=function(){qy(this,["移交","已经移交给："+this.qI[1]],["handover",""]);this.ck.hide();this.Vm();Q(this.ea,n)};a.qy=function(b,c,d){var e=0;b.ob.name===d[0]&&(e=1);b.ob.name=d[e];var d="",g=b.ob.innerHTML.indexOf("</span>");-1<g&&(d=b.ob.innerHTML.substring(0,g+7));b.ob.innerHTML=d+c[e]};
t.Vm=function(){E.remove(this.ea,"zm-item-unread");this.locked=n};
t.qx=function(b){if(this.locked)this.bG&&Tk(this.bG,"last action");else{this.locked=j;var c=b.name;this.bG=c;var d=Mc(b,"zm-item");this.ob=b;this.ea=d;if(d.getAttribute("data-lockdown"))this.locked=n;else{var e=b.getAttribute("data-op");if(e)switch(e){case "lock-question":case "unlock-question":ly(this,b,function(){ky(b,"lock-question"===e?"unlock-question":"lock-question");this.Vm()});break;case "mute-question":case "unmute-question":ly(this,b,function(){ky(b,"mute-question"===e?"unmute-question":
"mute-question");this.Vm()});break;case "remove-question":ly(this,b,function(){L(d);this.locked=n});break;case "collapse-answer":case "uncollapse-answer":ly(this,b,function(){ky(b,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");this.Vm()});break;case "remove-answer":ly(this,b,function(){L(d);this.locked=n})}else{switch(c){case "edit_title":var c=d.getAttribute("data-question_id"),g=d.getAttribute("data-task_id"),c=new ny(c,"/reviewq/question?queue_id="+this.Mb+"&action=edit_title&task_id="+
g,"title",n,j);c.rr=j;c.Hd=j;c.o(b.parentNode);c.nk=j;c.B();c.xd();this.a0=c;L(b);this.locked=n;break;case "bind_topic":this.locked=n;this.jB||(c=new Tt(this.Mb),c.o(this.hc),this.jB=c);c=this.jB;g=J("zm-review-queue-tags-wrap",d);if(!c.locked){c.locked=j;c.oa=d.getAttribute("data-question_id");var h=d.getAttribute("data-task_id");c.hC=c.FC+h+"&question_id="+c.oa+"&action=bind_topic";c.$H=c.FC+h+"&question_id="+c.oa+"&action=unbind_topic";c.Gs&&(h=J("zm-tag-editor-labels",c.Gs),Zp(c),h.innerHTML=
c.af.innerHTML,E.remove(c.Gs,"zm-review-queue-editing"));c.tD=d;c.Gs=d;E.add(c.tD,"zm-review-queue-editing");nc(c.g,g);Q(c.af,n);c.kB=new V(j);c.h().e(c.kB,"complete",c.GS);c.kB.ajax("/reviewq/fetch_topic","question_id="+c.oa)}break;case "delete_topic":this.Cb=this.dL;this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/topic?queue_id="+this.Mb+"&is_realm="+this.ge,"action=delete&topic_id="+this.ea.getAttribute("data-topicid")+"&task_id="+this.ea.getAttribute("data-task_id")+
"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "handover":this.locked=n;this.Cb=this.eL;this.ck?Q(this.ck.m(),j):(c=new my("/reviewq/auto"),g=K("div",{id:"zh-review-queue-people-selector"}),this.g.appendChild(g),c.o(g),this.ck=c,this.h().e(this.ck,"select",this.tS));c=+d.getAttribute("data-hotype");this.ck.O.ri=c;c=Lc(b,"DIV");nc(this.ck.m(),c);break;case "pass":case "unpass":this.Cb=this.jL;this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/pass",
"queue_id="+this.Mb+"&is_realm="+this.ge+"&action="+c+"&task_id="+this.ea.getAttribute("data-task_id")+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "unflag":break;case "add_question_comment":case "add_answer_comment":this.DM=c.split("_")[1];this.locked=n;(c=sy(this))?Q(c,j):(g=K("div"),g.innerHTML=I("zh-review-queue-comment-form-template").innerHTML,nc(g,J("zm-item-comment-el",this.ea)));$(".zm-command",c).show();break;case "delete_comment":this.locked=n;break;case "addnew":this.locked=
n;c=Xb("TEXTAREA",k,this.ea);c=c[c.length-1].value;if(!c)return;this.Cb=this.aL;this.Ol(c);break;case "closeform":this.locked=n;Q(sy(this),n);break;case "unbind_topic":this.Cb=this.rL;c=this.ea.getAttribute("data-question_id");g=this.ea.getAttribute("data-topicid");h=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/question?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+h,"action=unbind_topic&question_id="+c+"&topic_id="+
g+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "rebind_topic":this.Cb=this.kL;c=this.ea.getAttribute("data-question_id");g=this.ea.getAttribute("data-topicid");h=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/question?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+h,"action=bind_topic&question_id="+c+"&topic_id="+g+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "cancel_nohelp":this.Cb=
this.bL;c=this.ea.getAttribute("data-answer_id");g=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/answer?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+g,"action=cancel_nohelp&answer_id="+c+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "nohelp":this.Cb=this.iL;c=this.ea.getAttribute("data-answer_id");g=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",
this.Ce);this.xhr.ajax("/reviewq/answer?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+g,"action=nohelp&answer_id="+c+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "edit_detail":c=d.getAttribute("data-question_id");g=d.getAttribute("data-task_id");c=new ny(c,"/reviewq/question?queue_id="+this.Mb+"&action=edit_detail&task_id="+g,"detail_text",j,n);c.Ab='<div style="font-weight:bold"><a href="javascript:;" name="edit">添加补充说明</a></div>';c.rr=j;c.o(b.parentNode);c.nk=j;c.B();
c.xd();this.sZ=c;L(b);this.locked=n;break;case "voteup":case "votedown":c="voteup"===c?"vote_up":"vote_down";this.Cb=this.sL;g=this.ea.getAttribute("data-answer_id");h=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/answer?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+h,"action="+c+"&answer_id="+g+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;case "thanks":this.Cb=this.qL;c=this.ea.getAttribute("data-answer_id");
g=this.ea.getAttribute("data-task_id");this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);this.xhr.ajax("/reviewq/answer?queue_id="+this.Mb+"&is_realm="+this.ge+"&task_id="+g,"action=thanks&answer_id="+c+"&none_queue="+this.ea.getAttribute("data-none_queue"));break;default:this.locked=n}return n}}}};t.qL=function(){this.ob.name="";var b=$(this.ob),c=$("i",b);b.html(c).append("感谢已发出");ry(this,ty(this),"已流通")};
t.sL=function(){var b=Le(this.xhr),c=J("vote-bar-hook",this.ea);E.set(c,"zm-item-vote-bar");"up"===b.msg?(E.add(c,"zm-item-vote-up-active"),ry(this,ty(this),"已流通")):"down"===b.msg?E.add(c,"zm-item-vote-down-active"):(E.remove(c,"zm-item-vote-up-active"),E.remove(c,"zm-item-vote-down-active"));this.locked=n};a.ty=function(b){return J("zg-btn-white",b.ea)};
t.Ce=function(){var b=Le(this.xhr);if(b&&b.r){if("deleted"===b.msg){if(this.ea&&(E.add(this.ea,"zm-queue-disabled"),this.ea.setAttribute("data-lockdown"),b=Xb("A",k,this.ea),z.forEach(b,function(b){if("delete_question"===b.name||"delete_answer"===b.name)b.style.color="red !important",b.innerHTML="已删除"}),b=J("zm-review-queue-deadline",this.ea)))b.setAttribute("data-lefttime",-9E3),b.innerHTML=""}else U(b.msg);this.locked=n}else this.Cb()};
t.iL=function(){this.ob.name="cancel_nohelp";var b=$(this.ob),c=$("i",b);b.html(c).append("撤销没有帮助");this.locked=n;ry(this,ty(this))};t.bL=function(){this.ob.name="nohelp";var b=$(this.ob),c=$("i",b);b.html(c).append("没有帮助");this.locked=n;ry(this,ty(this))};t.kL=function(){this.ob.name="unbind_topic";this.ob.innerHTML="解除绑定";this.locked=n};t.rL=function(){this.ob.name="rebind_topic";this.ob.innerHTML="重新绑定";this.locked=n};
t.aL=function(){var b=sy(this),c=K("div","zm-comment-list");c.innerHTML='<div class="zm-comment-content">已评论</div>';nc(c,b);Mk(c);setTimeout(function(){L(c)},2500);var d=Xb("TEXTAREA",k,this.ea);d.length&&(d[d.length-1].value="");Q(b,n)};
t.Ol=function(b){this.xhr=new V(j);this.Cb&&P(this.h(),this.xhr,"success",this.Ce);var c=this.ea.getAttribute("data-question_id"),c=c?"&question_id="+c:"&question_id=0",d=this.ea.getAttribute("data-answer_id");this.xhr.ajax("/reviewq/"+this.DM,"queue_id="+this.Mb+"&is_realm="+this.ge+"&action=add_comment&task_id="+this.ea.getAttribute("data-task_id")+c+(d?"&answer_id="+d:"&answer_id=0")+"&comment="+encodeURIComponent(b)+"&none_queue="+this.ea.getAttribute("data-none_queue"))};
a.sy=function(b){return J("zm-comment-form",b.ea)};a.uy=function(b){this.VQ=this.locked=n;this.url=b||"/reviewq/image"};y(uy,Dn);ya(uy.prototype,jy.prototype);t=uy.prototype;t.bx=q("g");t.VB={"remove-question":"delete_question","collapse-answer":"collapse","uncollapse-answer":"uncollapse","remove-answer":"delete_answer","remove-image":"delete_image","remove-video":"delete_video"};t.jz=function(){this.locked=n};
t.o=function(b){this.g=b;var b=J("zm-item-rich-text",this.g),c=K("div","zm-item-answer-summary"),d=b.innerHTML.replace(/<br>/g," "),e;e=d.replace(/<p class="video-info">(.+?)<\/p>/g,"");e=e.replace(/<(\/)?b>/g,"").replace(/<(\/)?i>/g,"").replace(/<(\/)?u>/g,"");d=e.replace(/<[^>]+>/g," ").replace(/\s+/g," ");e=-1<b.innerHTML.indexOf("<img")||-1<b.innerHTML.indexOf("<IMG");var g=-1<b.innerHTML.indexOf("video-box"),h=Sk(d),l="",m=e||g;150<h?(m=j,l=d.substring(0,100)+"… "):3<b.innerHTML.split("br").length?
(m=j,l=d):l=m?d:b.innerHTML;d=g?' <span class="zg-content-video-icon"></span>':' <span class="zg-content-img-icon"></span>';if(e||g)l+=d;m&&(l+='<a href="javascript:;" class="zg-inline-block" name="expand">显示全部 »</a>');c.innerHTML=l;nc(c,b);this.Az();this.Sa()};t.Az=function(){this.QY=this.g.getAttribute("data-answer_id");this.H_=this.g.getAttribute("data-question_id");this.HQ=this.g.getAttribute("data-task_id")};t.Sa=function(){this.h().e(this.g,"click",this.Pl)};
t.Pl=function(b){if(!b.target.name||this.VQ)return j;this.na(b.target.name,b.target)};a.vy=function(b){E.has(b.g,"zm-item-unread")&&(b.locked=j,E.remove(b.g,"zm-item-unread"),Ji(b.url,v(function(){this.locked=n},b),"POST","task_id="+b.HQ));if(b=J("zm-image-queue-button-pass",b.g))b.innerHTML="已处理",E.Nh(b,"zm-image-queue-button-pass","zg-link-gray-normal zg-right")};
t.na=function(b,c){if(!this.locked){this.qZ=c;var d=j,e=c.getAttribute("data-op");if(e)switch(e){case "collapse-answer":case "uncollapse-answer":ly(this,c,function(){ky(c,"collapse-answer"===e?"uncollapse-answer":"collapse-answer");vy(this)});break;case "remove-answer":ly(this,c,function(){L(this.g);vy(this)});break;case "remove-question":ly(this,c,function(){L(this.g);vy(this)});break;case "remove-image":case "remove-video":var g=uc(c),h,d=g.getAttribute("data-imageid"),l=g.getAttribute("data-videoid");
d?h="image_hash="+d:l&&(h="video_id="+l);ly(this,c,function(){var b=Lc(g,"li");Q(b,n);this.locked=n},h)}else{switch(b){case "pass":vy(this);Q(this.g,n);break;case "expand":E.remove(this.g,"zm-item-collap");break;default:d=n}if(!d)return j}}};a.wy=function(b,c,d){M.call(this);this.b0=d;this.JK=b;this.BV=c;this.$A=n};y(wy,Dn);wy.prototype.B=function(){this.h().e(this.JK,"click",this.aO)};wy.prototype.aO=function(){this.$A=!this.$A;Q(this.BV,this.$A)};a.xy=function(){M.call(this);this.wt=0;this.Vk=[];this.By=0};y(xy,Dn);t=xy.prototype;t.Ff=function(b){var c=b.id.split("-")[1],d=new V(j),e=0,g=Mc(b,"zm-item");g&&(-1<b.innerHTML.indexOf("取消")?(Wf(g,"background","#fff"),b.innerHTML="折叠",E.Nh(b,"zg-unfollow","zg-follow"),e=0):(Wf(g,"background","#ddd"),b.innerHTML="取消折叠",E.Nh(b,"zg-follow","zg-unfollow"),e=1));d.ajax("/review/api/collapse_answer","is_collasped="+e+"&answer_id="+c)};
t.uk=function(){this.xk=new V(n);P(this.h(),this.xk,"success",this.Dx);this.xk.ajax("/reviewq/sidebar?queue_id="+this.Mb,k,"GET")};t.Dx=function(){var b=Le(this.xk);if(!b||!b.r){var c=b.msg,b=Yb("zm-review-queue-live-udatable-num");z.forEach(b,function(b){var e=b.getAttribute("data-key");e&&(e=c[e],e!=k&&(b.innerHTML=e))});setTimeout(v(this.uk,this),1E4)}};
t.B=function(){var b=I("zh-queue-wrap");if(b){var c=new iy(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j);this.h().e(b,"click",this.$G);c.B()}(b=I("zh-review-queue-online-reviewers"))&&(new iy(b,window.location.href,k,k,j)).B();if(b=I("zh-queue-content-list"))this.TU=b,this.h().e(Y,eu.cY,this.YO),b=new iy(b,window.location.href,"queue",["zg-btn-follow","zg-btn-unfollow"],j),b.yp(cy),b.B(),this.h().e(I("zh-queue-outer-wrap"),"click",this.$G);(b=I("zh-queue-content-list-v2"))&&
(new py).B(b);if(b=I("zh-image-queue-list-wrap"))this.Mb=(c=I("queue_id"))?c.value:0,this.uk(),b=Yb("zm-item",b),z.forEach(b,function(b){(new uy).o(b)});if(b=I("zh-video-queue-list-wrap"))this.Mb=(c=I("queue_id"))?c.value:0,this.uk(),b=Yb("zm-item",b),z.forEach(b,function(b){(new uy("/reviewq/video")).o(b)});if(b=I("zh-inferiority-queue-list-wrap"))this.Mb=(c=I("queue_id"))?c.value:0,this.uk(),b=Yb("zm-item",b),z.forEach(b,function(b){(new uy("/reviewq/inferiority")).o(b)});if(ph){b=ph;this.wt=b[0];
var d=[];z.forEach(b[1],function(b){d.push(b)});this.Vk=d}if(b=I("zh-queue-create-wrap"))this.Xn=b,this.h().e(this.Xn,"click",this.na),(b=I("zh-queue-delete"))&&this.h().e(b,"click",this.dN),(new wy(I("add-desc"),I("add-desc-toggle-wrap"))).B(),(new wy(I("zh-queue-add-admin"),I("zh-queue-add-admin-toggle-wrap"))).B(),this.kI=I("zh-queue-rules-wrap"),this.vV=I("zh-queue-name-input"),this.fN=I("zh-queue-desc-input"),this.zw=I("zh-queue-error-message"),this.YK=I("zh-queue-admin-selector"),this.lC=I("zh-queue-admin-members-wrap"),
this.O=new Uo("/people/autocomplete",this.YK,k,k,I("zh-queue-add-admin-toogle-wrap"),j),this.O.Hf(j),this.h().e(this.O,"select",this.ep),this.eU=I("zh-queue-rule-template").innerHTML;if(b=I("zh-queue-delete"))this.bN=b,this.h().e(b,"click",this.Ql)};t.Ql=function(){Ji("/review/queues/delete",function(){window.location.href="/review"},"POST","queue_id="+this.bN.name)};
t.ep=function(){var b=z.slice(this.O.fg(),1),c=b[3],d=1;z.forEach(this.Vk,function(b){b===c&&(d=n)});d&&this.Vk.push(c);b=['<div class="zm-item" id="adm-',b[3],'"><a class="zg-right" name="remove_admin" href="javascript:;">删除</a><a class="zm-item-link-avatar" href="/people/',b[1],'" style="float:none"><img title="',b[0],'" src="',b[2],'" class="zm-item-img-avatar" /></a></div>'].join("");this.lC.innerHTML+=b};
t.na=function(b){if((b=Qk(this.Xn,b.target))&&b.name)switch(b.name){case "remove_rule":b=Mc(b,"zg-section");L(b);break;case "zh-queue-add-rule-button":b=K("div");b.innerHTML=this.eU;this.kI.appendChild(b);break;case "add_queue":this.xhr=new V(j);P(this.h(),this.xhr,"success",this.nC);b=new Rk(j);b.add("id",this.wt);b.add("title",this.vV.value);b.add("bio",this.fN.value);var c=[],d=Xb("SELECT",k,this.kI);d&&d.length&&z.forEach(d,function(b){(b=Gx(b))&&c.push(b)});b.add("subscrible",c.join(","));b.add("maintainer",
this.Vk.join(","));this.wt?this.xhr.ajax("/review/queues/update",b.Pc()):this.xhr.ajax("/review/queues/new",b.Pc());break;case "remove_admin":var b=Mc(b,"zm-item"),e=b.id.split("-")[1];L(b);var g=[];z.forEach(this.Vk,function(b){b!==e&&g.push(b)});this.Vk=g}};t.dN=function(){this.xhr=new V(j);P(this.h(),this.xhr,"success",this.nC);this.xhr.ajax("/review/queues/delete","id="+this.wt)};
t.nC=function(){var b=Le(this.xhr);b&&!b.r?(Q(this.zw,n),b.msg&&(window.location.href=b.msg)):(b=b.msg,this.zw.innerHTML=ma(b)?b.join("<br />"):b,Q(this.zw,j))};t.YO=function(b){this.By++;300<this.By&&window.location.reload();var b=b.qb,c=K("div");c.innerHTML=b;mc(c,tc(this.TU));Mk(c)};t.$G=function(b){if((b=Qk(I("zh-queue-outer-wrap"),b.target))&&b.name)switch(b.name){case "collapse":this.Ff(b,1);break;case "uncollapse":this.Ff(b,0)}};a.yy=function(){this.wV=$("#tmpl-feedback-form").html()};ia(yy);a.zy=cj.create("Report"+R.No);yy.prototype.R={title:"建议和反馈"};yy.prototype.pv=function(b){var c=$("#zh-feedback-form"),d=$("select",c),c=$("textarea",c);new Oo(c[0]);d.toggle(!b.type);c.html(zy.get("content")||"");c.on("input change",function(){zy.$e("content",this.value)})};
yy.prototype.create=function(b){var c=$.extend(this.R,b||{});Hi(c.title,this.wV,function(b){if(b){var e=$("#zh-feedback-form"),b=$(".zg-report-msg",e),g=$("textarea",e),e=$("select",e),e=c.type||e.val(),h=$.trim(g.val());h?(b.hide(),b=new V(j),g=new nj,b.on("success",function(){U("建议发送成功，我们会尽快处理，感谢您的帮助");zy.remove("content")}),g.add("type",e).add("content",h),b.ajax("/feedback/report",g.toString()),b=i):(b.html("请填写反馈内容").show(),g.focus(),b=n);return b}},this);this.pv(c)};$(function(){$("#js-feedback-button").click(function(){yy.U().create()})});a.Ay=function(){M.call(this)};y(Ay,Dn);
Ay.prototype.B=function(){var b=I("zm-search-result-answers");b&&(b=Yb("feed-item-hook",b),z.forEach(b,function(b){jx(b).o(b)}));b=$("#zh-search3-list > .zh-general-list");if(b.length){var c=new Qu({ra:["autoload"]});c.ra("nodeSource",{VC:15>=b.children().length});c.o(b[0]);$(".search-debug-all-btn").click(function(){$("#zh-search3-list").toggleClass("debug")})}$("#zh-search-report").click(function(){yy.U().create({type:"search_suggest",title:"新搜索建议反馈"})});$("#zh-search3-list").on("click",".zm-search3-item",
function(b){b=$(b.delegateTarget).find(".zm-search3-item").index(this)+1;Qf.set("s-q",encodeURIComponent(ht(new yf(location.href),"q")));Qf.set("s-i",b);Qf.set("sid",dl())})};a.By=function(){T.call(this);this.ma=k};y(By,T);By.prototype.C=function(){By.n.C.call(this);this.h().e(this.g,"submit",function(b){b.preventDefault();this.save()})};By.prototype.save=function(){this.update(Cy(this))};By.prototype.update=function(b){if(!(this.ma&&"pending"===this.ma.state())){var c=$(this.g).data("init"),b={method:"save",params:$.extend({},c.params||{},{settings:b})};this.ma=$.post("/node/"+c.nodename,b,v(this.Bf,this))}};
By.prototype.Bf=function(b){b&&(b[0]?this.dispatchEvent({type:"success",data:b}):this.dispatchEvent({type:"error",data:b}))};a.Cy=function(b){b=$(b.g);b=b.serializeArray().concat($("input:checkbox",b).map(function(){return{name:this.name,value:this.checked?this.value:0}}).get());return z.reduce(b,function(b,d){b[d.name]=d.value;return b},{})};a.Dy=function(){T.call(this);this.EZ=[];this.F_="/profile/validate";this.KV="/settings/unblockuser"};y(Dy,T);
Dy.prototype.B=function(){var b=this,c=$("#zh-settings-noti-form-wrapper>form")[0];if(c){var d=new By;d.o(c);d.addEventListener(["success","error"],function(b){window.scrollTo(0,0);Ns(F.La(b.data),3E3)})}var e=$(".js-ajax-form");e.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Ns(F.La(b),5E3);c.hasClass("unsubscribe")&&(e.remove(),$(".settings-section").remove())});return n});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
var g=$(".feedback-form");g.submit(function(){var b=g.attr("action");$.post(b,g.serialize()).done(function(){g.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>');g.remove()});return n});$("#weibopageenable").on("change",function(b){b=$(b.target);$.post("/node/SettingsWeiboPageV2",{method:b.is(":checked")?"enable":"disable"}).done(function(b){b.r?U(b.msg):Ns([n,"保存成功"])});return n});c=$("#js-settings-account-form");if(c.length){var h=Ek(function(){new Zl(I("password"))}),
d=$("#url_token"),l=$("#js-url-preview .token");d.on("input change keyup",function(){l.text($.trim(this.value))});var m=$("#email"),p=function(){$("#js-email-confirm").show();m.off("focus",p);h()};m.one("focus",p);$(function(){document.activeElement===m.get(0)&&p()});$(".resend-mail",c).click(function(){var b=$(this);Pi.dispatchEvent("/activation/resend-email");$.post("/settings/resend_reset_email",function(c){c.r?U(c.msg):b.replaceWith("已发送")});return n});$(".zg-form-text-input",c).each(function(){function b(){this.value!==
this.defaultValue&&(d.hide(),c.off("change input keyup",b))}var c=$(this),d=c.next(".validate-error");if(d.length)c.on("change input keyup",b)});var d=new rs,r=$(".rename-tab",c);d.o(r.get(0));var w=function(){$("input[placeholder]:visible",r).placeholder()};d.on("select",w);var B=$(".rename-button",c),c=function(){B.remove();r.show();w()};B.one("click",c);"#rename-section"===location.hash&&c()}c=$("#js-form-account-password");c.length&&($("input[placeholder]",c).each(function(){new Zl(this)}),c.validate({messages:{np:{required:'<i class="icon icon-validate-error"></i>新密码未填写'},
op:{required:'<i class="icon icon-validate-error"></i>旧密码未填写'},rp:{required:'<i class="icon icon-validate-error"></i>确认密码未填写'}},errorClass:"validate-error"}));(c=I("zh-topic-block-editor"))&&(new Rt(nh)).o(c);(c=I("zh-setting-page-bind-wrap"))&&(new Ix).o(c);if(c=$(".zh-general-list").get(0))d=new Qu({ra:["autoload","nodeSource"]}),this.J(d),d.o(c),this.h().e(c,"click",this.GR);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){b.rw("SettingsPage")}).on("submit",function(){b.ew("SettingsPage")})};
Dy.prototype.rw=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};Dy.prototype.ew=function(){$(window).off("beforeunload.SettingsPage")};
Dy.prototype.GR=function(b){var c=b.target;if(c&&c.name){var d=c.id.split("-")[1];Hi("取消屏蔽","取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。",function(b){if(b){var b=Mc(c,"zm-item"),g=xa(L,b),b=new V(j);P(this.h(),b,"success",function(){g&&g();var b=Yb("zm-item",I("zh-setting-page-black-list-wrap"));(!b||!b.length)&&window.location.reload()});b.ajax(this.KV,"uid="+d)}},this)}};a.Ey=function(){M.call(this);this.ca=k;this.Mj=0;this.fK="/oauth/friends/sina";this.tK="/invitation/sina";this.Ec=new Md(200)};y(Ey,Dn);t=Ey.prototype;t.B=function(){this.Yl||(this.Yl=j,this.w(),this.Sa(),Fy(this))};t.show=function(){this.B();this.ca.F(j);var b=new Pb(this.ca.m().offsetLeft,this.ca.m().offsetTop);b.y=102;cg(this.ca.m(),b)};t.w=function(){var b=I("zh-invitation-sina-diag");b&&(this.g=b,this.ca=new Di(k,n),this.ca.lb("邀请微博好友"),mi(this.ca,k),this.ca.fa().appendChild(this.g))};
t.na=function(b){if("cancel"===b.target.name)this.ca.F(n);else if("invite"===b.target.name){var b=Yb("zm-item-checkbox-right",this.Sj),c=[];z.forEach(b,function(b){b.checked&&(c.push(b.value),b.checked="")},this);c&&c.length&&(this.Iz=new V(j),this.h().e(this.Iz,"complete",this.gL),this.Iz.ajax(this.tK,"sinaids="+c.join(",")))}};
a.Gy=function(b,c){b.Mj=c?b.Mj+1:b.Mj-1;b.NF.innerHTML=b.Mj+""},a.Fy=function(b,c){b.tG||(b.tG=j,b.xhr=new V(j),P(b.h(),b.xhr,"complete",b.Af),b.xhr.ajax(b.fK,c?"force=1":""))};t.Af=function(){this.tG=n;var b=Le(this.xhr);b&&!b.r?this.setData(b):U(b.msg)};
t.setData=function(b){this.VM=j;this.eW.innerHTML=+b[0];this.Mj=+b[1];this.NF.innerHTML=this.Mj+"";this.data=b=b[3];var c=[];z.forEach(b,function(b){c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="',b[0],'" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="',b[2],'" /><div class="zm-list-content"><strong class="zg-gray-normal">',b[1],'</strong><div class="zg-gray-normal">',b[3],"</div></div></div>"].join(""))},this);this.Sj.innerHTML=c.join("")};
t.Sa=function(){this.Nt=J("zg-form-text-input",this.g);(new Io("搜索微博好友")).o(this.Nt);this.$i=J("zm-command",this.g);this.Sj=I("zh-invitation-sina-friends-list");this.DT=I("zh-invitation-sina-force-refresh");this.h().e(this.DT,"click",function(){this.Sj.innerHTML="列表刷新中，请稍侯...";Fy(this,j)});this.h().e(this.Sj,"click",this.xR);var b=Xb("strong",k,this.g);this.eW=b[0];this.NF=b[1];this.h().e(this.Nt,"focus",this.NA).e(this.Nt,"blur",this.RA).e(this.Ec,Nd,this.CS);this.h().e(this.$i,"click",this.na)};
t.xR=function(b){var c=Mc(b.target,"zm-item");if(c){var d=k,e=Xb("input",k,c)[0];if(E.has(c,"zm-item-active"))E.remove(c,"zm-item-active"),Gy(this,j),d=n;else{var g;0>=this.Mj?(U("您的邀请码已经用完"),g=n):g=j;g?(E.add(c,"zm-item-active"),Gy(this,n),d=j):"INPUT"===b.target.tagName&&b.preventDefault()}"INPUT"!==b.target.tagName&&(e.checked=d);b.stopPropagation()}};t.NA=function(){this.Ec.start()};t.RA=function(){this.Ec.stop()};
t.CS=function(){if(this.VM){this.items||(this.items=Yb("zm-item",this.Sj));var b=this.Nt.value;b==k||""===b?z.forEach(this.items,function(b){Q(b,j)}):z.forEach(this.data,function(c,d){this.items[d]&&(b===c[0]||-1<c[1].indexOf(b)?Q(this.items[d],j):Q(this.items[d],n))},this)}};t.gL=function(){var b=Le(this.Iz);b&&!b.r?(U("邀请发送完毕"),this.ca.F(n)):U(b.msg)};a.Hy=function(){M.call(this);this.YJ="/oauth/unbind/sina"};y(Hy,Dn);Hy.prototype.B=function(){var b=I("zh-invite-send-invite-sina");b&&this.h().e(b,"click",this.OU);(b=I("zh-invitation-cancel-bind-sina"))&&this.h().e(b,"click",this.IS)};Hy.prototype.OU=function(){this.OI||(this.OI=new Ey);this.OI.show()};
Hy.prototype.IS=function(){Hi("解除绑定","你确定要解除与新浪微博的绑定吗？",function(b){if(b){var c=new V(j);P(this.h(),c,"success",function(){var b=Le(c);b&&!b.r?window.location.reload():U(b.msg)});c.ajax(this.YJ)}},this)};a.Iy=function(b,c,d,e){M.call(this);this.g=b;this.Kw=c||"people";this.DN=d||["zg-btn-follow","zg-btn-unfollow"];this.text=e||["关注","取消关注"]};y(Iy,Dn);Iy.prototype.B=function(){this.h().e(this.g,"click",this.Xo)};Iy.prototype.Xo=function(b){b=Qk(this.g,b.target);"focus"===(b&&b.name)&&tn(b,this.Kw,k,this.DN,{follow_text:this.text[0],unfollow_text:this.text[1]})};a.Jy=function(b){M.call(this);this.url=b||"/topic"};y(Jy,Dn);t=Jy.prototype;t.o=function(b){this.element=b;var c=$("<ul>");this.kJ=$("<li>");c.append(this.kJ);$(b).append(c);this.lJ||(this.lJ=j,this.lB=new V(j),P(this.h(),this.lB,"success",this.TR),this.lB.ajax(this.url,k,"POST"))};t.TR=function(){var b=Le(this.lB);b&&(b&&b.r?U(b.msg):(Ky(this,this.kJ,b.msg),this.lJ=n,this.C()))};t.C=function(){this.h().e(this.element,"click",this.Xo)};
t.Xo=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.Ko){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.Ko=j;this.Wj=new V(j);P(this.h(),this.Wj,"success",this.Bq);this.hA=b.parentNode;this.hA.innerHTML='<span class="zg-gray">加载中...</a>';this.Wj.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.Ky=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);Ky(b,h,g)}}};
t.Bq=function(){var b=Le(this.Wj);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.hA).hide();for(var c=$(this.hA.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);Ky(this,g,e)}this.Ko=n}};a.Ly=function(b,c,d){Wr.call(this,b,c,d)};y(Ly,Wr);Ly.prototype.Bf=function(b){kh[0][0]===b?this.xh():Ly.n.Bf.apply(this,arguments)};Ly.prototype.mC=function(b){if(b=Le(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.My=function(){T.call(this);var b=kh;this.Lf=b[0][3];this.pu=b[0];this.J_=b[1];this.$Z=b[2];this.i_=b[3];this.Oq=b[4];this.ky=b[5];this.nh="topic"};y(My,T);t=My.prototype;t.B=function(){Fs.J(this);this.o(document.body)};
t.C=function(){function b(b){b&&b.msg&&U(b.msg)}My.n.C.call(this);var c=I("zh-topic-side-head");if(c){var d=J("zu-entry-focus-button",c);(this.CN=d)&&this.h().e(d,"click",function(){tn(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.pg=I("zh-topic-operation-menu"))&&this.h().e(this.pg,"click",this.xA)}if(c=I("zh-current-topic-bio")){var e=new Wr(j,"/topic/bio/update","bio");e.sd=["tid="+this.Lf];e.Ab='<a href="javascript:;" name="edit">你在 '+this.pu[0]+" 话题中的经验</a>";e.rr=j;e.o(c)}(c=I("zh-topic-top-answerer"))&&
(new Iy(c,"people",["zg-follow","zg-unfollow"])).B();if(c=I("zh-topic-direct-question-list"))c=new iy(c,k,"question",k,j),c.sh("question-item"),c.B();if(c=I("zh-topic-log-list"))c=new iy(c,k,k,k,j),c.yp(cy),c.B();if(c=I("zh-topic-title"))this.Qd=new Ly(n,"/topic/update","title"),this.Qd.sd=["tid="+this.Lf],this.Qd.o(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:kh[0][3]}).done(function(c){c.r?U(c.msg):b.replaceWith(b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>')})});if(c=I("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.Mn=new Zr(j,"/topic/update","description",e),this.Mn.Ab='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.Mn.sd=["tid="+this.Lf],this.Mn.Uq=n,this.Mn.wJ=n,this.Mn.o(c);if(c=I("zh-topic-faq"))this.Fr=new Zr(j,"/topic/"+encodeURIComponent(kh[0][1])+"/faq","content",
400),this.Fr.Ab='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+kh[0][0]+"」添加常见问题</a></div>",this.Fr.d0=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.Fr.Uq=n,this.Fr.o(c);if(sh)$("div.topic-avatar").addClass("disabled");else if(c=J("zm-entry-head-avatar-edit-button")){if(R.Jg){e=
new Vl(2,kh[0][3]);e.o(c);var g=J("zm-avatar-editor-preview");N(e,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(g.parentNode)});N(e,"success",function(b){g&&(g.src=b.src);$(".avatar-edit-preview-loading").remove()})}this.h().e(c,"click",rn(ha,j))}if(c=I("zh-topic-feed-list"))e=new Qu,this.J(e),e.ra("locationSource",{Ms:0,offset:function(b){return z.Ve(b).getAttribute("data-score")}}),e.ra("childConstructor",{factory:ux}).ra("expandLimit"),
e.o(c),this.h().e(e,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category",this.nh).fill("label","topic_activity")});if(c=I("zh-topic-top-page-list"))e=new Qu({wh:n}),this.J(e),e.ra("childConstructor",{factory:ux}).ra("expandLimit"),e.o(c),this.h().e(e,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category",this.nh).fill("label","topic_activity")});var h=this;h.eb&&h.h().e(h.eb,"afterload",function(b){Y.Y({type:"ga_click_topic_more",data:b.data,target:h.eb.cc})});if(c=I("zh-topic-followers-list-wrap"))c=
new iy(c,["/topic",encodeURI(this.pu[1]),"followers"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.sh("zm-person-item"),c.B();if(I("zh-topic-organize-page-wrap")){if(c=I("zh-topic-organize-parent-editor"))e=new Bt(k,this.Lf,j),e.ct=j,e.o(c),e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()});if(c=I("zh-topic-organize-child-editor"))e=new Bt(k,this.Lf,n),e.ct=j,e.o(c),$("a.entire-link").insertAfter(e.Pn).show();$("#zm-topic-manage-relation").on("change",
'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:kh[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&U(b.msg)})});this.cv=I("zh-topic-alias-input");new Zl(this.cv,"输入话题别名");this.dv=I("zh-topic-alias-list");this.h().e(I("zh-topic-alias-container"),"click",this.FS);if(c=I("zh-topic-merge"))this.Qa=new St,this.Qa.o(c);(c=I("zh-topic-merge-btn"))&&this.h().e(c,"click",this.hS)}(c=I("zh-topic-organize-page-children"))&&
(new Jy("/topic/"+encodeURIComponent(kh[0][1])+"/organize/entire")).o(c);if(c=I("zh-topic-side-related-topics"))this.GT=c,this.Sz=new V(n),this.h().e(this.Sz,"complete",this.rS),this.Sz.ajax("/topic/related?tid="+this.Lf);I("zh-topic-admin-page-wrap")&&(c=I("zh-topic-del-btn"))&&this.h().e(c,"click",this.PR);if(c=I("zh-topic-log-list-wrap"))c=new iy(c,["/topic",encodeURI(this.pu[1]),"log"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.yp(cy),c.B();this.ay();(c=J("zm-topic-search-input-new"))&&
new Zl(c,"在话题中搜索");var l=$(c);gh.Bc||l.focus(function(){l.addClass("stretch-to")}).blur(function(){l.removeClass("stretch-to")});(c=J("zm-topic-ask-in-topic"))&&this.h().e(c,"click",this.Wt);(c=J("zm-topic-feed-container"))&&(new Iy(c,"question",["zg-follow","zg-unfollow"])).B();(c=I("zh-topic-side-children-list"))&&(new Iy(c,"topic",["zg-follow","zg-unfollow"])).B();(this.ps=I("zh-topic-info-add"))&&this.h().e(this.ps,"submit",this.cS);(this.BF=J("zm-topic-info-content-main",this.g))&&this.h().e(this.BF,
"click",this.aS);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+kh[0][1]+"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:kh[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:kh[0][1],lock_type:this.name,
lock_value:$(this).is(":checked")?1:0}).done(b)});(c=I("zh-topic-info-add"))&&z.forEach(rc(c),function(b){var c;b&&(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new Zl(b,c)});$(".js-may-disable").click(rn(ha,j))};
t.hS=function(){this.kr=this.Qa.zD;if(!this.CG&&this.kr){this.CG=j;this.Py=new V(j);P(this.h(),this.Py,"success",this.hL);this.Py.ajax("/topic/"+encodeURIComponent(kh[0][1])+"/demand","action=merge&target_topic_id="+this.kr[3]);var b=I("zh-topic-merged-msg");Q(I("zh-topic-merge"),n);Q(b,j);b=Xb("a",k,b)[0];b.href="/topic/"+this.kr[1];b.innerHTML=this.kr[0];this.Qa&&(this.Qa.Ra.value="")}};t.hL=function(){var b=Le(this.Py);b&&b.r?U(b.msg):this.CG=n};
t.PR=function(){this.JD||(this.JD=j,this.aw=new V(j),P(this.h(),this.aw,"success",this.cL),this.aw.ajax("/topic/"+encodeURIComponent(kh[0][1])+"/demand","action=remove"))};t.cL=function(){var b=Le(this.aw);b&&b.r?U(b.msg):(b=I("zh-topic-del-msg"),Q(I("zh-topic-del-btn"),n),Q(b,j),this.Qa&&(this.Qa.Ra.value=""),this.JD=n)};
t.FS=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.cv.value)this.ev=new V(j),P(this.h(),this.ev,"complete",this.$K),this.ev.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.Tz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.h(),this.Tz,"complete",this.mL),this.Tz.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.Vz=new V(j),b=b.parentNode.getAttribute("data-token"),P(this.h(),
this.Vz,"complete",this.nL),this.Vz.ajax("/topic/"+encodeURIComponent(kh[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.nL=function(){var b=Le(this.Vz);b&&b.r?U(b.msg):Ny(this,b.msg)};t.mL=function(){var b=Le(this.Tz);b&&b.r?U(b.msg):Ny(this,b.msg)};a.Ny=function(b,c){var d=Xb("li",k,b.dv);z.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&Q(b,n)})};
t.$K=function(){var b=Le(this.ev);if(b&&b.r)U(b.msg);else{var b=b.msg,c=K("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.dv.appendChild(c);this.cv.value="";Q(this.dv.parentNode,j)}};t.xA=function(b){this.tz?this.jb.V()?this.jb.F(n):(this.jb.F(j),b.stopPropagation(),b.preventDefault(),this.$k()):(b.stopPropagation(),b.preventDefault(),this.Jj(),this.$k());this.tz=j};t.$k=function(){P(this.h(),document,"click",function(){this.jb.F(n)})};
t.Jj=function(){var b=I("zh-topic-side-head"),c=this.pg.getAttribute("data-auth");this.jb=new fv;this.Jx=j;"f-topic-manage"===c&&this.jb.Ha(this.MS=new cv("管理话题"));this.jb.Ha(this.NS=new cv("组织话题"));this.jb.Ha(this.LS=new cv("话题日志"));this.Jx&&(this.jb.aa(b),this.h().e(this.jb,"action",this.zj))};t.zj=function(b){var c="";b.target===this.MS?c="admin":b.target===this.NS?c="organize":b.target===this.LS&&(c="log");window.location.href=["/topic",this.pu[1],c].join("/")};
t.rS=function(){var b=Le(this.Sz);if(b&&!b.r){var c=[];z.forEach(b,function(b){c.push(Gk(b,k,j))});this.GT.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&Q(I("zh-topic-side-related-topics-wrap"),j)}};t.ay=function(){var b=I("zh-topic-search-list");b&&(this.eb=new vx(b,k,j),this.eb.sh("zm-search-result-item"),this.eb.et=function(b){if(b&&0!==b.length)return b[b.length-1].getAttribute("data-offset")},this.eb.B())};
t.aS=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.SP=c,this.CF||(this.CF=j,this.Ux=new V(j),this.h().e(this.Ux,"success",this.bS),b="token="+this.SP.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.Ux.ajax("/topic/"+kh[0][1]+"/information/manage",b,"POST")))};t.bS=function(){this.CF=n;var b=Le(this.Ux);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.g).innerHTML=$(b).html()))};
t.cS=function(b){b.preventDefault();this.DF||(this.DF=j,this.Wx=new V(j),this.h().e(this.Wx,"success",this.$R),b=rc(this.ps),this.Wx.ajax("/topic/"+kh[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.$R=function(){this.DF=n;var b=Le(this.Wx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,J("zm-topic-info-content-main",this.g).innerHTML=$(b).html(),b=rc(this.ps),z.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.Wt=rn(function(){if(!As()){var b=bs.U();b.show();var c=J("zm-topic-search-input-new");c.value&&es(b,c.value);b.Qa.data.length||b.Qa.tk(kh[0])}},j);a.Oy=function(b){T.call(this,b)};y(Oy,T);Oy.prototype.w=function(){this.g=this.L().w("FORM",{method:"POST",style:"display:none"})};Oy.prototype.post=function(b,c,d){var e=this.m();e||(this.aa(),e=this.m());e.action=c||"";e.target=d||"";var c=e,g,h=new $s;for(g in b)d=b[g],na(d)?z.forEach(d,v(this.vC,this,h,g)):this.vC(h,g,d);c.innerHTML=h.toString();e.submit()};Oy.prototype.vC=function(b,c,d){b.append('<input type="hidden" name="',Wa(c),'" value="',Wa(d),'">')};a.Py=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"day"})})},a.Qy=function(b){return $.get("/node/ExploreHotFavlistsInnerV2",{params:JSON.stringify({offset:b})})},a.Ry=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"month"})})};a.Sy=function(){M.call(this)};y(Sy,Dn);Sy.prototype.B=function(){var b=ht(new yf(window.location.href),"group_id");b&&(this.Zj=new V(n),P(this.h(),this.Zj,"success",this.Bz),b&&this.Zj.ajax("/noti7/read","group_id="+b,"POST"))};Sy.prototype.Bz=function(){var b=Le(this.Zj);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.tR=b.msg;this.dispatchEvent("change")}(b=$n)&&ao(b)};a.Ty=function(){T.call(this);var b=mh||[0,0];this.Ls=b[0];this.visible=!!b[1];this.nh="collection"};y(Ty,T);t=Ty.prototype;t.B=function(){Fs.J(this);this.o(document.body)};
t.C=function(){Ty.n.C.call(this);var b=I("zh-list-side-head");if(b){var c=J("zu-entry-focus-button",b);(this.CN=c)&&this.h().e(c,"click",function(){tn(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.pg=I("zh-list-operation-menu"))&&this.h().e(this.pg,"click",this.xA)}(b=I("zh-single-answer-author-info"))&&(new Iy(b)).B();(b=I("zh-list-create-new-list"))&&this.h().e(b,"click",this.GU);(b=I("zh-fav-list-side-bar-creator"))&&(new Iy(b)).B();(b=I("zh-fav-list-side-bar-report"))&&this.h().e(b,
"click",this.km);(this.Jk=I("zh-favlist-webshare-container"))&&this.h().e(this.Jk,"click",this.AA);if(this.nc=I("zh-list-meta-wrap"))this.h().e(this.nc,"click",this.km),this.eZ=I("zh-list-comment-num"),ht(new yf(location.href),"fc")&&Uy(this);(b=I("zh-favlists-wrap"))&&(new iy(b,k,"favlist",k,j)).B();if(b=I("zh-list-answer-wrap")){$(b).on("click","a[name=unfavo]",$.proxy(this.uP,this));var d=new Qu({wh:n});this.J(d);d.ra("childConstructor",{dj:px}).ra("expandLimit");d.o(b);this.h().e(d,"click!",function(b){"comment"===
b.namespace&&b.Gc.fill("category",this.nh).fill("label","collection_answer")})}(b=I("zh-favlist-log-list-wrap"))&&(new iy(b,k,"favlist",k,j)).B();(b=I("zh-favlist-following-wrap"))&&(new iy(b,k,"favlist",k,j)).B();if(b=I("zh-favlist-followers-wrap"))b=new iy(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.sh("zm-profile-section-item"),b.wB(j),b.B();this.h().e(window,"hashchange",this.A_);this.$x();this.To=new Sy;this.To.B()};
t.uP=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Lc(b,"div","zm-item"))b=Yb("zm-item-answer",c),1===b.length?L(c):(b=z.find(b,function(b){return b.getAttribute("data-aid")===d}))&&L(b.parentNode)};t.AA=function(b){var b=Qk(this.Jk,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);b&&(b.name&&c)&&new zv(["分享收藏夹","collection",c[1],{fid:mh[0]}],"tb-webshare-"+b.name)};t.GU=rn(function(){yx().show()},j);
t.xA=function(b){this.tz?this.jb.V()?this.jb.F(n):(this.jb.F(j),b.stopPropagation(),b.preventDefault(),this.$k()):(b.stopPropagation(),b.preventDefault(),this.Jj(),this.$k());this.tz=j};t.$k=function(){P(this.h(),document,"click",function(){this.jb.F(n)})};t.Jj=function(){var b=I("zh-list-side-head");this.jb=new fv;this.Jx=j;this.visible||this.jb.Ha(this.PS=new cv("设置为公开"));this.jb.Ha(this.KS=new cv("删除此收藏夹"));this.Jx&&(this.jb.aa(b),this.h().e(this.jb,"action",this.zj))};
t.km=function(b){b=b.target;switch(b&&b.name){case "report-favlist":Tu("favlist",this.Ls);break;case "edit":Ex(yx());break;case "addcomment":Uy(this);this.va.yg();this.va.Ac()&&this.va.Ji("view_comments",parseInt(Ic(b),10)||0);break;case "remove":Vy(this)}};
t.zj=function(b){b.target===this.PS?Hi("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.p_=!this.visible,this.tJ=new V(j),this.h().e(this.tJ,"complete",function(){window.location.reload()}),this.tJ.ajax("/collection/update","favlist_id="+this.Ls+"&is_public=1"))},this):b.target===this.KS&&Vy(this)};a.Vy=function(b){Hi("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Rk,b.add("favlist_id",this.Ls),b.add("_xsrf",(new Nf(document)).get("_xsrf")),(new Oy).post(ft(b),"/collection/delete"))},b)};
t.$x=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=Qy(b).done(function(b){c.html(b)}))})};a.Uy=function(b){b.va||(b.va=new Ww(b.Ls,"favlist"),b.J(b.va),b.h().e(b.va,"click!",function(b){"comment"===b.namespace&&(b.Gc.fill("category",this.nh).fill("label","collection"),b.Gc.action=b.Gc.action.replace("favlist","collection"))}),$w(b.va,b.nc,$(".toggle-comment",b.nc)[0]))};a.Wy=function(b,c,d){gv.call(this,b,c,d)};y(Wy,gv);Wy.prototype.Af=function(b){b&&!b.r&&(b=b.msg,b.length?(Q(this.cc,0<b.length),this.offset+=b.length,this.kv(b),jv(this,n),mv(this)):this.Pk.hide())};a.Xy={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
Wy.prototype.tP=function(b){var c=b.currentTarget.g.getAttribute("data-feedtype"),c=Xy[c];"comment"===b.namespace&&c&&b.Gc.fill("category","feed").fill("label",c)};Wy.prototype.ak=function(b){var c=ux(b);this.J(c);this.h().e(c,"click!",this.tP);c.o(b);return c};Wy.prototype.JH=function(b){return{params:b,method:"next"}};Wy.prototype.z=function(){Wy.n.z.call(this)};a.Yy=function(){this.interval=3E4};ia(Yy);a.$y=function(b,c){if(!b.Ec||c)c&&clearInterval(b.Ec),b.Ec=setInterval(v(function(){Zy(this)},b),b.interval)},a.Zy=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(hu($(this).data("timestamp")))});c&&$y(b,c)};a.az=function(){T.call(this);this.ny={};this.bt=[];this.uQ="old"===$("#feed-ver").val()?j:n;this.YF=0<$("#is-topstory").length?j:n;this.hE=this.uQ?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.YF?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",n,3])};y(az,T);t=az.prototype;
t.C=function(){az.n.C.call(this);this.M=$(this.g);if(this.rf=I("zh-main-feed-fresh-button"))this.EB=$(this.rf),this.YF?(this.h().e(this.rf,"click",this.ET),this.h().e(Y,"topstory",this.sP)):(this.h().e(this.rf,"click",this.LU),this.h().e(Y,"homefeed",this.XO));this.eb=new Wy(this.g,k,j);this.getParent()&&this.getParent().J(this.eb);var b="/node/"+$(this.g).data("init").nodename;this.eb.url=b;this.eb.sh("feed-item-hook");this.h().e(this.eb,"itemcreated",function(b){bz(this,b.data.IQ)}).e(this.eb,"afterload",
function(b){Y.Y({type:"ga_click_feed_more",data:b.data})}).e(this.eb,"ignore",function(b){var c=b.key,g=b.value;F.forEach(this.ny,function(b){b.Br[c]===g&&$(b.g).fadeOut(150)})});this.eb.B();this.M.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});var c=this;this.M.on("click",".js-change-some",function(){Uk("feed","intrests-change");var b=$(this),e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&
g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.eb.ak(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};t.ET=function(){this.EB.text("加载中…");this.Sm=0;var b=this;this.eb.offset=0;this.eb.Hi=0;lv(this.eb,j,function(){Th(b.eb,function(b){$(b.m()).remove()})}).done(function(){b.EB.hide();iv(b.eb)})};
t.LU=function(){var b=J("zm-home-question-list-devider",this.g);b&&E.remove(b,"zm-home-question-list-devider");var b=this.bt.length,c=$("."+this.hE,this.g)[0];c&&5<=b&&($(".feed-separator-hook",this.g).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));z.forEach(this.bt,function(b){var c=$("."+this.hE,this.g)[0];c?mc(b,c):this.g.appendChild(b)},
this);this.bt=[];Q(this.rf,n);c=Yy.U();Zy(c,j);Y.Y({type:"ga_click_feed_fresh",data:{count:b}})};
t.XO=function(b){var c=La(b.qb),b=this.bt,d=b.length;if(c&&!(500<d)){var e=ic(c),c=this.ny;if(!F.Jr(c,function(b){return b.m().id===e.id})){var g=this.eb.ak(e);if(g.ta){if(F.Jr(c,function(b){return b.ta===g.ta}))return}else if(g.oa){if(F.Jr(c,function(b){return b.oa===g.oa}))return}else if(g.wc&&F.Jr(c,function(b){return b.wc===g.wc}))return;bz(this,g);b.push(e);d+=1;this.rf&&(this.rf.innerHTML=(99<d?"99+":d)+" 条新动态",Q(this.rf,j))}}};
t.sP=function(b){this.Sm=this.Sm||0;this.Sm+=+b.qb;this.rf&&(this.rf.innerHTML=(99<this.Sm?"99+":this.Sm)+" 条新动态",Q(this.rf,j))};a.bz=function(b,c){var d=Nh(Mh.U());b.ny[d]=c;$(c.g).attr("data-fid",d)};a.cz=function(){};y(cz,T);t=cz.prototype;t.C=function(){cz.n.C.call(this);var b=I("zh-invite-select");b&&this.h().e(b,"change",this.mz);(b=J("zm-invite-list"))&&this.h().e(b,"click",this.na);(this.Ox=I("zh-invite-ignore-all-btn"))&&this.h().e(this.Ox,"click",this.OP)};
t.na=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.SZ=b;this.TZ=j;E.add(b,"zg-btn-disabled");this.PP=new V(n);var c="qid="+b.getAttribute("data-qid")+"&uid="+R[3]+"&op=pass";this.PP.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&ej(c,j)}"recover"===b.name&&!this.VH&&(this.TH=b,this.VH=j,E.add(b,"zg-btn-disabled"),b.innerHTML="...",this.UH=new V(n),this.h().e(this.UH,"success",this.lL),b="qid="+b.getAttribute("data-qid")+"&uid="+R[3]+"&op=recover",this.UH.ajax("/question/askpeople",
b,"POST"))}};t.mz=function(b){var c=ht(new yf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.lL=function(){this.VH=n;this.dc(this.TH,"ignore");this.TH.name="ignore"};
t.dc=function(b,c){var d=b.parentNode,e=J("zm-invite-item-info-label",d);"ignore"===c?(E.remove(b,"zg-btn-disabled"),E.remove(b,"recover"),E.add(b,"ignore"),E.add(d,"invite"),E.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(E.remove(b,"zg-btn-disabled"),E.remove(b,"ignore"),E.add(b,"recover"),E.remove(d,"invite"),E.remove(d,"draft"),E.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.OP=function(){this.Px||(this.Px=j,this.wF=new V(n),this.h().e(this.wF,"success",this.fL),this.wF.ajax("/question/askpeople","uid="+R[3]+"&op=ignore_all","POST"))};t.fL=function(){this.Px=n;Q(this.Ox);this.Px=n;z.forEach(Yb("zm-invite-item-control"),v(function(b){this.dc(b,"recover")},this))};a.dz=function(){T.call(this)};y(dz,T);dz.prototype.C=function(){dz.n.C.call(this);this.Il();this.h().e(this.g,"click",this.na)};dz.prototype.na=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
dz.prototype.Il=function(){this.Ko||(this.Ko=j,this.Wj=new V(n),this.h().e(this.Wj,"success",this.iz),this.Wj.ajax("/noti7/calendar","","GET"))};dz.prototype.iz=function(){this.Ko=n;var b=Ke(this.Wj);if(b){var c=I("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new gv(c,"/noti7/calendar",j),b.kv=function(b){var c=K("div","zm-item-more-wrap");c.innerHTML=b;mc(c,this.cc)},b.as=function(b){this.Hi=this.cc.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.B())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.ez=function(){M.call(this);this.Mx=[];this.ED=[]};y(ez,Dn);ez.prototype.B=function(){var b=I("home-suggest-block");b&&(this.g=b,b=I("home-suggest-close-button"),P(this.h(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");Q(this.g,n)}),b=I("home-suggest-refresh-button"),this.h().e(b,"click",this.qS),this.Qs=I("home-suggest-list"),fz(this))};ez.prototype.qS=function(){gz(this);return j};
a.gz=function(b){for(var c=[],d=0;3>d;d++){var e=b.ED.shift();e&&c.push(e)}3===c.length?(b.Qs.innerHTML=c.join(""),c=Yb("suggest-item",b.Qs),z.forEach(c,function(b){this.Mx.push(b.id.split("-")[1])},b)):fz(b)},a.fz=function(b){b.Qs.innerHTML='<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.Mx.join(",")}).done(v(b.NR,b))};
ez.prototype.NR=function(b){b.r||((b=b.msg)&&ma(b)&&b.length?(this.Mx=[],this.ED=b,gz(this)):this.Qs.innerHTML="下面没有了")};a.hz=function(){T.call(this)};y(hz,T);hz.prototype.B=function(){Fs.J(this);this.o(document.body)};
hz.prototype.C=function(){hz.n.C.call(this);var b=I("js-home-feed-list");if(b){var c=new az;this.J(c);c.o(b)}(b=J("zm-invite-container"))&&(new cz).o(b);I("home-settings-page-wrap")&&(b=I("zh-topic-block-editor"))&&(new Rt(nh)).o(b);(b=I("zh-noti7"))&&(new dz).o(b);if(b=I("zh-plazza-topic-search-wrap"))c=I("zh-plazza-topic-search-input"),(new Io("搜索话题")).o(c),this.O=new Uo("/topic-reg/autocomplete",c,k,k,b,n),this.O.Hf(j),this.h().e(this.O,"select",function(){var b=z.slice(this.O.fg(),1);window.location.href=
"/topic/"+b[1]});if(c=I("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new Hp(c,I("zm-home-sidebar-domain-entry-nav"),b),b&&Ad(c,"toggle",function(){Ji("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new Qu,this.J(c),c.ra("nodeSource").ra("childConstructor",
{dj:px}),c.o(b),this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category","debuts").fill("label","debuts")});(new ez).B();var b=R[1],d=I("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(Q(d,j),Qf.set("reg_noti_",b,86400)):b===Qf.get("reg_noti_")&&Q(d,j),N(J("x-m",d),"click",function(){location.hash="";L(d);Qf.remove("reg_noti_")}));var e=$("#js-global-notify");if(e.length){var g=new Ar;g.o(e[0]);bt(g);$(".zu-global-notify-close",e).click(function(){var b=$(this).data("id");
$.post("/notice/read",{nid:b});g.H();e.remove()})}b=Yy.U();$y(b);var h=$("#js-debuts-entry .tour");h.length&&$(".close-button",h).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});h.fadeOut(100,function(){h.remove()})})};a.iz=function(){ai.call(this,k,n);this.MC="zh-lightbox-showing";this.rV="zh-lightbox-thumb";this.bh()};y(iz,ai);ia(iz);t=iz.prototype;t.bh=function(){this.h().e(document,"click",this.Tr)};
t.Tr=function(b){b=b.target;if("IMG"===b.tagName&&E.has(b,this.rV)){var c=b.getAttribute("data-original");if(c)if(ub)window.open(c);else if(!Mc(b,"editable")){this.Na('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.F(j);E.add(this.m(),"zm-light-box-fullscreen-image");var c=
ac(),d=I("zm-light-box-x1"),e=I("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";Y.Y({type:"ga_click_enlarge_image",target:b})}}};t.pa=ha;t.focus=ha;t.IO=function(){this.F(n);E.remove(document.body,this.MC)};t.xi=function(){iz.n.xi.call(this);E.add(document.body,this.MC);P(this.h(),document,"click",this.IO)};
t.w=function(){iz.n.w.call(this);E.add(this.m(),"zm-light-box")};t.Hy=function(){this.Xc=this.L().w("div",this.Lc+"-bg zm-light-box-background");Q(this.Xc,n)};iz.U();a.jz=function(b,c,d){cv.call(this,b,c,d);this.Gi(j)};y(jz,cv);jz.prototype.ke=function(){return this.dispatchEvent("action")};mp("goog-option",function(){return new jz(k)});a.kz=function(){};y(kz,Kp);ia(kz);kz.prototype.w=function(b){return b.L().w("div",this.P()+" goog-inline-block"," ")};kz.prototype.o=function(b,c){c=kz.n.o.call(this,b,c);E.add(c,"goog-inline-block");return c};kz.prototype.P=s("goog-toolbar-separator");a.lz=function(){};y(lz,Mp);ia(lz);lz.prototype.xc=function(){return Zc.IK};lz.prototype.ao=function(b){return"HR"==b.tagName?new Lp(kz.U()):lz.n.ao.call(this,b)};lz.prototype.P=s("goog-toolbar");lz.prototype.Vw=function(){return Op};a.mz=function(){};y(mz,kp);ia(mz);t=mz.prototype;t.w=function(b){var c={"class":"goog-inline-block "+this.sf(b).join(" "),title:b.gg()||""},c=b.L().w("div",c,this.aj(b.ib(),b.L()));hp(this,b,c);return c};t.xc=function(){return Zc.sq};t.fa=function(b){return b&&b.firstChild.firstChild};t.aj=function(b,c){return c.w("div","goog-inline-block "+(this.P()+"-outer-box"),c.w("div","goog-inline-block "+(this.P()+"-inner-box"),b))};t.Kc=function(b){return"DIV"==b.tagName};
t.o=function(b,c){nz(c,j);nz(c,n);var d;a:{d=b.L().CE(c);var e=this.P()+"-outer-box";if(d&&E.has(d,e)&&(d=b.L().CE(d),e=this.P()+"-inner-box",d&&E.has(d,e))){d=j;break a}d=n}d||c.appendChild(this.aj(c.childNodes,b.L()));E.add(c,"goog-inline-block",this.P());return mz.n.o.call(this,b,c)};t.P=s("goog-custom-button");
a.nz=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==La(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Ma(g);break}}else break;d=e}};a.oz=function(){};y(oz,mz);ia(oz);oz.prototype.P=s("goog-toolbar-button");a.pz=function(b,c,d){vp.call(this,b,c||oz.U(),d)};y(pz,vp);mp("goog-toolbar-button",function(){return new pz(k)});a.qz=function(){};y(qz,mz);ia(qz);C&&(qz.prototype.Na=function(b,c){var d=qz.n.fa.call(this,b&&b.firstChild);d&&pc(this.createCaption(c,Vb(b)),d)});t=qz.prototype;t.fa=function(b){b=qz.n.fa.call(this,b&&b.firstChild);C&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.o=function(b,c){var d=Xb("*","goog-menu",c)[0];if(d){Q(d,n);Ub(d).body.appendChild(d);var e=new fv;e.o(d);b.th(e)}return qz.n.o.call(this,b,c)};
t.aj=function(b,c){return qz.n.aj.call(this,[this.createCaption(b,c),c.w("div","goog-inline-block "+(this.P()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return rz(b,this.P(),c)};a.rz=function(b,c,d){return d.w("div","goog-inline-block "+(c+"-caption"),b)};t.P=s("goog-menu-button");a.sz=function(){};y(sz,qz);ia(sz);sz.prototype.createCaption=function(b,c){return sz.n.createCaption.call(this,tz(b,c),c)};a.tz=function(b,c){return c.w("div","goog-color-menu-button-indicator",b)};sz.prototype.Ea=function(b,c){b&&uz(this.fa(b),c)};a.uz=function(b,c){if(b&&b.firstChild){var d;d=c&&(st.test("#"==c.charAt(0)?c:"#"+c)||Ft(c).length||Ht&&Ht[c.toLowerCase()])?tu(c).bs:k;b.firstChild.style.borderBottomColor=d||(A?"":"transparent")}};
sz.prototype.Pe=function(b){this.Ea(b.m(),b.X());E.add(b.m(),"goog-color-menu-button");sz.n.Pe.call(this,b)};a.vz=function(){};y(vz,fp);ia(vz);a.wz=0;t=vz.prototype;t.w=function(b){var c=this.sf(b);return b.L().w("div",c?c.join(" "):k,xz(this,b.ib(),b.Ll(),b.L()))};a.xz=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var m=[],p=0;p<d.width;p++){var r=c&&c[l++];m.push(yz(b,r,e))}g.push(e.w("tr",b.P()+"-row",m))}return b.Qv(g,e)};t.Qv=function(b,c){var d=c.w("table",this.P()+"-table",c.w("tbody",this.P()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Qc(d,"grid");return d};
a.yz=function(b,c,d){b=d.w("td",{"class":b.P()+"-cell",id:b.P()+"-cell-"+wz++},c);Qc(b,"gridcell");return b};t.Kc=s(n);t.o=s(k);
t.Na=function(b,c){if(b){var d=Xb("tbody",this.P()+"-body",b)[0];if(d){var e=0;z.forEach(d.rows,function(b){z.forEach(b.cells,function(b){lc(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Vb(b),l=d.rows[0].cells.length;e<c.length;){var m=c[e++];g.push(yz(this,m,h));g.length==l&&(m=h.w("tr",this.P()+"-row",g),d.appendChild(m),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(yz(this,"",h));m=h.w("tr",this.P()+"-row",g);d.appendChild(m)}}}wg(b,j,C)}};
a.zz=function(b,c,d){for(c=c.m();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&E.has(d,b.P()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.Az=function(b,c,d,e){d&&(d=d.parentNode,E.enable(d,b.P()+"-cell-hover",e),Rc(c.m().firstChild,"activedescendent",d.id))};t.P=s("goog-palette");a.Cz=function(b){M.call(this);this.Nd=[];Bz(this,b)};y(Cz,Kd);t=Cz.prototype;t.wg=k;t.Ef=k;t.Hl=function(){return this.Nd.length};t.ii=function(b){return this.Nd[b]||k};a.Bz=function(b,c){c&&(z.forEach(c,function(b){this.Fm(b,n)},b),z.extend(b.Nd,c))};t.Ha=function(b){this.Si(b,this.Hl())};t.Si=function(b,c){b&&(this.Fm(b,n),z.wo(this.Nd,b,c))};t.removeItem=function(b){b&&z.remove(this.Nd,b)&&b==this.wg&&(this.wg=k,this.dispatchEvent("select"))};t.Yg=q("wg");t.Pb=function(){return z.clone(this.Nd)};
t.Gf=function(b){b!=this.wg&&(this.Fm(this.wg,n),this.wg=b,this.Fm(b,j));this.dispatchEvent("select")};t.Kl=function(){return this.wg?z.indexOf(this.Nd,this.wg):-1};t.Gp=function(b){this.Gf(this.ii(b))};t.clear=function(){z.clear(this.Nd);this.wg=k};t.z=function(){Cz.n.z.call(this);delete this.Nd;this.wg=k};t.Fm=function(b,c){b&&("function"==typeof this.Ef?this.Ef(b,c):"function"==typeof b.Jm&&b.Jm(c))};a.Dz=function(b,c,d){op.call(this,b,c||vz.U(),d);this.Vi&=-89};y(Dz,op);t=Dz.prototype;t.pc=k;t.Ib=-1;t.qa=k;t.z=function(){Dz.n.z.call(this);this.qa&&(this.qa.H(),this.qa=k);this.pc=k};t.Hm=function(b){Dz.n.Hm.call(this,b);Ez(this);this.qa?(this.qa.clear(),Bz(this.qa,b)):(this.qa=new Cz(b),b=v(this.Fm,this),this.qa.Ef=b,this.h().e(this.qa,"select",this.Aj));this.Ib=-1};t.Wg=s("");t.Gm=ba();
t.nd=function(b){Dz.n.nd.call(this,b);var c=zz(this.N,this,b.target);(!c||!b.relatedTarget||!vc(c,b.relatedTarget))&&c!=Fz(this)&&Gz(this,c)};t.ki=function(b){Dz.n.ki.call(this,b);var c=zz(this.N,this,b.target);(!c||!b.relatedTarget||!vc(c,b.relatedTarget))&&c==Fz(this)&&Az(this.N,this,c,n)};t.Me=function(b){Dz.n.Me.call(this,b);this.bc()&&(b=zz(this.N,this,b.target),b!=Fz(this)&&Gz(this,b))};t.ke=function(b){var c=Fz(this);return c?(this.Gf(c),Dz.n.ke.call(this,b)):n};
t.$b=function(b){var c=this.ib(),c=c?c.length:0,d=this.pc.width;if(0==c||!this.isEnabled())return n;if(13==b.keyCode||32==b.keyCode)return this.ke(b);if(36==b.keyCode)return this.Tb(0),j;if(35==b.keyCode)return this.Tb(c-1),j;var e=0>this.Ib?this.Kl():this.Ib;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Tb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Tb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Tb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Tb(e+d),b.preventDefault(),j}return n};t.Aj=ba();t.Ll=q("pc");a.Hz=function(b,c){b.m()&&f(Error("Component already rendered"));b.pc=pa(c)?new Rb(c,i):c;Ez(b)},a.Fz=function(b){var c=b.ib();return c&&c[b.Ib]};t.Tb=function(b){b!=this.Ib&&(Iz(this,this.Ib,n),this.Ib=b,Iz(this,b,j))};a.Gz=function(b,c){var d=b.ib();b.Tb(d?z.indexOf(d,c):-1)};t.Kl=function(){return this.qa?this.qa.Kl():-1};t.Yg=function(){return this.qa?this.qa.Yg():k};t.Gp=function(b){this.qa&&this.qa.Gp(b)};
t.Gf=function(b){this.qa&&this.qa.Gf(b)};a.Iz=function(b,c,d){if(b.m()){var e=b.ib();e&&(0<=c&&c<e.length)&&Az(b.N,b,e[c],d)}};t.Fm=function(b,c){this.m()&&b&&E.enable(b.parentNode,this.N.P()+"-cell-selected",c)};a.Ez=function(b){var c=b.ib();if(c)if(b.pc&&b.pc.width){if(c=Math.ceil(c.length/b.pc.width),!pa(b.pc.height)||b.pc.height<c)b.pc.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.pc=new Rb(c,c);else b.pc=new Rb(0,0)};a.Jz=function(b,c,d){this.br=b||[];Dz.call(this,k,c||vz.U(),d);this.br=this.br;this.dt=k;this.Na(z.map(this.br,function(b){var c=this.L().w("div",{"class":this.N.P()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=Gt(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};y(Jz,Dz);Jz.prototype.dt=k;Jz.prototype.gx=function(){var b=this.Yg();return b?(b=Au(b,"background-color"),Kz(b)):k};
Jz.prototype.Fp=function(b){b=Kz(b);this.dt||(this.dt=z.map(this.br,function(b){return Kz(b)}));this.Gp(b?z.indexOf(this.dt,b):-1)};a.Kz=function(b){if(b)try{return tu(b).bs}catch(c){}return k};a.Lz=function(b,c,d,e){cu.call(this,b,c,d||e);if(d||e)this.Im(65|(e?32:132))};y(Lz,cu);a.Mz=function(b,c,d,e){vp.call(this,b,d||qz.U(),e);rp(this,64,j);this.em=new Lz(k,5);c&&this.th(c);this.Oy=k;this.sa=new Md(500);if((Pg||Qg)&&!Gb("533.17.9"))this.Bs=j};y(Mz,vp);t=Mz.prototype;t.Bs=n;t.zm=n;t.C=function(){Mz.n.C.call(this);this.la&&Nz(this,this.la,j);Rc(this.m(),Yc.Rk,"true")};t.ab=function(){Mz.n.ab.call(this);if(this.la){this.ub(n);this.la.ab();Nz(this,this.la,n);var b=this.la.m();b&&L(b)}};t.z=function(){Mz.n.z.call(this);this.la&&(this.la.H(),delete this.la);delete this.lT;this.sa.H()};
t.Me=function(b){Mz.n.Me.call(this,b);this.bc()&&(this.ub(!this.sb(),b),this.la&&(b=this.sb(),this.la.mg=b))};t.hg=function(b){Mz.n.hg.call(this,b);this.la&&!this.bc()&&(this.la.mg=n)};t.ke=function(){this.setActive(n);return j};t.oO=function(b){this.la&&(this.la.V()&&!this.Tf(b.target))&&this.ub(n)};t.Tf=function(b){return b&&vc(this.m(),b)||this.la&&this.la.Tf(b)||n};
t.uf=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return n;if(this.la&&this.la.V()){var c=this.la.$b(b);return 27==b.keyCode?(this.ub(n),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.ub(j),j):n};t.lo=function(){this.ub(n)};t.SO=function(){this.bc()||this.ub(n)};t.$c=function(b){this.Bs||this.ub(n);Mz.n.$c.call(this,b)};t.cb=function(){this.la||this.th(new fv(this.L()));return this.la||k};
t.th=function(b){var c=this.la;if(b!=c&&(c&&(this.ub(n),this.Da&&Nz(this,c,n),delete this.la),b)){this.la=b;Sh(b,this);b.F(n);var d=this.Bs;(b.gn=d)&&b.Ze(j);this.Da&&Nz(this,b,j)}return c};t.Ha=function(b){this.cb().J(b,j)};t.Si=function(b,c){this.cb().Uk(b,c,j)};t.removeItem=function(b){(b=this.cb().removeChild(b,j))&&b.H()};t.ii=function(b){return this.la?Vh(this.la,b):k};t.Hl=function(){return this.la?Uh(this.la):0};t.F=function(b,c){var d=Mz.n.F.call(this,b,c);d&&!this.V()&&this.ub(n);return d};
t.Ya=function(b){Mz.n.Ya.call(this,b);this.isEnabled()||this.ub(n)};a.Oz=function(b){b.em.Im&&b.em.Im(33)};t.HI=function(){this.ub(j)};
t.ub=function(b,c){Mz.n.ub.call(this,b);if(this.la&&!!(this.da&64)==b){if(b)this.la.Da||(this.zm?this.la.aa(this.m().parentNode):this.la.aa()),this.Gk=ig(this.m()),this.Xi=sg(this.m()),Pz(this),this.la.Tb(-1);else if(this.setActive(n),this.la.mg=n,this.m()&&Rc(this.m(),Yc.$m,""),this.kt!=k){this.kt=i;var d=this.la.m();d&&pg(d,"","")}this.la.F(b,n,c);if(!this.Sg){var d=this.h(),e=b?d.e:d.ya;e.call(d,this.L().za(),"mousedown",this.oO,j);this.Bs&&e.call(d,this.la,"blur",this.SO);e.call(d,this.sa,Nd,
this.lm);b?this.sa.start():this.sa.stop()}}};a.Pz=function(b){if(b.la.Da){var c=b.em;b.em.element=b.lT||b.m();var d=b.la.m();b.la.V()||(d.style.visibility="hidden",Q(d,j));!b.kt&&(b.em.bo&&b.em.bo()&32)&&(b.kt=rg(d));c.pa(d,c.Uf^1,b.Oy,b.kt);b.la.V()||(Q(d,n),d.style.visibility="visible")}};
t.lm=function(){var b=sg(this.m()),c=ig(this.m());if(!(this.Xi==b||(!this.Xi||!b?0:this.Xi.left==b.left&&this.Xi.width==b.width&&this.Xi.top==b.top&&this.Xi.height==b.height))||!(this.Gk==c||(!this.Gk||!c?0:this.Gk.top==c.top&&this.Gk.right==c.right&&this.Gk.bottom==c.bottom&&this.Gk.left==c.left)))this.Xi=b,this.Gk=c,Pz(this)};a.Nz=function(b,c,d){var e=b.h(),d=d?e.e:e.ya;d.call(e,c,"action",b.lo);d.call(e,c,"highlight",b.zx);d.call(e,c,"unhighlight",b.Ix)};t.zx=function(b){Rc(this.m(),Yc.$m,b.target.m().id)};
t.Ix=function(){Xt(this.la)||Rc(this.m(),Yc.$m,"")};mp("goog-menu-button",function(){return new Mz(k)});a.Qz=function(b,c,d,e){Mz.call(this,b,c,d||sz.U(),e)};y(Qz,Mz);
a.Rz={cX:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),nY:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),RX:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.Sz=
function(b){var c=new fv(b);F.forEach(Rz,function(d){d=new Jz(d,k,b);Hz(d,8);c.J(d,j)});return c};t=Qz.prototype;t.gx=function(){return this.X()};t.Fp=function(b){this.Ea(b)};t.Ea=function(b){for(var c=0,d;d=this.ii(c);c++)"function"==typeof d.Fp&&d.Fp(b);Qz.n.Ea.call(this,b)};t.lo=function(b){"function"==typeof b.target.gx?this.Ea(b.target.gx()):"none"==b.target.X()&&this.Ea(k);Qz.n.lo.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.ub=function(b,c){b&&0==this.Hl()&&(this.th(Sz(this.L())),this.Ea(this.X()));Qz.n.ub.call(this,b,c)};mp("goog-color-menu-button",function(){return new Qz(k)});a.Tz=function(){};y(Tz,qz);ia(Tz);Tz.prototype.P=s("goog-toolbar-menu-button");a.Uz=function(){};y(Uz,Tz);ia(Uz);Uz.prototype.createCaption=function(b,c){return rz(tz(b,c),this.P(),c)};Uz.prototype.Ea=function(b,c){b&&uz(this.fa(b),c)};Uz.prototype.Pe=function(b){this.Ea(b.m(),b.X());E.add(b.m(),"goog-toolbar-color-menu-button");Uz.n.Pe.call(this,b)};a.Vz=function(b,c,d,e){Qz.call(this,b,c,d||Uz.U(),e)};y(Vz,Qz);mp("goog-toolbar-color-menu-button",function(){return new Vz(k)});a.Wz=function(b,c,d,e){Mz.call(this,b,c,d||Tz.U(),e)};y(Wz,Mz);mp("goog-toolbar-menu-button",function(){return new Wz(k)});a.Yz=function(b,c,d,e){Mz.call(this,b,c,d,e);Xz(this,b);this.Dp(Zc.QB)};y(Yz,Mz);t=Yz.prototype;t.qa=k;t.$v=k;t.C=function(){Yz.n.C.call(this);Zz(this);$z(this);Rc(this.m(),Yc.Rk,"false")};t.$=function(b){Yz.n.$.call(this,b);(b=this.Wg())?Xz(this,b):this.Gp(0)};t.z=function(){Yz.n.z.call(this);this.qa&&(this.qa.H(),this.qa=k);this.$v=k};t.lo=function(b){this.Gf(b.target);Yz.n.lo.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.Aj=function(){var b=this.Yg();Yz.n.Ea.call(this,b&&b.X());Zz(this)};t.th=function(b){var c=Yz.n.th.call(this,b);b!=c&&(this.qa&&this.qa.clear(),b&&(this.qa?Th(b,function(b){aA(b);this.qa.Ha(b)},this):bA(this,b)));return c};a.Xz=function(b,c){b.$v=c;Zz(b)};t.Ha=function(b){aA(b);Yz.n.Ha.call(this,b);this.qa?this.qa.Ha(b):bA(this,this.cb())};t.Si=function(b,c){aA(b);Yz.n.Si.call(this,b,c);this.qa?this.qa.Si(b,c):bA(this,this.cb())};t.removeItem=function(b){Yz.n.removeItem.call(this,b);this.qa&&this.qa.removeItem(b)};
t.Gf=function(b){if(this.qa){var c=this.Yg();this.qa.Gf(b);b!=c&&this.dispatchEvent("change")}};t.Gp=function(b){this.qa&&this.Gf(this.qa.ii(b))};t.Ea=function(b){if(b!=k&&this.qa)for(var c=0,d;d=this.qa.ii(c);c++)if(d&&"function"==typeof d.X&&d.X()==b){this.Gf(d);return}this.Gf(k)};t.Yg=function(){return this.qa?this.qa.Yg():k};t.Kl=function(){return this.qa?this.qa.Kl():-1};
a.bA=function(b,c){b.qa=new Cz;c&&Th(c,function(b){aA(b);this.qa.Ha(b)},b);$z(b)},a.$z=function(b){b.qa&&b.h().e(b.qa,"select",b.Aj)},a.Zz=function(b){var c=b.Yg();b.Na(c?c.Wg():b.$v)},a.aA=function(b){b.Dp(b instanceof cv?Zc.UB:Zc.uK)};t.ub=function(b,c){Yz.n.ub.call(this,b,c);this.sb()&&this.cb().Tb(this.Kl())};mp("goog-select",function(){return new Yz(k)});a.cA=function(b,c,d,e){Yz.call(this,b,c,d||Tz.U(),e)};y(cA,Yz);mp("goog-toolbar-select",function(){return new cA(k)});a.dA=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.eA=function(b,c){z.forEach(c,function(c){var e=c.caption,c=c.value,g=dA(c),e=new jz(e,c,b.L());Qh(e,g);b.Ha(e);e.fa().style.fontFamily=c})},a.fA=[10,10,13,16,18,24,32,48],a.hA=function(b,c,d,e,g,h){d=new pz(gA(d,e,h),g,h);Qh(d,b);d.Wc(c);return d},a.iA=function(b,c,d,e,g,h){b=hA(b,c,
d,e,g,h);rp(b,16,j);return b},a.jA=function(b,c,d,e,g,h){g=new cA(k,k,g,h);e&&z.forEach(e.split(/\s+/),g.Mh,g);g.Mh("goog-toolbar-select");Xz(g,d);Qh(g,b);g.Wc(c);return g},a.kA=function(b,c,d,e,g,h){d=new Vz(gA(d,e,h),k,g,h);Qh(d,b);d.Wc(c);return d},a.gA=function(b,c,d){if((!b||""==b)&&C&&!Gb("1.9a"))b=" ";return(d||Vb()).w("DIV",c?{"class":c}:k,b)};a.lA=x("Link");x("Edit Link");x("Text to display:");a.mA=x("Link to:");x("Web address");x("Link to a page or file somewhere else on the web");x("Test this link");
x("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});x("To what URL should this link go?");x("Email address");x("Link to an email address");x("Invalid email address");
x("To what email address should this link?");x("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});x("Open this link in a new window");x("Image");a.nA={},a.oA=x("Normal"),a.pA=x("Normal / serif"),a.qA=[{caption:oA,value:"arial,sans-serif"},{caption:pA,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.rA={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.sA=x("Small"),a.tA=x("Normal"),a.uA=x("Large"),a.vA=x("Huge"),a.wA=[{caption:sA,value:1},{caption:tA,value:2},{caption:uA,value:4},{caption:vA,value:6}],a.xA=x("Heading"),
a.yA=x("Subheading"),a.zA=x("Minor heading"),a.AA=x("Normal"),a.BA=[{caption:xA,Aa:"H2"},{caption:yA,Aa:"H3"},{caption:zA,Aa:"H4"},{caption:AA,Aa:"P"}],a.CA=function(b,c,d,e,g,h){var l=hA(b,c,d,e,g,h);l.Mi=function(b){l.Ya(b)};return l},a.DA=function(b,c){var d=c;try{if(A)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.X()&&b.Ea(d)}catch(h){}},a.EA=x("Format"),a.FA=x("Format"),a.GA=x("Undo"),a.HA=x("Redo"),a.IA=x("Font"),a.JA=x("Font size"),
a.KA=x("Text color"),a.LA=x("Bold"),a.MA=x("Italic"),a.NA=x("Underline"),a.OA=x("Text background color"),a.PA=x("Add or remove link"),a.QA=x("Numbered list"),a.RA=x("Bullet list"),a.SA=x("Decrease indent"),a.TA=x("Increase indent"),a.UA=x("Align left"),a.VA=x("Align center"),a.WA=x("Align right"),a.XA=x("Justify"),a.YA=x("Remove formatting"),a.ZA=x("Insert image"),a.$A=x("Strikethrough"),a.aB=x("Left-to-right"),a.bB=x("Right-to-left"),a.cB=x("Quote"),a.dB=x("Edit HTML source"),a.eB=x("Subscript"),
a.fB=x("Superscript"),a.gB=x("Edit HTML"),a.hB={};
nA.NB=[{Aa:"+undo",T:GA,Oa:"tr-icon tr-undo",factory:CA,kb:j},{Aa:"+redo",T:HA,Oa:"tr-icon tr-redo",factory:CA,kb:j},{Aa:"+fontName",T:IA,Oa:"tr-fontName",factory:function(b,c,d,e,g,h){var l=jA(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in rA&&(c=rA[b]);c.length&&eA(l,c);eA(l,qA);Xz(l,oA);E.add(l.cb().fa(),"goog-menu-noaccel");l.Mi=function(b){var c=k;b&&0<b.length&&(c=Rh(l.cb(),dA(b)));c!=l.Yg()&&l.Gf(c)};return l},kb:j},{Aa:"+fontSize",T:JA,Oa:"tr-fontSize",factory:function(b,
c,d,e,g,h){var l=jA(b,c,d,e,g,h);z.forEach(wA,function(b){var c=b.value,b=new jz(b.caption,c,l.L());l.Ha(b);b=b.fa();b.style.fontSize=(fA[c]||10)+"px";b.firstChild.style.height="1.1em"});Xz(l,tA);E.add(l.cb().fa(),"goog-menu-noaccel");l.Mi=function(b){var c;if(c=oa(b))c=b.match(Kt),c="px"==(c&&c[0]||k);c&&(b=z.lastIndexOf(fA,parseInt(b,10)));b=0<b?b:k;b!=l.X()&&l.Ea(b)};return l},kb:j},{Aa:"+bold",T:LA,Oa:"tr-icon tr-bold",kb:j},{Aa:"+italic",T:MA,Oa:"tr-icon tr-italic",kb:j},{Aa:"+underline",T:NA,
Oa:"tr-icon tr-underline",kb:j},{Aa:"+foreColor",T:KA,Oa:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=kA(b,c,d,e,g,h);b.Fp("#000");b.Mi=xa(DA,b);return b},kb:j},{Aa:"+backColor",T:OA,Oa:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=kA(b,c,d,e,g,h);b.Fp("#FFF");b.Mi=xa(DA,b);return b},kb:j},{Aa:"+link",T:PA,caption:lA,Oa:"tr-link",kb:j},{Aa:"+insertOrderedList",T:QA,Oa:"tr-icon tr-insertOrderedList",kb:j},{Aa:"+insertUnorderedList",T:RA,Oa:"tr-icon tr-insertUnorderedList",kb:j},
{Aa:"+outdent",T:SA,Oa:"tr-icon tr-outdent",factory:hA},{Aa:"+indent",T:TA,Oa:"tr-icon tr-indent",factory:hA},{Aa:"+justifyLeft",T:UA,Oa:"tr-icon tr-justifyLeft",kb:j},{Aa:"+justifyCenter",T:VA,Oa:"tr-icon tr-justifyCenter",kb:j},{Aa:"+justifyRight",T:WA,Oa:"tr-icon tr-justifyRight",kb:j},{Aa:"+justifyFull",T:XA,Oa:"tr-icon tr-justifyFull",kb:j},{Aa:"+removeFormat",T:YA,Oa:"tr-icon tr-removeFormat",factory:hA},{Aa:"image",T:ZA,Oa:"tr-icon tr-image",factory:hA},{Aa:"+strikeThrough",T:$A,Oa:"tr-icon tr-strikeThrough",
kb:j},{Aa:"+subscript",T:eB,Oa:"tr-icon tr-subscript",kb:j},{Aa:"+superscript",T:fB,Oa:"tr-icon tr-superscript",kb:j},{Aa:"ltr",T:aB,Oa:"tr-icon tr-ltr",kb:j},{Aa:"rtl",T:bB,Oa:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=iA(b,c,d,e,g,h);l.Mi=function(b){b=!!b;E.enable(l.getParent().m(),"tr-rtl-mode",b);l.Vc(b)};return l},kb:j},{Aa:"+BLOCKQUOTE",T:cB,Oa:"tr-icon tr-BLOCKQUOTE",kb:j},{Aa:"+formatBlock",T:EA,caption:FA,Oa:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=jA(b,c,d,e,g,h);
z.forEach(BA,function(b){var c=b.caption,b=b.Aa,d=l.L(),c=new jz(d.w("DIV",k,c),b,d);Qh(c,b);l.Ha(c)});Xz(l,AA);E.add(l.cb().fa(),"goog-menu-noaccel");l.Mi=function(b){b=b&&0<b.length?b:k;b!=l.X()&&l.Ea(b)};return l},kb:j},{Aa:"editHtml",T:dB,caption:gB,Oa:"tr-editHtml",factory:hA}];for(var iB=0,jB;jB=nA.NB[iB];iB++)hB[jB.Aa]=jB;delete nA.NB;a.kB={};kB.IV=Uk;a.lB=function(b){Uv.call(this);this.ha=new qe(this);this.rF=K("div",{style:"display:none"});this.g=this.vc=k;this.G={};F.extend(this.G,this.R,b||{})};y(lB,Uv);ya(lB.prototype,kB);lB.prototype.R={Fk:k,title:"Distraction Free Mode",OL:"back",gU:"publish",Qw:"zu-editing-distraction-free",bV:"sticky-goog-scrollfloater",DV:"goog-scrollfloater"};lB.prototype.md=of("FullScreenPlugin");hB.toggleFullScreen={Aa:"toggleFullScreen",T:"写作模式",Oa:"tr-icon tr-max",factory:hA};t=lB.prototype;
t.Qe=xa(F.Ng,{yY:"toggleFullScreen",TW:"enterFullScreen",UW:"exitFullScreen"});t.z=function(){this.ha.H();L(this.g);this.G=this.Wp=this.vc=this.vb=this.g=k;lB.n.z.call(this)};
t.Av=function(){var b=this.G,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.OL+'" name="return">返回</a><a href="#" class="'+b.gU+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.ha.e(J("back",c),"click",function(b){b.preventDefault();mB(this)},n,this);this.ha.e(J("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&mB(this)},n,this);this.g=c;this.vc=J("content",c);this.Wp=K("div",{className:"toolbar-info"});this.G.Fk||(this.G.Fk=this.D.field)};t.of=function(b){this.g||this.Av();switch(b){case "enterFullScreen":nB(this);break;case "exitFullScreen":mB(this);break;case "toggleFullScreen":this.hy()?mB(this):nB(this)}};t.hy=function(){return E.has(document.body,this.G.Qw)};
a.nB=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.bE||(b.JP=history.length);b.bE=j;oB(b,"writing");b.JJ=Pc(Vb((fa||window).document));pc(b.rF,b.G.Fk);b.vc.appendChild(b.G.Fk);E.add(document.body,b.G.Qw);b.vb=J(b.G.DV,b.g);b.vb.appendChild(b.Wp);var c=b.g;c.scrollTop=0;var d=b.vb.getBoundingClientRect().top;c.onscroll=sf(v(b.DI,b),function(){return c.scrollTop>d});b.ha.e(document,"keydown",b.ap,n,b);La(Ic(b.D.field))||b.D.dg();b.dispatchEvent("enterFullScreen")}},a.mB=function(b){b.bE&&
b.JP!==history.length?history.back():oB(b,"");b.vb.removeChild(b.Wp);b.DI(n);b.g.onscroll=k;b.ha.ya(document,"keydown",b.ap,n,b);pc(b.G.Fk,b.rF);E.remove(document.body,b.G.Qw);window.scrollTo(b.JJ.x,b.JJ.y);b.dispatchEvent("exitFullScreen")},a.oB=function(b,c){Bd(window,"hashchange",b.eH,n,b);location.hash=c||"";setTimeout(v(function(){this.ha.e(window,"hashchange",this.eH,n,this)},b))};t.eH=function(){this.hy()?mB(this):"writing"===location.hash.slice(1)&&nB(this)};
t.ap=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&mB(this)};t.DI=function(b){E[b?"add":"remove"](this.vb,this.G.bV)};a.qB=function(b,c){M.call(this);this.ng=b;this.tA=c||pB;b.wb||(this.show=ha)};y(qB,Dn);a.pB="加载中...";t=qB.prototype;
t.show=function(){nc(this.g=K("div","zg-mt10",[K("h3",{style:"margin:0 0 5px;"},"分享到微博"),K("div","zm-tab-content",[this.VY=K("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> <label><input data-bindurl="/oauth/auth/qq?next=/oauth/callback" class="qq-checkbox" type="checkbox"><i class="zg-ico-qq"></i> 腾讯微博</label>'}),K("div","zg-section",K("div","zg-form-text-input",
this.Hp=K("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),K("div","zm-command",[K("div",["zm-item-meta","zg-left"],this.zU=K("span")),this.dV=K("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),I("zh-question-answer-form-wrap"));this.h().e(Y,"sina_callback",function(b){this.pA(b.qb.id,b.qb.name)}).e(Y,"qq_callback",function(b){this.oA(b.qb.id,b.qb.name)});this.mv();this.og();Jp.U().refresh();var b=this;this.tA===pB?Ji("/answer/"+b.ng.wb+"/sharetext",function(c){if((c=
Le(c.target))&&c.sina)b.tA=c.sina,b.Sa()},"GET"):this.Sa()};t.pA=function(b,c){vh.name=c;this.SU=vh.id=b;this.Dc.checked=j;this.og()};t.oA=function(b,c){wh.name=c;this.wT=wh.id=b;this.Cc.checked=j;this.og()};t.og=function(){var b=J("weibo-share-button",this.g),c=this.Dc.checked||this.Cc.checked;E.enable(b,"zg-btn-blue",c);E.enable(b,"zg-btn-disabled",!c)};t.Sa=function(){this.Hp.value=this.tA;this.HA=new Oo(this.Hp);this.NI=new xv(this.Hp,this.zU,140,vv);this.h().e(this.dV,"click",this.na)};
t.mv=function(){this.Dc=J("sina-checkbox",this.g);this.h().e(this.Dc,"change",this.fp);this.Cc=J("qq-checkbox",this.g);this.h().e(this.Cc,"change",this.fp)};t.fp=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.Dc&&!this.SU||b===this.Cc&&!this.wT?(window.open(c),b.checked=n):this.og()};
t.na=function(b){if((b=b.target)&&E.has(b,"zg-btn-blue")&&this.Hp.value){b=new Rk(j);b.add("content",this.Hp.value);var c=[];this.Dc.checked&&c.push("sina");this.Cc.checked&&c.push("qq");b.add("via",c.join(","));this.um(b);Uk("share",this.WZ?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.um=function(b){b.add("aid",this.ng.ta);this.xhr=new V(j);P(this.h(),this.xhr,"complete",this.bv);this.xhr.ajax("/answer/share",b.Pc())};
t.bv=function(){var b=Le(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),Q(this.g,n))};a.rB=function(b,c,d){cv.call(this,b,c,d);this.xp(j)};y(rB,cv);mp("goog-checkbox-menuitem",function(){return new rB(k)});a.sB=function(b,c){M.call(this);this.oa=b;this.Xb=c;this.data=hh};y(sB,Dn);t=sB.prototype;
t.B=function(){this.ym=I("zh-question-redirect-info");this.ym.innerHTML&&(this.Do=j);this.h().e(this.ym,"click",function(b){"cancel"===b.target.name&&tB(this)});var b=I("zh-question-side-header-wrap");if(gh.Bc&&!gh.ZF&&b){var c=I("zh-question-filter-wrap");c?mc(b,c):b.style[A?"styleFloat":"cssFloat"]="none"}(this.pg=I("zh-question-operation-menu"))&&this.Jj();this.h().e(Pi,"anon_change",function(b){var c=I("zh-question-side-invitation-anon");c&&Q(c,b.mb);(c=I("zh-question-side-invitation-notanon"))&&
Q(c,!b.mb);this.mm&&this.mm.Ya(mu(this.data.hk)||!b.mb)});(this.Jk=I("zh-question-webshare-container"))&&this.h().e(this.Jk,"click",this.AA)};
t.Jj=function(){this.jb=new fv;var b=this.data.hn,c=this.pg.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.jb.Ha(this.ht=uB("使用匿名身份",j));this.ht.Vc(this.data.mb);if((!qh||!z.contains(qh,"question_op_redirect"))&&"close"!==hh.status)this.jb.Ha(this.mm=uB(this.Do?"撤消重定向":"问题重定向")),this.mm.Ya(mu(this.data.hk)||!this.data.mb);z.contains(c,"auth-f-manage")&&this.jb.Ha(this.OS=uB("更新话题页显示",n));this.h().e(this.jb,"action",this.zj);this.ht&&this.h().e(Pi,"anon_change",function(b){this.ht.Vc(!!b.mb)});
this.Xb&&z.contains(c,"auth-f-manage")&&(this.jb.Ha(this.sz=uB("优质回答",j)),this.sz.Vc(this.Xb.wQ));b=new Mz("Settings",this.jb);b.zm=j;Oz(b);b.o(this.pg)}};a.uB=function(b,c){return!b?new ev:c?new rB(b):new cv(b)};
t.zj=function(b){var c=this.ht;b.target===c?it(c.fe()?1:0,function(b){b||c.Vc(!c.fe())}):b.target===this.mm?(this.jp||(this.jp=new Yx(this.oa),this.h().e(this.jp,"change",this.ZQ)),this.jb.F(n),this.Do?tB(this):this.jp.show()):b.target===this.JS?Ji("/question/"+this.data.wb+(this.JS.fe()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+hh.wb:window.location.reload()},"POST"):b.target===this.OS?$.post("/refresh_topic_feeds",{q:hh.wb}).done(function(b){b.r||
U("操作成功！")}):b.target===this.sz&&$.post("/answer/"+this.Xb.wb+(this.sz.fe()?"/good_mark":"/good_unmark")).done(function(b){b.r||U("操作成功！")})};t.ZQ=function(){this.ym.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.jp.Kt+'">'+this.jp.MH+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';Q(this.ym,j);this.Do=j;this.mm.Gm("撤消重定向")};
a.tB=function(b){b.ym.innerHTML="";Q(b.ym,n);b.Do=n;b.mm.Gm("问题重定向");Ji("/question/unredirect",k,"POST","qid="+b.oa+"&rqid="+b.Kt)};t.AA=function(b){var c=Qk(this.Jk,b.target);c&&c.name&&rn(function(){var b=$("#zh-question-webshare-container").data();new zv([b.title,b.type,b.urlToken,{answer:{aid:b.id},question:{qid:b.id}}[b.type]],"tb-webshare-"+c.name);Y.Y({type:"ga_click_share_question_box",target:c,data:{type:c.name}})},function(){return{Kh:"letter"===c.name}})()};a.vB=function(b){Wr.call(this,j,"/topic/bio/update","bio");this.Yp=b[0];this.sd=["tid="+this.Yp[3]];this.content=b[1];this.Ab='<a href="javascript:;" name="edit">描述你关于 '+this.Yp[0]+" 的经验</a>";this.tu=j};y(vB,Wr);vB.prototype.bj=function(){vB.n.bj.call(this);this.Dn.innerHTML="更新"};vB.prototype.$=function(b){vB.n.$.call(this,b);var b=this.L(),c=b.w("strong",k,K("a",{href:"/topic/"+this.Yp[1],title:this.Yp[0],"class":""},this.Yp[0]));b.Zl(c,this.Wb)};a.wB=function(b,c){M.call(this);this.bQ=c;this.kl=b;this.items=[];this.c0="/url_to_fetch_question_related_topic_bio_items";this.yy=n};y(wB,Dn);
a.xB=k,a.yB=function(){xB||(xB=new wB(jh,n));return xB},a.zB=function(b){if(!b.locked)if(!b.gR&&b.yy){b.locked=j;var c=new V(j);b.h().e(c,"success",function(b){this.gR=j;this.locked=n;b=Le(b.target);b.r||(this.kl=b.msg,zB(this))});c.ajax("/question/"+b.XH+"/bios",k,"GET")}else b.ca||(b.ca=new Di,b.ca.lb("修改话题经验"),mi(b.ca,k),gi(b.ca,n),c=b.ca.fa(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.aa(c)),b.ca.F(j)};
wB.prototype.aa=function(b){this.g=K("div","zu-bio-editor-wrap",[this.eQ=K("div","zu-bio-editor-inner-wrap"),this.Cd=K("div","zm-command",[this.Dn=K("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);z.forEach(this.kl,function(b){b=new vB(b);b.aa(this.eQ);this.items.push(b)},this);this.bQ&&Q(this.Cd,n);b.appendChild(this.g);this.h().e(this.Cd,"click",this.na)};
wB.prototype.Sw=function(){var b=this.items.length,c;if(!b&&this.kl.length)for(c=0;c<this.kl.length;c++)if(this.kl[c][1])return this.kl[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].ib())return d};wB.prototype.na=function(b){if((b=this.qf(b.target))&&"save"===b.name)this.ca&&this.ca.F(n),this.dispatchEvent("change")};a.AB=function(b){T.call(this);this.Db=b;this.yZ=this.Db.Nr();this.Hr=this.Db.Hd?this.Db.Ma:this.Db.Ma.m();this.isContentEditable=this.Db.isContentEditable();this.tV=30;this.Ec=new Md(1E3*this.tV);this.oa=hh?hh.oa:0};y(AB,T);t=AB.prototype;t.z=function(){BB(this);this.Ec.H();AB.n.z.call(this)};
t.o=function(b){this.g=b;this.Hj=J("draft-saved-info",b);Q(this.Hj,n);this.Vx=J("draft-saved-time",b);this.qM=J("draft-clear-button",b);this.jZ=this.isContentEditable?cw:["change","input"];b=this.h().e(this.Ec,Nd,this.aA).e(this.qM,"click",this.rM).e(this.Hr,"keydown",this.JQ);"oninput"in this.Hr&&!A?b.e(this.Hr,"input",this.gQ):b.e(this.Hr,"keydown",this.hQ);var c=oh&&1E3*oh[1];c&&(CB(this,c),this.dB=setInterval(v(function(){CB(this,c)},this),22E3))};
t.JQ=function(b){if((b.metaKey||b.ctrlKey)&&"s"===ok[b.keyCode])this.WQ(),this.isContentEditable||b.preventDefault()};a.DB=function(b){Q(b.Hj,j);Ac(b.Vx,"保存中…");b.fQ()};t.gQ=function(){DB(this)};t.hQ=function(b){yh(b.keyCode)&&DB(this)};t.NA=function(){this.Ec.start()};t.RA=function(){this.Ec.stop()};t.Na=function(b){this.Db.Na(b);this.Db.Ap()};t.ib=function(){return this.Db.eg()};
t.lI=function(){if(!this.Sg){var b=this.ib();b&&(b=(new nj).add("qid",this.oa).add("content",b),Ji("/answer/draft/save",k,"POST",b.toString()),this.Bf())}};t.dW=150;t.aA=cl(AB.prototype.dW,AB.prototype.lI);t.XQ=350;t.WQ=cl(AB.prototype.XQ,AB.prototype.lI);t.iQ=3E3;t.fQ=cl(AB.prototype.iQ,function(){this.Sg||(this.ib()?this.aA():EB(this))});a.BB=function(b){b.dB&&(clearInterval(b.dB),b.dB=k)};t.Bf=function(){BB(this);Q(this.Hj,j);Q(this.Hj,j);Ac(this.Vx,"已保存");this.dispatchEvent("saveContent")};
a.CB=function(b,c){var d=hu(c||za());/^\d/.test(d)&&(d=" "+d);d="已存于"+d;Q(b.Hj,j);Ac(b.Vx,d)};t.rM=function(b){b.preventDefault();Hi("清除草稿","你确定要清除保存的草稿吗？",function(b){b&&(this.Na(""),EB(this),this.Db.ready(function(){var b=this.Ma;this.Hd?et(b,b.value.length):b.field.lastChild?ct(b.field.lastChild):b.dg();this.sl&&(this.sl.scrollTop=this.sl.scrollHeight)}))},this)};a.EB=function(b){Ji("/answer/draft/delete",k,"POST","qid="+b.oa);BB(b);Q(b.Hj,n);b.dispatchEvent("clearContent")};a.FB=function(b,c,d){Zr.call(this,n);this.mb=!!b;this.zJ=c;this.Ab="&nbsp;";this.Oq=d;this.su=this.pw=this.sE=this.enabled=j;if(R.Jg||!R.Ia())this.Fy='<span style="font-style: normal;color: #999;">写回答…</span>'};y(FB,Zr);t=FB.prototype;t.DE=function(){var b=Xb("h2","zm-editable-content",I("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Ic(b):b.firstChild.nodeValue)||"",Fk:this.Zh}};t.Sw=q("Oq");t.Pt=ca("mb");
a.GB=function(b,c){b.Oq=c?c:R[4];if(b.Yl&&$.trim(c)){var d=c;20<d.length&&(d=d.substring(0,17)+"...");b.VL.innerHTML="，"+Wa(d)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>'}};t.Ya=function(b,c){this.enabled=b;this.Yl?(this.xh(),this.Ab=c,this.Wb.innerHTML=this.Ab):c&&(this.Ab=c)};t.$=function(b){FB.n.$.call(this,b);this.Yl=j;E.add(this.Wb,"zu-answer-form-disabled-wrap")};t.z=function(){this.rs&&(L(this.rs),this.AJ=this.rs=k);FB.n.z.call(this)};
t.wj=function(b){this.Pt(b.mb);this.Fq&&(this.Fq.checked=b.mb)};t.C=function(){FB.n.C.call(this);this.h().e(Pi,"anon_change",this.wj)};
t.Qg=function(){FB.n.Qg.call(this);var b=this.L(),c=R.Ia();this.rs=b.w("div","zh-answer-form clearfix",[c?lu(this.zJ):"",this.AJ=b.w("div",k,[b.w("div","zu-answer-form-title",[c?ku(this.zJ):"我来回答这个问题",this.VL=b.w("span")])])]);GB(this,this.Oq);b.Zl(this.rs,this.Zh);this.h().e(this.AJ,"click",this.na);if(R.Ia())if(R.Jg){if(22924312===hh.wb){var d=this,e=/^\d{10}$/,b=this.L(),g,h,l=b.w("div","zh-answer-form",[c=b.w("input",{"class":"zg-form-text-input",style:"width: 200px"}),b.w("a",{"data-tip":"s$b$识别码在书中的蓝色小卡片上<br />知乎会对验证成功的用户随机送出 50 份小礼物"},
[g=b.w("i",{"class":"zg-icon zg-icon-question-mark",style:"margin: 0 10px"})]),h=b.w("span",{style:"color: #666"})]),m=new Io("输入随书附送的网络识别码（可选）");m.o(c);Vc(this,m);Q(h,n);b.Zl(l,this.Zh);var p=function(b){E.Nh(g,["zg-icon-question-mark","zg-icon icon-validate-ok"],"zg-icon icon-validate-error");h.innerHTML=b;Q(h,j)},r=k;m.h().e(new sv(c),"input",function(){var b=m.X().trim();r===b||!e.test(b)?(E.Nh(g,["zg-icon icon-validate-ok","zg-icon icon-validate-error"],"zg-icon-question-mark"),Q(h,n)):(r=b,
$.post("/verify_newbook",{verification_code:b},function(b){if(b.msg&&!isNaN(b.msg)){E.Nh(g,["zg-icon-question-mark","zg-icon icon-validate-error"],"zg-icon icon-validate-ok");Q(h,n);var c=d.Ma,e=c.hb,l=e.w("DIV",k,"我拥有第 "+b.msg+" 本「创业时，我们在知乎聊什么」。其中对我最有启发的一个案例是："),r=e.w("DIV",k,[e.w("IMG",{"class":"content_image",src:"http://p3.zhimg.com/f9/57/f9579bff93db4e4e97ac50f732c787d3_m.jpg"})]),w=e.w("br");c.execCommand("clearlorem",j);b=function(){var b=c.m();e.kQ(b,l,0);e.vs(w,l);e.append(b,r)};Xv(c,j,j);
try{b.call(i)}finally{c.Ld()&&c.He()}ct(w);m.Ya(n)}else p("识别码无效")}))});m.h().e(c,"change",function(){e.test(m.X().trim())||p("识别码为十位数字")})}}else HB(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){b.attr("data-activate-dialog","");c.attr("data-activate-dialog","")});else HB(this,'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',
function(b,c){function d(){new on("question_answer_add_start")}b.on("click",d);c.on("click",d)})};a.HB=function(b,c,d,e){c=$(c).css("top",0).css("z-index",9);$(b.Cd).hide();d=$(d);$(b.Zh).append(c).after(d);e&&e.call(b,c,d)};
t.Pl=function(b){switch(b){case "edit_bio":b=yB();if(!this.qv){var c=hh.wb;b.yy=j;b.XH=c;this.h().e(b,"change",this.ez)}this.qv=j;zB(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.Nk?this.Nk.show():(d.Nk=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
d.Nk.on("click",'[name="cancel"]',function(){d.Nk.hide()}).on("click",'[name="confirm"]',function(){d.Nk.hide();$(d.Wb).hide();d.Ya(j);d.xd()}),$(d.Wb).after(d.Nk))}return j};t.Be=function(){"editing"===this.status?this.Ob&&Q(this.Ob,j):this.Ob&&Q(this.Ob,n);Q(this.hd,n);this.Wb&&Q(this.Wb,!this.enabled)};t.zM='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.bj=function(){var b=Xk(this.zM);this.Cd=ic(b({questionStatus:hh.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[hh.status]}));this.Dn=$(".submit-button",this.Cd)[0];var b=$("input[name=anno-checkbox]",this.Cd)[0],c=$("label",this.Cd)[0];this.Fq=b;hh.mb&&(this.Fq.checked=j);wg(c,j);this.Ob.appendChild(this.Cd);this.ready(function(){if(this.Ma&&this.Ma.on)this.Ma.on("load",this.WP,n,this)})};
t.WP=function(){var b=new AB(this);Vc(this,b);this.h().e(b,"saveContent",function(){var b=!this.Hd&&this.Ma.tj("FullScreenPlugin");if(b&&b.Wp){var c=$(b.Wp);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}},n,this);var c=this.Hd?this.Ma:this.Ma.m();this.h().e(c,"focus",function(){b.NA()}).e(c,"blur",function(){b.RA();b.aA()});b.o(this.Cd)};t.ez=function(){var b=yB().Sw();b&&GB(this,b)};a.IB=function(b,c){fv.call(this,b,c);this.gn=j;this.Ze(j);this.F(n,j);this.Kf=new Rd};y(IB,fv);t=IB.prototype;t.zV=n;t.dG=0;t.hf=k;t.$=function(b){IB.n.$.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.L().m(b),1)};t.C=function(){IB.n.C.call(this);Pd.forEach(this.Kf,this.zC,this);var b=this.h();b.e(this,"action",this.wR);b.e(this.L().za(),"mousedown",this.aH,j);D&&b.e(this.L().za(),"contextmenu",this.aH,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.Kf.Ud(ua(b)))b?(c={g:b,YI:c,eR:d,dE:e?"contextmenu":"mousedown",Iy:g},this.Kf.set(ua(b),c),b=c):b=k,this.Da&&this.zC(b)};t.zC=function(b){this.h().e(b.g,b.dE,this.qH)};t.detach=function(b){(!b||!this.Kf.Ud(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.Da){var c=this.Kf.get(b);this.h().ya(c.g,c.dE,this.qH)}this.Kf.remove(b)};
a.JB=function(b,c,d,e,g){var h=b.V();b.ly()&&b.zV?b.hide():(b.hf=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.m().style.visibility="hidden"),Q(b.m(),j),c.pa(b.m(),d,e),h||(b.m().style.visibility="visible"),b.Tb(-1),b.F(j)))};t.HI=function(b,c,d){c=la(b.YI)?new cu(b.g,b.YI,j):new bu(c,d);c.Im&&c.Im(5);JB(this,c,b.eR,b.Iy,b.g)};t.hide=function(){this.V()&&(this.F(n),this.V()||(this.dG=za(),this.hf=k))};t.ly=function(){return this.V()||150>za()-this.dG};t.wR=function(){this.hide()};
t.qH=function(b){for(var c=this.Kf.Hb(),d=0;d<c.length;d++){var e=this.Kf.get(c[d]);if(e.g==b.currentTarget){this.HI(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.aH=function(b){this.V()&&!this.Tf(b.target)&&this.hide()};t.$c=function(b){IB.n.$c.call(this,b);this.hide()};t.z=function(){IB.n.z.call(this);this.Kf&&(this.Kf.clear(),delete this.Kf)};a.KB=function(){T.call(this)};y(KB,T);KB.prototype.J=function(b,c){KB.n.J.call(this,b,c);this.h().e(b,"beforeexpand",this.qP)};KB.prototype.qP=function(b){var c=b.target;Th(this,function(b){c!==b&&b.Ac()&&b.Pa(n)})};KB.prototype.H=function(){this.h().H();KB.n.H.call(this)};a.LB=function(b,c){T.call(this);this.vT=b;this.tt=c;this.oQ=this.W=k;this.kd=n;this.xo=k;this.$l=[];this.VI=[];this.tg=n;this.TQ="loading";this.OF="zg-btn-white";this.pQ="invite-button"};y(LB,T);t=LB.prototype;t.w=function(){this.g=K("div",{style:"display:none",className:"question-invite-panel"})};t.aa=function(){this.tg=j;LB.n.aa.call(this)};
t.C=function(){LB.n.C.call(this);var b=this.g,c=this.h();if(!this.tg){c.e(Pi,"anon_change",this.reload);var d=J("cancel-anon",b);d&&c.e(d,"click",this.fO);if(!J("error-message")){var d=J("search-input",b),e=J("invite-title",b);this.dy=J("invite-status",b);c.e(this.dy,"click",this.gO);var g=J("suggest-persons",b);g&&(c.e(g,"click",this.Ax),this.UI=g);var h=$(".invited-hovercard",b);$(".invited-shortlist",b).hover(function(){h.toggleClass("in")});this.Xx(d,e);this.VI=$(this.UI).children().map(this.BH).get();
this.$l=$(".invited-fulllist",this.dy).children().map(this.BH).get();var l=function(b){0>b||b>p-1||(B.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?r.addClass("link-disabled"):r.removeClass("link-disabled"),b===p-1?w.addClass("link-disabled"):w.removeClass("link-disabled"),m=b)},b=this.g,m=0,p,r,w,B;B=$(".suggest-persons",b);p=B.find("li").length/4;r=$(".js-prev",b).on("click",function(){l(m-1)});w=$(".js-next",b).on("click",function(){l(m+1)});l(0);Q(this.g,this.kd)}}};
t.ab=function(){LB.n.ab.call(this);this.h().H()};t.cj=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.Ac()?this.jk():this.tg=j};t.jk=function(){var b=this,c=this.TQ;this.ab();E.add(this.g,c);this.g.innerHTML=this.cj();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.vT}}).done(function(d){b.tg=n;E.remove(b.g,c);d=ic(La(d));Q(d,b.Ac());pc(d,b.g);b.g=d;b.C()})};
t.z=function(){LB.n.z.call(this);this.oQ=k;this.W.H()};t.Ac=q("kd");t.expand=function(){this.Pa(j)};t.collapse=function(){this.Pa(n)};t.Pa=function(b){if(b!==this.kd){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.tg?this.jk().done(c):c();this.kd=b;Q(this.g,b)}};t.yg=function(){this.Pa(!this.kd)};
t.Xx=function(b){var c=this,d=Xk('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.W=new Rp(b,{je:8,source:"/people/autocomplete?type=invite",lk:b.offsetParent,placeholder:"搜索你想邀请的人",dd:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return z.filter(b,function(b){var d=b.id;return!z.find(c.$l,function(b){return b.id===
d})})},select:function(b){MB(c,"ask_to_answer_search");qu(c.tt,b.id,"search").done(function(d){if(d.r)return U(d.msg);NB(c,b);OB(c,b.id,j)});return""}})};a.PB=function(b,c,d){b=b.OF;d?(E.add(c,b),Ac(c,"收回邀请")):(E.remove(c,b),Ac(c,"邀请回答"))};t.fO=function(){it(0)};
a.MB=function(b,c){var d=hh;b.dispatchEvent(new Jw("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.VF?k:d.ze}));b.W&&b.W.Bb&&((new Image).src="http://analytics.zhihu.com/zat.gif?"+$.param({query_type:"invite_search",session_id:dl(),user_id:R.No,query_word:b.W.Bb,click_position:b.W.N.mi+1,result_url_token:b.W.Xa[ym(b.W,b.W.zc)].e0}))};
t.Ax=function(b){var c=b.target;if("BUTTON"===c.tagName||E.has(c,this.pQ)){this.xo&&"pending"===this.xo.state()&&this.xo.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";MB(this,b);var d=c.getAttribute("data-uid"),e=this.OF,g=v(function(b){b?(PB(this,c,j),b=z.find(this.VI,function(b){return b.id===d}),NB(this,b)):(PB(this,c,n),QB(this,d))},this);E.has(c,e)?(this.xo=pu(this.tt,d),g(n)):(this.xo=qu(this.tt,d,b).done(function(b){b.r&&(U(b.msg),
g(n))}),g(j))}};t.gO=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),pu(this.tt,b),OB(this,b,n),QB(this,b))};a.OB=function(b,c,d){var e=$(".invite-button",b.UI).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&PB(b,e,d)};t.BH=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.NB=function(b,c){b.$l.unshift(c);RB(b);$(".ignore-invite-hint").css("display","none")},a.QB=function(b,c){b.$l&&z.KT(b.$l,function(b){return b.id===c})&&(RB(b),$(".ignore-invite-hint").css("display","none"))};t.AU='您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.NN='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.RB=function(b){var c=b.$l,d={each:z.forEach,fullList:function(){return Xk(b.NN,{persons:c,helper:d})}};b.dy.innerHTML=c.length?Xk(b.AU,{persons:c,helper:d}):""};a.SB=function(b){this.data=b;this.va=k};y(SB,T);t=SB.prototype;t.C=function(){SB.n.C.call(this);this.h().e(this.g,"click",this.km);var b=J("panel-container",this.g);b&&(this.Xj=new KB,this.J(this.Xj),this.Xj.o(b),this.va=new Ww(this.data.oa,"question"),this.Xj.J(this.va),$w(this.va,this.Xj.m(),$(".toggle-comment",this.g)[0]),TB(this));this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("label","question")})};
t.km=function(b){var c=(b=Qk(this.g,b.target))&&b.name;if(c)switch(c){case "report-question":Tu("question",this.data.oa,'<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>');break;case "addcomment":"添加评论"===$.trim($(b).text())?rn(this.Ol,{Ia:"question_add_comment_start"}).call(this,b):this.Ol();break;case "remove":Hi("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);N(c,"complete",function(){var b=Le(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+
this.data.oa)}},this);break;case "admin":c=this.WK;c||(c=new IB,c.o(I("zh-question-admin-menu")),Th(c,function(b){b.Ea(b.m().getAttribute("data-action"))}),this.h().e(c,"action",function(b){b=this.dC=b.target;(new Kw).open(b.m(),{id:this.data.oa,type:"question"},v(this.FM,this))}),this.WK=c);c.V()?c.F(n):JB(c,new cu(b,1,j),0,new Rf(5,0,5,0));break;case "share":Y.Y({type:"ga_click_share_question_box",target:b});this.Id();break;case "invite":this.Ax()}};
t.Ol=function(b){this.va.yg();this.va.Ac()&&this.va.Ji("view_comments",parseInt(Ic(b),10)||0)};a.TB=function(b){if("normal"===hh.status){var c=new LB(b.data.oa,b.data.wb),d=I("question-invite-panel");d?(c.o(d),b.Xj.J(c),c.Pa(!b.va.Ac()),b.dispatchEvent(new Jw("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))):(c.aa(b.Xj.m()),b.Xj.J(c));b.cy=c}};
t.Ax=function(){if(this.cy){this.cy.yg();var b=this.cy.Ac();this.dispatchEvent(new Jw("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.ze}))}else TB(this)};t.Id=rn(function(){new zv(["分享问题","question",this.data.wb,{qid:this.data.oa}],"tb-webshare-sina")},{Ia:"question_question_share"});t.FM=function(b){this.dC.X(b.msg.action);this.dC.Gm(b.msg.caption)};a.mx=function(b,c){this.wc=b;this.entryType=c;this.vm=k;this.kd=n};y(mx,T);t=mx.prototype;t.Ac=q("kd");t.Pa=function(b){this.kd=!!b};t.bb=function(){return this.kq.data("votecount")};t.jk=function(){this.vm&&"pending"===this.vm.state()||(this.vm=("post"===this.entryType?ov:su)(this.wc,this.kd).done(v(this.Dt,this)))};t.Dt=function(b){if(b=La(b))b=$(b),this.kq.replaceWith(b),this.kq=b,this.Sa(),this.dispatchEvent("change")};t.Sa=function(){var b=this;$("a.more",this.kq).click(function(){b.Pa(j);b.jk()})};
t.C=function(){this.kq=$(this.g);this.Sa()};a.UB=function(b){this.M=$(b);this.bh()};UB.prototype.bh=function(){var b=[this.M.get(0)].concat(this.M.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.n_=c;this.qR=d};UB.prototype.getItem=q("qR");a.VB=function(b,c,d,e){Zr.call(this,b,c,d,e)};y(VB,Zr);VB.prototype.Yd=function(){$(window).on("beforeunload.AnswerEditor",v(s("你的修改还未保存，确认离开该页面吗？"),this))};VB.prototype.Ge=function(){$(window).off("beforeunload.AnswerEditor")};VB.prototype.xh=function(){VB.n.xh.call(this);this.Ge()};VB.prototype.xd=function(){VB.n.xd.call(this);this.Yd()};a.WB=function(){this.Fv=[]};y(WB,Yu);ia(WB);WB.prototype.w=function(b){var c=WB.n.w.call(this,b);E.add(c,"goog-submenu");XB(this,b,c);return c};WB.prototype.o=function(b,c){c=WB.n.o.call(this,b,c);E.add(c,"goog-submenu");XB(this,b,c);var d=Xb("div","goog-menu",c);if(d.length){var e=new fv(b.L()),d=d[0];Q(d,n);b.L().za().body.appendChild(d);e.o(d);b.th(e,j)}return c};
WB.prototype.Na=function(b,c){var d=this.fa(b),e=d&&d.lastChild;WB.n.Na.call(this,b,c);e&&(d.lastChild!=e&&E.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};WB.prototype.Pe=function(b){WB.n.Pe.call(this,b);var c=b.fa(),d=b.L(),d=Wb(d.Ja,"span","goog-submenu-arrow",c)[0];YB(b,d);d!=c.lastChild&&c.appendChild(d);Rc(b.m(),Yc.Rk,"true")};
a.XB=function(b,c,d){var e=c.L().w("span");e.className="goog-submenu-arrow";YB(c,e);b.fa(d).appendChild(e)},a.YB=function(b,c){b.Md()?(E.add(c,"goog-submenu-arrow-rtl"),Ac(c,b.Cq?"◄":"►")):(E.remove(c,"goog-submenu-arrow-rtl"),Ac(c,b.Cq?"►":"◄"))};a.ZB=function(b,c,d,e){cv.call(this,b,c,d,e||WB.U())};y(ZB,cv);a.$B=218;t=ZB.prototype;t.Vd=k;t.yA=k;t.oF=n;t.qc=k;t.Er=n;t.Cq=j;t.yQ=n;t.C=function(){ZB.n.C.call(this);this.h().e(this.getParent(),"hide",this.kH);this.qc&&aC(this,this.qc,j)};t.ab=function(){this.h().ya(this.getParent(),"hide",this.kH);this.qc&&(aC(this,this.qc,n),this.Er||(this.qc.ab(),L(this.qc.m())));ZB.n.ab.call(this)};t.z=function(){this.qc&&!this.Er&&this.qc.H();this.qc=k;ZB.n.z.call(this)};
t.wd=function(b,c){ZB.n.wd.call(this,b);c&&(this.cb().mg=j);b||(this.Vd&&Ld.clearTimeout(this.Vd),this.Vd=Od(this.Rg,$B,this))};t.Zt=function(){var b=this.getParent();b&&Xt(b)==this&&(bC(this,j),cC(this),this.d_=n)};t.Rg=function(){var b=this.qc;b&&b.getParent()==this&&(bC(this,n),Th(b,function(b){"function"==typeof b.Rg&&b.Rg()}))};a.dC=function(b){b.Vd&&Ld.clearTimeout(b.Vd);b.yA&&Ld.clearTimeout(b.yA)};t.F=function(b,c){var d=ZB.n.F.call(this,b,c);d&&!this.V()&&this.Rg();return d};
a.cC=function(b){Th(b.getParent(),function(b){b!=this&&"function"==typeof b.Rg&&(b.Rg(),dC(b))},b)};t.$b=function(b){var c=b.keyCode,d=this.Md()?37:39,e=this.Md()?39:37;if(this.oF){if(!this.cb().$b(b))if(c==e)this.Rg();else return n}else if(this.isEnabled()&&(c==d||c==this.Ty))this.Zt(),Yt(this.cb()),dC(this);else return n;b.preventDefault();return j};t.LR=function(){this.qc.getParent()==this&&(dC(this),this.om.wd(this),cC(this))};t.kH=function(b){b.target==this.om&&(this.Rg(),dC(this))};
t.nd=function(b){this.isEnabled()&&(dC(this),this.yA=Od(this.Zt,$B,this));ZB.n.nd.call(this,b)};t.ke=function(b){dC(this);if(this.Ub&8)return ZB.n.ke.call(this,b);this.Zt();return j};
a.bC=function(b,c){b.dispatchEvent(Ph(64,c));var d=b.cb();if(c!=d.V()&&(c&&(d.Da||d.aa(),d.Tb(-1)),b.oF=c,E.enable(b.m(),"goog-submenu-open",c),d.F(c),c)){var d=new cu(b.m(),b.Cq?6:4,b.yQ),e=b.cb(),g=e.m();e.V()||(g.style.visibility="hidden",Q(g,j));d.pa(g,b.Cq?4:6);e.V()||(Q(g,n),g.style.visibility="visible")}},a.aC=function(b,c,d){var e=b.h();(d?e.e:e.ya).call(e,c,"highlight",b.LR)};t.Ha=function(b){this.cb().J(b,j)};t.Si=function(b,c){this.cb().Uk(b,c,j)};
t.removeItem=function(b){(b=this.cb().removeChild(b,j))&&b.H()};t.ii=function(b){return Vh(this.cb(),b)};t.Hl=function(){return Uh(this.cb())};t.Pb=function(){return this.cb().Pb()};t.cb=function(){this.qc?this.Er&&this.qc.getParent()!=this&&Sh(this.qc,this):this.th(new fv(this.L()),j);this.qc.m()||this.qc.w();return this.qc};t.th=function(b,c){var d=this.qc;b!=d&&(d&&(this.Rg(),this.Da&&aC(this,d,n)),this.qc=b,this.Er=!c,b&&(Sh(b,this),b.F(n,j),b.gn=n,b.Ze(n),this.Da&&aC(this,b,j)))};t.Tf=function(b){return this.cb().Tf(b)};
mp("goog-submenu",function(){return new ZB(k)});a.eC=function(b,c,d,e){ZB.call(this,b,c,d,e)};y(eC,ZB);eC.prototype.$b=function(b){var c=eC.n.$b.call(this,b),b=parseInt(ok[b.keyCode],10);isNaN(b)||this.cb().Tb(b-1);return c};a.sx=function(b,c,d){T.call(this);this.oa=b;this.ta=d;this.RM=c||hh;this.Mv=k};y(sx,T);a.fC={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"};t=sx.prototype;t.Jy=function(){Bv("answer",this.wb,"read")};t.Ky=function(){Bv("answer",this.wb,/^\/question\//.test(location.pathname)?"read":"touch")};
t.C=function(){function b(){c();var b=p.Aq.ii(0);b.cb&&b.cb()&&(b.Zt(),b.cb().Tb(0))}function c(){gC(p);p.Aq.Tb(0)}sx.n.C.call(this);var d=J("zm-item-answer",this.g)||this.g;this.ta=d.getAttribute("data-aid");this.Ue="1"===d.getAttribute("data-isowner");this.wb=d.getAttribute("data-atoken");this.eh="1"===d.getAttribute("data-deleted");this.Rv=+d.getAttribute("data-created");this.FP=+d.getAttribute("data-helpful");this.wQ="1"===d.getAttribute("data-good");this.Nj="1"===d.getAttribute("data-collapsed");
this.mb=k;this.Qf=J("zm-item-answer-author-info",this.g);d=n;!R.Ia()&&0<$(this.g).parents('div[data-fixed-summary="1"]').length&&(d=j);var e={};e.Kr=!!d;d=this.eu=new Pu(e);this.J(d);d.o(this.g);d.ld()&&P(this.h(),d,"expand",this.Jy);Ou(this.g,this.Ky,this);this.nc=this.nc||J("zm-item-meta",this.g);(this.Oo=J("zm-meta-panel",this.nc))&&this.h().e(this.Oo,"click",this.km);if(this.Ue){d=$('[name="comment_opt"]',this.nc);if(d.length){var e=d.data(),g=new fv,h=new rB("禁止转载");h.Vc(!e.copyable);g.Ha(h);
g.Ha(new ev);this.Nv=[];F.forEach(fC,function(b,c){var d=new rB(b);d.Ea(c);d.Vc(c===this.Mv);this.Nv.push(d);g.Ha(d)},this);g.Ha(new ev);g.Ha(new cv("删除"));this.h().e(g,"action",this.jO);hC(this,g);E.add(g.m(),"zg-gray-normal");e=new Mz("comment",g);e.zm=j;Oz(e);e.Oy=new Rf(7,0,7,0);e.Kc=qf;e.o(d[0]);this.gZ=g}this.Qf&&(this.vH=(this.mb=Xa(this.Qf.innerHTML,"匿名用户"))?k:this.Qf.innerHTML.replace(/src=".+?"/g,'src="'+R[2]+'"'),this.h().e(this.Qf,"click",function(b){"cancel-anon"===b.target.name&&it(n)}))}else if(e=
J("zm-votebar",this.g)||J("zm-votebar",this.Oo))d=new pv(this.ta),d.o(e),this.tc=d,this.h().e(d,"change",this.HT).e(d,"action",function(b){b.data.state===qv.we?Y.Y({type:"ga_click_vote_up",target:this}):b.data.state===qv.Hg&&Y.Y({type:"ga_click_vote_down",target:this})}),(e=J("votenum-mobile",this.Oo))&&(new kx(d)).o(e);if(d=J("zm-item-vote-info",this.g)){this.Hk=new mx(this.ta);this.J(this.Hk);this.Hk.o(d);d=$(".zm-item-vote-count",this.g);d[0]||(d=$(".zm-item-vote-count",this.nc));var l=[d[0],$(".zm-votebar .count",
this.g)[0]];if(l.length){var m=this.Hk;this.Hk.on("change",function(){z.forEach(l,function(b){Fk(b,m.bb())})})}}this.vo();$(this.g).on("contentchange",$.proxy(this.vo,this));this.Yx();this.Sa();d=new UB(this.g);d=Dk.KJ(d.getItem()||this.g);Ck(Bk(Ck(Bk(Ck(Bk(Ck(Bk(Ck(Bk(Ck(Bk(Ck(Bk(d,"v",function(){this.tc&&this.tc.hB()},this),{group:"操作",name:"赞同"}),"d",function(){this.tc&&this.tc.gB()},this),{group:"操作",name:"反对"}),"f x",this.Id,this),{group:"操作",name:"分享"}),"s c",this.sx,this),{group:"操作",name:"收藏"}),
"t",this.fF,this),{group:"操作",name:"感谢"}),"c",this.tx,this),{group:"操作",name:"打开评论"}),"shift+c",this.Ol,this),{group:"操作",name:"定位到评论框"});var e=mb?"⌘":"ctrl",p=this;gh.PF&&$("a[name=admin]",this.nc)[0]&&Ck(Bk(Ck(Bk(d,"meta+.",c),{group:"管理",name:"展开菜单",key:e+"+."}),"meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});if(ub&&!Qg&&(d=J("more-actions",this.nc))){var r={share:{label:"分享",action:this.Id},fav:{label:"收藏",action:this.sx},report:{label:"举报",action:this.Yr},nohelp:{label:this.FP?"没有帮助":
"撤销没有帮助",action:this.WE}},w=new fv,e=function(b){Uh(w)&&w.Ha(new ev);var c=new cv(r[b].label);c.Ea(b);w.Ha(c)};e("share");e("fav");this.Ue||(e("nohelp"),R.Ia()&&e("report"));e=new Mz("operation",w);e.zm=j;Oz(e);e.Oy=new Rf(7,0,7,0);e.lm=ba();e.Kc=qf;e.o(d);E.add(w.m(),"zh-answer-more-actions");this.h().e(w,"action",function(b){var c=r[b.target.X()];c&&c.action&&c.action.call(this,b)})}};t.rA=function(b){var c=this.vo();c&&Fr(c,b)};
t.vo=function(){if(this.gq)return this.gq;var b=J("zm-editable-content",this.g),c=this.tc&&this.tc.m();!this.Ue&&(!ub&&R.Ia())&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.gq=new Ir(k,b),this.J(b),b.Ah="votebar",b.yz=50,b.o(c))};t.HT=function(){this.Hk&&this.Hk.jk()};
a.iC=function(b){if(!b.ye&&b.Ue&&hh&&b.ta){b.ye=new VB(n,"/answer/content","content");Vc(b,b.ye);b.ye.su=j;b.ye.pw=j;b.ye.DE=FB.prototype.DE;var c=J("zm-item-rich-text",b.g);b.ye.sd=["id="+b.oa];b.ye.o(c);b.h().e(b.ye,"shouldUpdateContent",function(b){if(ma(b.data))return n});b.h().e(b.g,"click",function(b){"suggest_edit"===b.target.name&&(this.ye.xd(),$(".zh-question-censor-tip",this.g).hide());return j})}};
t.Sa=function(){this.Qf&&this.h().e(this.Qf,"click",this.na);this.Ue&&(this.IL=R);this.h().e(Pi,"anon_change",function(b){this.Ue?this.Pt(b.mb):this.tc.de()===qv.we&&this.Hk.jk()});iC(this);$(this.g).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.qf=function(b){return Qk(this.g,b)};
t.na=function(b){if(b=(b=this.qf(b.target))&&b.name)if("edit"===b){b=yB();if(!this.qv){var c=hh.wb;b.yy=j;b.XH=c;this.h().e(b,"change",this.ez)}this.qv=j;zB(b)}else"complex"===b&&(b=J("zm-item-answer-summary",this.g),c=J("zm-item-rich-text",this.g),Q(b,n),Q(c,j))};t.ez=function(){var b=yB().Sw()||R[4]||"";if(b){var c=J("zu-question-my-bio",this.Qf);c.title=b;c.innerHTML=b}};t.Yx=function(){var b=J("zm-item-answer-author-wrap",this.g),b=J("zm-list-avatar",b);jk.add(b)};
t.Pt=function(b){b?this.Qf.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.Ue&&(this.vH?this.Qf.innerHTML=this.vH.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(iu()),b.push(ju(R,"zm-item-answer-creator")),b.push("</h3>"),this.Qf.innerHTML=
b.join("")))};
a.jC=function(b,c){if(!b.va){b.va=new Ww(b.ta,"answer",c);b.J(b.va);$w(b.va,b.nc,$(".toggle-comment",b.nc)[0]);ix(b.va);var d=location.hash.slice(1).split("-");"comment"===d[0]&&d[1]&&(b.va.Pa(j),b.h().e(b.va,"expand",function(){Yw(this.va)}))}},a.gC=function(b){if(b.Aq)b.Aq.F(j);else{var c;var d=$("a[name=admin]",b.nc)[0];if(d){b.XK=d;$B=0;c=new IB;b.J(c);c.attach(d,5);var e=b.Nj?new cv("取消折叠"):new eC("折叠");e.Ea("collapse");var g=function(b,c){var d=new cv(c+1+" "+b.label);d.Ea(b.value);e.Ha(d)};
b.Nj||Mw("answer","collapse").then(function(b){z.forEach(b,g);E.add(e.cb().m(),"manage-menu")});d=new cv("删除");d.Ea("delete");c.Ha(e);c.Ha(d);c.aa(b.g);E.add(c.m(),"manage-menu")}else c=i;c&&(JB(c,new cu(b.XK,1,j),0,new Rf(5,0,5,0)),b.h().e(c,"action",function(b){var c=b.target,b=c.X(),c=c.m(),d=new nj;if("collapse"===b)d.add("answer_id",this.ta).add("action","collapse2").add("collapse",this.Nj?"cancel":"done"),c.setAttribute("data-op",this.Nj?"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action",
"/manage?"+d.toString()),kC(this,c);else if("delete"===b)d.add("answer_id",this.ta).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),kC(this,c);else if(pa(b)){var e=$(this.g),c=new nj;c.add("answer_id",this.ta).add("action","collapse2").add("collapse",this.Nj?"cancel":"done").add("reason",b);Lw("/manage",c.toString(),function(){e.hide("fast",function(){e.remove()})})}}),hC(b,c),b.Aq=c)}},a.kC=function(b,c){(new Kw).open(c,
{id:b.ta,type:"answer"},xa(Q,b.g,n))};
t.km=function(b){var c=this.qf(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":this.tx();this.va.Ac()&&this.va.Ji("view_comments",parseInt(Ic(c),10)||0);break;case "remove":this.Ql();break;case "thanks":Y.Y({type:"ga_click_thank_answer",target:c});this.fF();break;case "comment_opt":if(!this.Mv&&(!this.aD||!this.aD.bc()))b=new V(j),P(this.h(),b,"success",function(b){if((b=Le(b.target))&&!b.r){var c=b.msg;z.forEach(this.Nv,function(b){b.X()===c&&b.Vc(j)});this.Mv=c}else U(b.msg)}),b.ajax("/answer/comment_permission?answer_id="+
this.ta,k,"GET"),this.aD=b;break;case "admin":gC(this);break;case "share":Y.Y({type:"ga_click_share_answer_box",target:c});this.Id();break;case "nohelp":this.WE(b);break;case "report":this.Yr();break;case "favo":Y.Y({type:"ga_click_collect_answer_box",target:c}),this.sx()}};t.Yr=function(){Tu("answer",this.ta)};
t.WE=rn(function(b){var b=b.target,c=!!b.m;Y.Y({type:"ga_click_answer_not_helpful",target:c?b.m():b});this.cw&&"pending"===this.cw.state()&&this.cw.abort();var d,e;e=c?b.Wg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.Gm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||Mk(b);this.cw=$.post(d,{aid:this.ta})},{Ia:"question_answer_not_helpful",Kh:j});t.Id=rn(function(){new zv(["分享回答","answer",this.wb,{aid:this.ta}],"tb-webshare-sina")},{Ia:"question_answer_share"});
t.sx=rn(function(){var b=yx(),c=this.ta;if(b.ta!==c&&b.ih){var d=Yb("zm-favo-list-item-link",b.ih);z.forEach(d,function(b){E.remove(b,"zm-favo-list-item-link-active")},b)}b.ta=c;b.show()},{Ia:"question_answer_collect",Kh:j});t.CM=function(){this.va||jC(this);this.va.yg();$(this.Oo).toggleClass("focusin",this.va.Ac())};t.tx=rn(sx.prototype.CM,function(){return{Ia:"添加评论"===$.trim($(J("toggle-comment",this.g)).text())?"question_answer_add_comment_start":n}});
t.Ol=rn(function(b){this.va&&this.va.Ac()?this.va.field.focus():this.tx();b.preventDefault()},{Ia:"question_answer_add_comment_start"});t.fF=rn(function(){var b=$("a[name=thanks]",this.nc)[0];b&&!E.has(b,"disabled")&&(Fk(b,"已感谢"),E.add(b,"disabled"),Mk(b),$.post("/answer/thanks",{aid:this.ta}))},{Ia:"question_answer_thank"});a.hC=function(b,c){b.h().e(c,"show",function(){E.add(this.nc,"zm-item-meta-has-menu")}).e(c,"hide",function(b){b.currentTarget===b.target&&E.remove(this.nc,"zm-item-meta-has-menu")})};
t.jO=function(b){var c=b.target,b=c.X();"禁止转载"===b?(b=!c.fe(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.ta,is_copyable:Number(b)}}),$(".copyright",this.nc).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.Ql():b in fC&&$.post("/answer/comment_permission",{answer_id:this.ta,permission:b}).done(v(function(b){b&&!b.r&&z.forEach(this.Nv,function(b){b.Vc(b===c)})},this))};
t.Ql=function(){Hi("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.eh=j,this.status=-1,lC(this))},this)};a.lC=function(b){var c=new V(j);P(b.h(),c,"success",function(){Q(this.g,!this.eh);this.eh?this.Ru="set_delete":(iC(this),this.Ru="cancel_delete");this.dispatchEvent("change");$(this.g).parent(".zm-item").hide()});c.ajax("/answer/"+(b.eh?"remove":"unremove"),"aid="+b.ta)};t.m=q("g");a.mC=function(b,c,d){sx.call(this,b,c,d)};y(mC,sx);mC.prototype.o=function(b){mC.n.o.call(this,b);this.Ue&&this.Pt(this.RM.mb)};mC.prototype.V=function(){return $(this.g).is(":visible")};a.nC=function(){T.call(this);this.data=hh||{};this.oa=this.data.oa;this.Do=n;this.Ti={};this.jv=[];this.Gq=[];this.ti=0;this.ng=ih&&ih.url_token?ih:k};y(nC,T);t=nC.prototype;t.B=function(){Fs.J(this);this.o(document.body)};
t.C=function(){nC.n.C.call(this);var b=I("zh-question-meta-wrap");b&&(this.PH=new SB(this.data),this.J(this.PH),this.PH.o(b));this.uo();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.wb,uid:R.No,op:"pass"})});this.To=new Sy;this.h().e(this.To,"change",this.Bz);this.To.B();this.EI()};
t.EI=function(){this.data.wb=hh.wb;oC(this,j);if(R.Ia()&&("close"!==hh.status&&(this.Qa=new Xp(this.data.Tm,this.data.oa),this.Qa.Us=5,this.Qa.Xs=1,this.Qa.ct=j,this.Qa.o(J("zm-tag-editor",this.g)),this.h().e(this.Qa,["remove_tag","add_tag"],function(){Y.Y("ga_edit_question_topic_changed")}),this.h().e(this.Qa,"start_editing",function(){Y.Y("ga_question_topic_edit_finish_changed")})),"close"!==hh.status)){this.Qd=new ny(this.data.oa,"/question/title","content",n,j);this.Qd.rr=j;this.Qd.Hd=j;this.Qd.nk=
j;var b=mu(this.data.hk);this.Qd.Co=b;this.Qd.o(I("zh-question-title"));this.h().e(this.Qd,"change",function(){Pi.dispatchEvent("question_title_change");document.title=this.Qd.ib()+" - 知乎"});this.h().e(this.Qd,"click_edit",function(){Y.Y("ga_question_title_edit_start")});this.h().e(this.Qd,"cancel_edit",function(){Y.Y("ga_question_title_edit_cancel")});this.h().e(this.Qd,"save_changed",function(){Y.Y("ga_question_title_edit_save_changed")});this.h().e(this.Qd,"save_unchanged",function(){Y.Y("ga_question_title_edit_save_unchanged")})}this.Hq=
I("zh-question-answer-num");this.Iq=I("zh-question-answer-wrap");this.Th=I("zh-question-collapsed-link");this.Bn=I("zh-question-collapsed-wrap");this.wM=I("zh-question-collapsed-num");this.AL=I("zh-question-answer-form-wrap");this.Bk=I("zh-question-notification-summary");this.Qm=I("zh-answers-filter");this.vt=I("zh-add-question-sug");this.Hq&&(this.data.ze=+this.Hq.getAttribute("data-num"));this.Iq&&(this.data.aT=+this.Iq.getAttribute("data-pagesize"));this.Th&&this.h().e(this.Th,"click",this.hV);
this.vt&&this.h().e(this.vt,"click",this.OE);this.Qm&&Vg&&this.h().e(this.Qm,"click",function(b){b.stopPropagation();E.add(this.Qm,"activated");P(this.h(),document,"click",function(){E.remove(this.Qm,"activated")})});(this.Kv=I("zg-question-suggested-topics"))&&this.h().e(this.Kv,"click",this.zR);this.to();this.h().e(window,"hashchange",function(b){b=b.Zb;b.oldURL&&"writing"===b.oldURL.split("#")[1]||pC(this)});if(b=I("zh-question-answer-wrap")){var c=new Qu({ra:["expandLimit","nodeSource"],wh:this.data.ze>
this.data.aT&&!J("question-page-pager")});this.J(c);this.h().e(c,"itemcreated",function(b){c.J(qC(this,b.item));$("img.lazy",b.item).lazyload({data_attribute:"actualsrc",threshold:400})});c.o(b)}b=R[4];jh&&jh.length&&(b=jh[0][1]);this.Db=new FB(this.data.mb,R,b);this.J(this.Db);this.Db.o(this.AL);oh&&oh.length?this.Db.Na(oh[0]):!gh.Bc&&C&&this.Db.Na("<p></p>");if(!this.data.ky&&!this.ti&&(!this.ng||!this.ng.url_token))if(this.data.hn&&this.data.hn.length&&this.data.hn[3]!==R[3])this.Db.Ya(n,"只有 "+
ju(this.data.hn)+" 能回答此问题");else if("normal"===hh.status||oh)R.hk||this.Db.xd();this.h().e(this.Db,"change",this.AR);this.h().e(this.Db,"cancel_delete_answer",this.KR);this.Db.ready(function(){var b=this.Nr();b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});rC(this);pC(this,k);sC(this);this.h().e(Pi,"anon_change",function(b){this.data.mb=b.mb});fh&&setTimeout(function(){location.href=fh},5E3)};
t.uo=function(){Bv("question",this.data.wb,"read");this.h().e(this,["click!","show!"],function(b){"comment"===b.namespace&&b.Gc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.Gc.fill("label","question_page")})};t.Bz=function(){this.BP=j;this.Bk=$(this.To.tR)[0];nc(this.Bk,I("zh-question-redirect-info"));Q(this.Bk,j);gh.Bc||(this.rj=new Ar,this.rj.o(this.Bk),bt(this.rj));this.h().e(this.Bk,"click",this.OE);pC(this)};
a.oC=function(b,c){!R.Ia()||!c?(tC(b,"zh-question-detail",ha),tC(b,"zh-question-answer-summary",ha)):(tC(b,"zh-question-detail",b.VP),tC(b,"zh-question-answer-summary",b.ZP))},a.tC=function(b,c,d){if(c=I(c)){var e=new Pu;b.h().e(e,"expand",d).e(e,"invalid",d);e.o(c)}};
t.VP=function(b){if("close"!==hh.status){b=b.target.m();this.Nb=new ny(this.data.oa,"/question/detail","content",j,k,600);var c=mu(this.data.hk);this.Nb.Co=c;this.Nb.cZ=Sk;J("zm-editable-content",b).innerHTML&&(this.Nb.nk=j);this.Nb.o(b);this.h().e(this.Nb,"click_edit",function(){Y.Y("ga_question_supplement_edit_start")});this.h().e(this.Nb,"cancel_edit",function(){Y.Y("ga_question_supplement_edit_cancel")});this.h().e(this.Nb,"save_changed",function(){Y.Y("ga_question_supplement_edit_save_changed")});
this.h().e(this.Nb,"save_unchanged",function(){Y.Y("ga_question_supplement_edit_save_unchanged")})}};t.ZP=function(b){var b=b.target.m(),c=I("zh-question-answer-summary-link"),d;if(b&&(gh.PF||!this.data.fV))d=new Zr(j,"/question/summary","content"),d.sd=["id="+this.data.oa],d.Uq=n,d.o(b);if(c){var e=I("zh-question-answer-summary-wrap");this.h().e(c,"click",function(){d&&(Q(e,j),d.xd())}).e(e,"click",function(b){"cancel"===b.target.name&&(b=!d.eg(),Q(e,!b))})}this.X_=d};
t.OE=function(b){if("close"===b.target.name){if(this.rj&&(Gr(this.rj),Fr(this.rj,n),history.replaceState)){var b=new yf(location.href),c=b.Pc();c.remove("q");c.remove("psq");history.replaceState({},"",b.sg+"?"+c.toString())}Q(this.Bk,n);Q(this.vt,n)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(Q(this.vt,n),Y.fireEvent("query_string_change")),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.qf(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),pC(this,b&&decodeURIComponent(b))};
a.sC=function(b){b.data.$q=+b.wM.innerHTML;R.Ia()||(b.data.$q=0);Q(b.Th,0<b.data.$q);b.Hq&&Ac(b.Hq,b.data.ze?b.data.ze+" 个回答":"还没有回答");b.Qm&&Q(b.Qm,1<b.data.ze);Q(b.Th,0<b.data.$q)},a.qC=function(b,c,d,e){e=new mC(b.oa,k,e);e.o(c);b.Ti[e.ta]=e;b.Gq.push(e.ta);b.h().e(e,"change",b.dz);e.Ue&&(b.ti=e.ta,e.IL=R,b.h().e(e.ye,"change",b.WO),b.Kg=e);e.Nj?e.Ue&&b.Bn.appendChild(e.m()):b.jv.push({added_time:e.Rv,vote:d,aid:e.ta});e.eh&&Q(e.m(),n);return e};
t.WO=function(){var b=this.Kg,c=b.m(),d=b.ye.ib()[0];Q(c,n);d=ic(La(d));mc(d,c);this.Ti[b.ta]=k;this.Gq=z.filter(this.Gq,function(c){return c!==b.ta},this);var e=999;this.jv=z.filter(this.jv,function(c){c.aid===b.ta&&(e=c.vote);return c.aid!==b.ta},this);L(c);b.H();qC(this,d,e,n)};
t.dz=function(b){b=b.target;if(b instanceof mC){var c=b.m();switch(b.Ru){case "collap":this.Bn.appendChild(c);E.add(c,"zm-item-collapsed");this.data.ze--;sC(this);break;case "cancel_collap":this.Iq.appendChild(c);E.remove(c,"zm-item-collapsed");uC(this,c);this.data.ze++;sC(this);break;case "set_delete":rC(this);this.data.ze--;sC(this);break;case "cancel_delete":uC(this,this.Ti[this.ti].m()),rC(this),this.data.ze++,sC(this)}}};
a.rC=function(b){var c=k,d=k,e,g={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!oh&&"normal"!==hh.status&&(d="被"+g[hh.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.ti?(e=b.Ti[b.ti],c="#answer-"+e.ta,e=e.eh):b.ng&&(c="/question/"+hh.wb+"/answer/"+b.ng.url_token,e=b.ng.is_delete);c&&(d=e?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="'+
c+'">现有的回答</a> 进行修改');R.hk&&(!b.ti&&!b.ng)&&(d='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');b.data.ky&&(d='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');d&&b.Db.Ya(n,d)};t.wE=function(b){return this.Ti[b]};a.vC=function(b,c){var d=I("zh-question-collapsed-switcher");c?(d.name="collap",b.bD=j,Q(b.Bn,j),E.add(b.Th,"zu-question-collap-title-active")):(b.bD=n,d.name="expand",Q(b.Bn,n),E.remove(b.Th,"zu-question-collap-title-active"))};
t.hV=function(b){if((b=Qk(this.Th,b.target))&&b.name)if("expand"===b.name){if(!this.yM){this.yM=j;var c=this,d=this.Bn,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.oa}});b.done(function(b){b=ic(b);vC(c,j);E.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);z.forEach(rc(d),function(b){b!==e&&qC(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=rc(d)[0];e&&(Q(e,n),b.done(function(){Q(e,j)}));Q(d,j);E.add(d,"zm-question-collapsed-list-loading")}vC(this,
j)}else vC(this,n)};t.KR=function(){var b=this.Ti[this.ti],c;b?(b.eh=n,b.status=0,lC(b),uC(this,b.m())):(c=this.ng,b=new V(j),P(this.h(),b,"success",function(){window.location.href="/question/"+hh.wb+"/answer/"+c.url_token}),b.ajax("/answer/unremove","aid="+c.id))};
t.AR=function(){var b=this.Db.Fq.checked,c={HG:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.bc()){var c=this.Db.eg();if(c){var d=new V(j),h=new nj,l=b?1:0;h.add("id",this.oa).add("content",c).add("anon",l);d.on("success",function(){hh.mb!==l&&Pi.dispatchEvent(new at(l));var b=Le(this.xhr);b&&!b.r?(b=ic(La(b.msg[0])),this.Iq.appendChild(b),qC(this,b,this.Gq.length,j),rC(this),hh.mb||(this.oR=new qB(this.Ti[this.ti]),this.oR.show()),R.AN&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),
this.data.ze++,sC(this)):U(b.msg)},n,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);hh.mb&&!b?Hi(c,function(b){b&&d()}):d()};t.qf=ba();t.zR=function(b){if((b=this.qf(b.target))&&b.name){var c=b.name;"close"===c?Q(this.Kv,n):"addtag"===c&&(this.Qa.df(b.id.split("-")[1],b.innerHTML),Q(b,n))}};t.to=function(){this.DA=new sB(this.oa);this.DA.B()};
a.pC=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.wE(e))&&(d.Nj&&!b.bD?uC(b,b.Th):uC(b,d.m()))}},a.uC=function(b,c){if(c){var d=Ag(document.body).top,e=b.BP?rg(b.Bk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.EJ=Et;Dt(c,d);Mk(c);b.rj&&b.rj.aq()}};a.wC=function(){nC.call(this);this.data=hh;this.oa=this.data.oa};y(wC,nC);t=wC.prototype;
t.EI=function(){(this.sr=I("zh-single-answer-disable-wrap"))&&this.h().e(this.sr,"click",this.bU);this.Xl();this.to();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){tn(this,"favlist")});oC(this,n);if(b=$("#zh-question-answer-collections > .zh-general-list").get(0)){var c=new Qu({ra:["autoload","nodeSource"]});this.J(c);c.o(b)}if(b=$(".awesome-answer-list").get(0)){var d=new Qu({ra:["expandLimit"],wh:n});this.J(d);this.h().e(d,"itemcreated",function(b){var c=
new px;c.o(b.item);d.J(c)});d.o(b)}};t.uo=function(){this.h().e(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.Gc.fill("label","answer_page")});wC.n.uo.call(this)};t.bU=function(b){b.target&&b.target.name&&(b=this.Xb,b.eh=n,b.status=0,lC(b))};
t.Xl=function(){var b=J("zm-item-answer",I("zh-question-answer-wrap"));if(b){this.Xb=new mC(this.oa);this.J(this.Xb);this.Xb.o(b);b=this.h();b.e(this.Xb,"change",this.dz);if(this.Xb.Ue){b.e(Pi,"anon_change",function(b){var c=b.mb,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=z.reduce(R,function(b,c,d){b[g[d]]=c;return b},{}),c=Xk(this.JL,{author:!c&&h});b.html(c)}});var c=this.Xb.ye;c&&b.e(c,"change",function(){var b=
La(c.ib()[0]),b=ic(b);pc(b,this.Xb.g);this.Xl(b)})}xC(this);jC(this.Xb,{autofocus:n,nG:j})}};t.wE=function(b){if(this.Xb.ta===b)return this.Xb};t.JL='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.to=function(){this.DA=new sB(this.oa,this.Xb);this.DA.B();var b=I("js-sidebar-author-info");b&&(new Iy(b)).B()};t.dz=function(b){b=b.target;if(b instanceof mC)switch(b.Ru){case "collap":E.add(b.m(),"zm-item-collapsed");break;case "cancel_collap":E.remove(b.m(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":xC(this),location.reload()}};
a.xC=function(b){b.Xb?b.Xb.eh?(b.sr.innerHTML=b.Xb.Ue?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",Q(b.Xb.m(),n)):Q(b.Xb.m(),j):b.sr.innerHTML="此答案已经被作者删除"};a.yC=function(){T.call(this);this.page=1};y(yC,T);yC.prototype.B=function(){var b=J("js-topic-feed-page");this.o(b)};
yC.prototype.C=function(){yC.n.C.call(this);var b=this;this.CB=$(".js-topic-feed-container",this.g);this.CB.find(".js-topic-item").each(function(){var c=new zC;b.J(c);c.o(this)});this.nt=new AC;this.nt.o($(".js-pinned-topics",this.element)[0]);(this.cc=I("js-load-more"))&&this.h().e(this.cc,"click",this.nz);$(".instruction .close-normal").click(function(){var b=new V(n);b.ajax("/notifeature?feature=6",k,"GET");Ad(b,"success",function(){$(".instruction").fadeOut()})});this.h().e(this.nt,"change",function(b){$("#tf-"+
b.fJ).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')})};a.BC=function(b,c){Ac(b,c?"加载中...":"更多")};yC.prototype.nz=function(){BC(this.cc,j);this.xhr=new V(j);P(this.h(),this.xhr,"complete",v(this.Af,this));var b=new Rk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.Pc())};
yC.prototype.Af=function(){var b=this,c=Le(this.xhr);c&&!c.r&&(0<c.msg.length?($(c.msg).each(function(c,e){var g=new zC;b.J(g);g.o($(e)[0]);b.CB.append(g.m())}),BC(this.cc,n)):$(this.cc).hide())};a.zC=function(){T.call(this)};y(zC,T);zC.prototype.C=function(){zC.n.C.call(this);this.h().e(this.g,"click",v(this.bz,this))};
zC.prototype.bz=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.g).find(".topic-avatar img"),e=d.clone(),g,h=$(this.g).data("id");if("pin-topic"===b)g=this.getParent().nt,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.g).append($(this.ST({topic:b.msg})).hide().fadeIn()),CC(this)):U(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){Mk(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');
var b=d.offset(),h=$(g.g).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.g).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()})}});else if("unpin-topic"===b){var l=this.getParent().nt,m=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0];Mk(b)},p=$(l.g).find("[data-topicid="+h+"]");p.fadeOut(function(){p.remove();l.fu().done(function(){m&&m()});l.dispatchEvent({type:"change",fJ:p.attr("data-topicid")})})}else if("follow"===b||"unfollow"===b)tn(c,"topic",k,["follow","unfollow"]),
$(this.g).fadeOut()};a.AC=function(){T.call(this)};y(AC,T);AC.prototype.ST=Xk('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
AC.prototype.C=function(){AC.n.C.call(this);this.h().e(this.g,"click",v(this.bz,this));CC(this)};a.CC=function(b){b.Xf&&b.Xf.H();var c=new dm;c.wr="pin-topic-moving";em(c,b.g,0);c.B();b.h().e(c,"dragend",v(b.fu,b));b.Xf=c;$("a",b.g).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})})};
AC.prototype.bz=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.g).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.g);c.fu()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.fu();c.dispatchEvent({type:"change",fJ:g.attr("data-topicid")})})}else b.stopPropagation()};
AC.prototype.fu=function(){var b=[];$(this.g).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.DC=function(){T.call(this);this.cE="even";this.Hn="current"};y(DC,T);t=DC.prototype;t.B=function(){Fs.J(this);this.o(document.body)};
t.C=function(){DC.n.C.call(this);this.Cu=$("ul.zm-topic-cat-main").children();var b=this.Ad=$("div.zh-general-list"),c=new Qu({ra:["autoload","nodeSource"]});this.J(c);c.o(b.get(0));this.h().e(c,"next",this.Bq);this.iG=c;b.on("click","a.follow",function(){tn(this,"topic",xa(Mk,this),k,{follow_text:"关注"})});N(window,"hashchange",this.fH,n,this);this.fH()||(b.show(),this.Bq())};
t.Bq=function(){var b=this.Ad.show().children();if(!b.length)return this.Ad.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.cE);b.filter(":odd").addClass(this.cE);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.Qr(),c=b.params&&b.params.topic_id,b=this.Cu.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.Hn).siblings().removeClass(this.Hn)};
t.Qr=function(){return this.Ad.data("init")};t.fH=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.Cu.filter(function(){return $(this).text()===c}),b.length&&this.Cu.filter("."+this.Hn).text()!==c)){b.addClass(this.Hn).siblings().removeClass(this.Hn);b={params:{topic_id:b.data("id")}};var d=this.Qr();$.extend(j,d,b);this.Ad.attr("data-init",JSON.stringify(d));this.Ad.empty();this.iG.aj();this.iG.Dy();b=j;break a}b=i}return b};a.EC=function(){T.call(this)};y(EC,T);EC.prototype.B=function(){Fs.J(this);this.o(document.body)};EC.prototype.C=function(){EC.n.C.call(this);FC(this,"zh-global-logs-wrap");FC(this,"zh-global-logs-questions-wrap");FC(this,"zh-question-log-list-wrap")};a.FC=function(b,c){var d=I(c);if(d){var e=new Qu;b.J(e);e.ra("locationSource",{gp:j});e.o(d);dy(d)}};a.GC=function(){T.call(this)};y(GC,T);GC.prototype.B=function(){Fs.J(this);this.o(document.body)};GC.prototype.C=function(){GC.n.C.call(this);this.so("zh-question-followers-list-wrap")};GC.prototype.so=function(b){if(b=I(b)){var c=new Qu;this.J(c);c.ra("locationSource");c.o(b)}};a.HC=function(){};HC.prototype.B=function(){var b=I("zh-invited-member-list");b&&(new iy(b,"/invitation/more","people",["zg-btn-follow","zg-btn-unfollow"],j)).B();(b=I("zh-invited-sina-member-list"))&&(new iy(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j)).B();I("zh-sina-invite")&&(new Hy).B();new Zl(I("invite_friend"))};a.IC=function(b,c){var d=this.G={};F.extend(d,this.R,c||{});this.input=b;this.Lb=d.Lb;this.Bh=this.fT();this.Bv=[];this.Bv.push({action:"remove",method:this.LT,Sv:d.IT,T:"删除"});setTimeout(v(this.Ig,this))};y(IC,Kd);
ya(IC.prototype,{R:{source:"/topic/autocomplete",Lb:k,ZM:"",Wq:n,vJ:"/topic/%s",Ch:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{Et:j,id:c.data("id"),url:b.href,name:c.text()}},FU:qf,nN:"canedit",ow:"empty",vn:"button",IT:"remove-button"},kV:function(b){return Lu(this.G.vJ,b.url_token)},has:function(b){return!!z.find(this.Bh,function(c){return c.name===b.name||c.id===b.id})},kE:function(b){return z.find(this.Bh,function(c){return c.name===
b})},zZ:function(b){return z.find(this.Bh,function(c){return c.id===b})},Te:function(){var b=!!rc(this.Lb).length;E.enable(this.Lb,this.G.ow,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.Bh.push(b),b.Et=n,c||this.G.FU.call(this,b)))this.QT(b),b.Et=j,this.dispatchEvent("add"),this.Te()},remove:function(b){this.Bh=z.filter(this.Bh,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Te()},XN:function(){return z.filter(this.Bh,function(b){return b.Et!==
n})},jx:function(){return z.map(this.XN(),function(b){return b.id})},QT:function(b){b=ic(this.cI(b));this.Lb.appendChild(b);this.ie(b)},cI:function(b){return Xk(this.G.Ch,b)},aa:function(){this.Lb.innerHTML=z.map(this.Bh,this.cI,this).join("")},fT:function(){return z.map(this.HE(),this.G.parse)},HE:function(){return rc(this.Lb)},Ig:function(){var b=this,c=b.G,d=this.input,e={source:c.source,lk:Kc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.kV(d),avatar:d.avatar,url_token:d.url_token});return c.ZM},filter:function(d){return z.filter(d,function(d){return c.Wq&&!d.id?n:!z.find(b.Bh,function(b){return b.Et&&b.id===d.id})})}},g={dd:function(b,c,d){d.innerHTML=l(b.data)}};F.extend(g,e||{});var h=new Rp(d,g);N(h,"show",function(){1<h.Xa.length&&!h.Xa[0].id&&wm(h)});var l=Xk('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.W=h;z.forEach(this.HE(),this.ie,this);N(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.Wq&&(e=La(this.value))&&!b.W.sb())b.add(b.kE(e)||{id:k,name:e,url:"/topic/"+e})});this.Te()},LT:function(b){this.remove($(b).remove().data("id"))},iT:function(b,c){var d=z.find(this.Bv,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},ie:function(b){var c=this.G;E.add(b,c.nN);z.forEach(this.Bv,function(d){var e=new vp(" ",Ep.U());e.Mh([c.vn,d.Sv].join(" "));
e.aa(b);e.Ya(j);e.Wc(d.T);e.addEventListener("action",function(){this.iT(d.action,b)},n,this)},this)}});a.JC=function(){this.FB=this.GB=k};
JC.prototype.B=function(){function b(b,c){var g=K("li"),h=K("span","item-label",b);g.appendChild(h);var l=new vp("",Ep.U());l.Mh("zm-profile-tag-btn zm-profile-tag-btn-del");l.Ya(j);l.Wc("移除动作");l.Ea(c);l.addEventListener("action",function(){var b=l.X();e(b,n);L(g);X.Bt(j);d()});l.aa(g);Oa.appendChild(g)}function c(){ja.F(X.Hl()!==z.filter(X.Pb(),function(b){return!!(b.da&8)}).length)}function d(){z.forEach(S,function(b){b.selected||(b=new jz(b.text,b.value),X.Ha(b))});c()}function e(b,c){var d=z.find(S,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(m.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){p=H.jx();G.val(p.join(","))}var l=$("#rq-settings-ui"),m=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var p=[];this.FB=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();l.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),w=$("input.topic-input",r).get(0),B=$("ul.tag-list",r).get(0),H=new IC(w,{Wq:j,Lb:B}),G=$('input[name="topics"]',r);H.on("change",h);m.on("change",g);h();g();r=m.get(0);Q(r,n);var S=r.options,X=new fv;X.on("action",function(d){d=d.target;b(d.Wg(),d.X());e(d.X(),j);X.removeItem(d);c()});var ja=new Mz("添加动作",X);ja.Mh("menu-button");ja.aa(r.parentNode);ja.zm=j;Oz(ja);var Oa=K("ul","display-list");d();z.forEach(S,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Oa,ja.m());var Qa=this,r=$("#rq3-item-list"),Va={pV:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},yT:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Va.yT(c);c=oe.text()||0;0<c&&oe.text(c-1);var d=Qa.FB,e=Number(Qa.GB.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Va.pV(c),b.addClass("thanked").text("已感谢"))});dy(r);r=new gv(r.get(0),location.href,j);r.CH=function(b){return b.getAttribute("data-id")};r.sh("rq-item");r.B();var r=$("#rq3-sidenav-link"),oe=$(".zg-num",r);this.GB=oe};a.KC=function(){};KC.prototype.B=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.LC=function(){};y(LC,T);LC.prototype.B=function(){Fs.J(this);this.o(document.body)};LC.prototype.C=function(){LC.n.C.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new Qu;this.J(c);c.ra("nodeSource");c.o(b.get(0))}};a.MC=function(){T.call(this)};y(MC,T);MC.prototype.C=function(){this.h().e(this.g,"click",this.Xo)};MC.prototype.Xo=function(b){var c=b.target;c&&"rmdraft"===c.name&&Hi("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Ji("/answer/draft/delete",k,"POST","qid="+c.id.split("-")[1]),L(this.g))},this)};a.NC=function(){};y(NC,T);NC.prototype.B=function(){var b=I("zh-draft-page-wrap");b&&this.o(b)};
NC.prototype.C=function(){N(I("zh-clear-all-draft"),"click",function(){Hi("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&(window.location.href="/draft/clear")});return n});this.so()};NC.prototype.so=function(){var b=I("zh-draft-item-list");if(b){var c=new Qu;c.ra("locationSource",{gp:j}).ra("childConstructor",{dj:MC});c.o(b)}};a.OC=function(){this.nh="explore";this.yN="explore_feed"};y(OC,T);OC.prototype.B=function(){Fs.J(this);this.o(document.body)};
OC.prototype.C=function(){OC.n.C.call(this);var b=this,c=$("#js-explore-tab");if(c.length){var d=$(".tab-panel",c),e=$(".tab-nav",c),g=k;e.children().click(function(){g=cc(document)});c=function(){var c={"daily-hot":0,"monthly-hot":1}[window.location.hash.slice(1)]||0;e.removeClass("active").eq(c).addClass("active");c=d.hide().eq(c).show().children("[data-type]");if(!c.data("inited")){c.data("inited",j);var h={daily:Py,monthly:Ry}[c.data("type")],h=new PC(h);h.ra("expandLimit");b.J(h);h.o(c[0])}g&&
window.scrollTo(g.x,g.y)};this.h().e(window,"hashchange",c);c()}this.$x();if(c=$("#zh-recommend-list-full>.zh-general-list")[0]){var h=new Qu;h.ra("nodeSource");Iu(h,function(b){var c=ux(b);c&&(h.J(c),c.o(b))});this.J(h);h.o(c)}this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category",this.nh).fill("label",this.yN)})};OC.prototype.$x=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=Qy(b).done(function(b){c.html(b)}))})};
a.PC=function(b){Hu.call(this,{source:function(){return b($(this.Pb()).last().data("offset")).then(function(b){return{results:b}})},ra:["autoload"]})};y(PC,Qu);PC.prototype.C=function(){PC.n.C.call(this);this.ra("childConstructor",{dj:px})};a.QC=function(){T.call(this)};y(QC,T);QC.prototype.B=function(){Fs.J(this);this.o(document.body)};QC.prototype.C=function(){QC.n.C.call(this);this.so()};QC.prototype.so=function(){var b=I("js-suggest-people");if(b){var c=0,d=new Qu({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.J(d);d.o(b)}};a.SC=function(b,c,d){T.call(this,d);this.If=c||zj;this.HJ=this.If.YB;this.ba=new Cj(b);this.ba.yl=this.If.Lu;this.ba.Ug=this.If.Ku;this.Ic=this.ba.clone();this.Ic.setDate(1);this.wu="      ".split(" ");this.wu[this.If.Qu[0]]=RC()+"-wkend-start";this.wu[this.If.Qu[1]]=RC()+"-wkend-end";this.am={}};y(SC,T);t=SC.prototype;t.vA=j;t.MU=j;t.wN=j;t.BA=j;t.JI=j;t.Dq=j;t.zA=j;t.LI=n;t.HD=k;t.zr=k;t.kw=k;t.dM=Mh.U();
a.RC=function(){return"goog-date-picker"},a.TC=function(b){Q(b.nw,b.zA);Q(b.mw,b.Dq);Q(b.XI,b.zA||b.Dq)};t.KH=function(){this.Ic.add(new qt("m",-1));UC(this)};t.QG=function(){this.Ic.add(new qt("m",1));UC(this)};t.qT=function(){this.Ic.add(new qt("y",-1));UC(this)};t.sR=function(){this.Ic.add(new qt("y",1));UC(this)};t.rI=function(){this.setDate(new Cj)};t.pI=function(){this.Dq&&this.setDate(k)};t.getDate=function(){return this.ba&&this.ba.clone()};
t.setDate=function(b){var c=b!=this.ba&&!(b&&this.ba&&b.getFullYear()==this.ba.getFullYear()&&b.getMonth()==this.ba.getMonth()&&b.getDate()==this.ba.getDate());this.ba=b&&new Cj(b);b&&(this.Ic.set(this.ba),this.Ic.setDate(1));UC(this);this.dispatchEvent(new VC("select",this,this.ba));c&&this.dispatchEvent(new VC("change",this,this.ba))};
a.XC=function(b){if(b.zr){for(var c=b.zr;c.firstChild;)c.removeChild(c.firstChild);var d,e;if(b.LI)d=b.K.createElement("td"),d.colSpan=b.BA?1:2,WC(b,d,"«",b.KH),c.appendChild(d),d=b.K.createElement("td"),d.colSpan=b.BA?6:5,d.className=RC()+"-monthyear",c.appendChild(d),b.lw=d,d=b.K.createElement("td"),WC(b,d,"»",b.QG),c.appendChild(d);else{var g=b.If.OB[0].toLowerCase();d=b.K.createElement("td");d.colSpan=5;WC(b,d,"«",b.KH);b.nj=WC(b,d,"",b.KU,RC()+"-month");WC(b,d,"»",b.QG);e=b.K.createElement("td");
e.colSpan=3;WC(b,e,"«",b.qT);b.Rn=WC(b,e,"",b.PU,RC()+"-year");WC(b,e,"»",b.sR);g.indexOf("y")<g.indexOf("m")?(c.appendChild(e),c.appendChild(d)):(c.appendChild(d),c.appendChild(e))}}};
t.$=function(b){SC.n.$.call(this,b);b.className=RC();var c=this.K.createElement("table"),d=this.K.createElement("thead"),e=this.K.createElement("tbody"),g=this.K.createElement("tfoot");Qc(e,"grid");e.tabIndex="0";this.WA=e;this.XI=g;var h=this.K.createElement("tr");h.className=RC()+"-head";this.zr=h;XC(this);d.appendChild(h);var l;this.mf=[];for(var m=0;7>m;m++){h=this.K.createElement("tr");this.mf[m]=[];for(var p=0;8>p;p++){l=this.K.createElement(0==p||0==m?"th":"td");if((0==p||0==m)&&p!=m)l.className=
0==p?RC()+"-week":RC()+"-wday",Qc(l,0==p?"rowheader":"columnheader");h.appendChild(l);this.mf[m][p]=l}e.appendChild(h)}h=this.K.createElement("tr");h.className=RC()+"-foot";l=this.kw=h;lc(l);m=this.K.createElement("td");m.colSpan=2;m.className=RC()+"-today-cont";p=x("Today");this.nw=WC(this,m,p,this.rI);l.appendChild(m);m=this.K.createElement("td");m.colSpan=4;l.appendChild(m);m=this.K.createElement("td");m.colSpan=2;m.className=RC()+"-none-cont";p=x("None");this.mw=WC(this,m,p,this.pI);l.appendChild(m);
TC(this);g.appendChild(h);c.cellSpacing="0";c.cellPadding="0";c.appendChild(d);c.appendChild(e);c.appendChild(g);b.appendChild(c);YC(this);UC(this);b.tabIndex=0};t.w=function(){SC.n.w.call(this);this.$(this.m())};t.C=function(){SC.n.C.call(this);var b=this.h();b.e(this.WA,"click",this.FO);b.e(ZC(this,this.m()),"key",this.GO)};t.ab=function(){SC.n.ab.call(this);this.nl();for(var b in this.am)this.am[b].H();this.am={}};t.create=SC.prototype.o;
t.z=function(){SC.n.z.call(this);this.mw=this.nw=this.Rn=this.lw=this.nj=this.kw=this.zr=this.XI=this.WA=this.mf=k};t.FO=function(b){if("TD"==b.target.tagName){var c,d=-2,e=-2;for(c=b.target;c;c=c.previousSibling,d++);for(c=b.target.parentNode;c;c=c.previousSibling,e++);this.setDate(this.Nl[e][d].clone())}};
t.GO=function(b){var c,d;switch(b.keyCode){case 33:b.preventDefault();c=-1;break;case 34:b.preventDefault();c=1;break;case 37:b.preventDefault();d=-1;break;case 39:b.preventDefault();d=1;break;case 38:b.preventDefault();d=-7;break;case 40:b.preventDefault();d=7;break;case 36:b.preventDefault(),this.rI();case 46:b.preventDefault(),this.pI();default:return}this.ba?(b=this.ba.clone(),b.add(new qt(0,c,d))):(b=this.Ic.clone(),b.setDate(1));this.setDate(b)};
t.KU=function(b){b.stopPropagation();for(var b=[],c=0;12>c;c++)b.push(this.If.bn[c]);$C(this,this.nj,b,this.TO,this.If.bn[this.Ic.getMonth()])};t.PU=function(b){b.stopPropagation();for(var b=[],c=this.Ic.getFullYear()-5,d=0;11>d;d++)b.push(String(c+d));$C(this,this.Rn,b,this.xP,String(this.Ic.getFullYear()))};t.TO=function(b){for(var c=-1;b;b=uc(b),c++);this.Ic.setMonth(c);UC(this);this.nj.focus&&this.nj.focus()};
t.xP=function(b){3==b.firstChild.nodeType&&(this.Ic.setFullYear(Number(b.firstChild.nodeValue)),UC(this));this.Rn.focus()};
a.$C=function(b,c,d,e,g){b.nl();var h=b.K.createElement("div");h.className=RC()+"-menu";b.fm=k;for(var l=b.K.createElement("ul"),m=0;m<d.length;m++){var p=b.K.w("li",k,d[m]);d[m]==g&&(b.fm=p);l.appendChild(p)}h.appendChild(l);h.style.left=c.offsetLeft+c.parentNode.offsetLeft+"px";h.style.top=c.offsetTop+"px";h.style.width=c.clientWidth+"px";b.nj.parentNode.appendChild(h);b.la=h;b.fm||(b.fm=l.firstChild);b.fm.className=RC()+"-menu-selected";b.Ny=e;c=b.h();c.e(b.la,"click",b.RE);c.e(ZC(b,b.la),"key",
b.SE);c.e(b.K.za(),"click",b.nl);h.tabIndex=0;h.focus()};t.RE=function(b){b.stopPropagation();this.nl();this.Ny&&this.Ny(b.target)};
t.SE=function(b){b.stopPropagation();var c,d=this.fm;switch(b.keyCode){case 35:b.preventDefault();c=d.parentNode.lastChild;break;case 36:b.preventDefault();c=d.parentNode.firstChild;break;case 38:b.preventDefault();c=d.previousSibling;break;case 40:b.preventDefault();c=d.nextSibling;break;case 13:case 9:case 0:b.preventDefault(),this.nl(),this.Ny(d)}c&&c!=d&&(d.className="",c.className=RC()+"-menu-selected",this.fm=c)};
t.nl=function(){if(this.la){var b=this.h();b.ya(this.la,"click",this.RE);b.ya(ZC(this,this.la),"key",this.SE);b.ya(this.K.za(),"click",this.nl);L(this.la);delete this.la}};
a.WC=function(b,c,d,e,g){var h=[RC()+"-btn"];g&&h.push(g);g=b.K.createElement("button");g.className=h.join(" ");g.appendChild(b.K.createTextNode(d));c.appendChild(g);b.h().e(g,"click",function(b){b.preventDefault();e.call(this,b)});return g},a.UC=function(b){if(b.m()){var c=b.Ic.clone();c.setDate(1);b.lw&&Ac(b.lw,x("{$monthName} {$yearNum}",{monthName:b.If.bn[c.getMonth()],yearNum:c.getFullYear()}));b.nj&&Ac(b.nj,b.If.bn[c.getMonth()]);b.Rn&&Ac(b.Rn,String(c.getFullYear()));var d=((c.getDay()+6)%
7-c.Ug+7)%7,e=Aj(c.getFullYear(),c.getMonth());c.add(new qt("m",-1));c.setDate(Aj(c.getFullYear(),c.getMonth())-(d-1));b.vA&&(!b.wN&&33>e+d)&&c.add(new qt("d",-7));d=new qt("d",1);b.Nl=[];for(e=0;6>e;e++){b.Nl[e]=[];for(var g=0;7>g;g++)b.Nl[e][g]=c.clone(),c.add(d)}if(b.m())for(var c=b.Ic.getMonth(),g=new Cj,d=g.getFullYear(),e=g.getMonth(),g=g.getDate(),h=0;6>h;h++){if(b.BA){var l=b.mf[h+1][0],m;m=b.Nl[h][0];var p=m.getDate(),p=new Date(m.getFullYear(),m.getMonth(),p),r=m.Ug||0;m=p.valueOf()+864E5*
(((m.yl||3)-r+7)%7-((p.getDay()+6)%7-r+7)%7);m=Math.floor(Math.round((m-(new Date((new Date(m)).getFullYear(),0,1)).valueOf())/864E5)/7)+1;Ac(l,m);E.set(b.mf[h+1][0],RC()+"-week")}else Ac(b.mf[h+1][0],""),E.set(b.mf[h+1][0],"");for(l=0;7>l;l++){m=b.Nl[h][l];p=b.mf[h+1][l+1];p.id||(p.id=Nh(b.dM));Qc(p,"gridcell");r=[RC()+"-date"];if(b.MU||m.getMonth()==c){m.getMonth()!=c&&r.push(RC()+"-other-month");var w=(l+b.Ic.Ug+7)%7;b.wu[w]&&r.push(b.wu[w]);m.getDate()==g&&(m.getMonth()==e&&m.getFullYear()==d)&&
r.push(RC()+"-today");b.ba&&(m.getDate()==b.ba.getDate()&&m.getMonth()==b.ba.getMonth()&&m.getFullYear()==b.ba.getFullYear())&&(r.push(RC()+"-selected"),Rc(b.WA,"activedescendant",p.id));b.HD&&(w=b.HD(m))&&r.push(w);Ac(p,m.getDate())}else Ac(p,"");E.set(p,r.join(" "))}4<=h&&Q(b.mf[h+1][0].parentNode,b.Nl[h][0].getMonth()==c||b.vA)}}},a.YC=function(b){if(b.m()){if(b.JI)for(var c=0;7>c;c++)Ac(b.mf[0][c+1],b.HJ[((c+b.Ic.Ug+7)%7+1)%7]);Q(b.mf[0][0].parentNode,b.JI)}},a.ZC=function(b,c){var d=ua(c);d in
b.am||(b.am[d]=new gl(c));return b.am[d]},a.VC=function(b,c,d){kd.call(this,b,c);this.WM=d};y(VC,kd);a.aD=function(b){T.call(this);F.extend(this.G={},this.R,b||{});this.Wf=new It};y(aD,T);a.bD=void 0;a.cD=document.createElement("input");try{cD.type="datetime",bD="datetime"===cD.type}catch(dD){bD=n}t=aD.prototype;t.R={iR:5,VV:j,XV:n};t.Te=function(){if(this.mt){var b;(b=uu(this.Kn.value))?(b.setHours(this.gs.value),b.setMinutes(this.Ys.value)):b=k;this.Wf=b;eD(this)}this.dispatchEvent("change")};a.eD=function(b){b.g.value=b.Wf?Jt(b.Wf):"null"};t.nB='<div class="ui-datetime-picker"><input id="date" class="date text" type="text"><select class="hour"></select><span class="colon">:</span><select class="minute"></select></div>';
t.Q=function(b,c,d){return O.toArray(O.wm(b,c,d))};t.nv=function(){this.h().e(this.ll,"change",function(b){if(b=b.WM)this.Kn.value=b.Dk(j),this.Te(),Q(this.ll.m(),n)}).e(this.Kn,"focus",function(){Q(this.ll.m(),j)}).e(this.Kn,"blur",function(){var b=this;setTimeout(function(){b.ll.m().contains(document.activeElement)||Q(b.ll.m(),n)})}).e(this.gs,"change",function(){this.Te()}).e(this.Ys,"change",function(){this.Te()})};t.z=function(){L(this.mt);Q(this.g);aD.n.z.call(this)};
t.$=function(b){aD.n.$.call(this,b);if(!this.G.VV||!bD){Q(b,n);var c=this.mt=ic(this.nB),d=this.K.fi;this.Kn=d("date",c);this.gs=d("hour",c);this.Ys=d("minute",c);c=this.mt;zj=vu;d=this.ll=new SC;d.setDate(this.Wf);d.Dq=n;d.mw&&TC(d);d.zA=n;d.nw&&TC(d);d.vA=n;UC(d);d.HJ=d.If.RB;YC(d);d.LI=j;XC(d);UC(d);d.aa(c);Q(this.ll.m(),n);var e=this.gs;z.forEach(this.Q(0,24,i),function(b){b=this.K.w("option",{value:b},String(b));e.appendChild(b)},this);var g=this.Ys;z.forEach(this.Q(0,60,this.G.iR),function(b){b=
this.K.w("option",{value:b},bb(b));g.appendChild(b)},this);this.nv();c=b.value;this.Wf=oa(c)?uu(c):new It(c||za());this.G.XV||this.Wf.setSeconds(0);this.Wf&&(this.gs.value=this.Wf.getHours(),this.Ys.value=this.Wf.getMinutes(),c=Jt(this.Wf),this.Kn.value=c.slice(0,10));eD(this);this.dispatchEvent("change");mc(this.mt,b)}};a.fD=function(b,c){T.call(this);this.me=b||{};this.Qy=c||{};this.Tm=this.Qy.topics||[];this.aM=this.Qy.canAdminister;this.xT=this.Qy.questions||[];this.nh="roundtable"};y(fD,T);t=fD.prototype;
t.B=function(){Fs.J(this);this.o(document.body);this.uo();var b=v(function(){var b=z.toArray(arguments),c=b.shift(),d=b.shift(),d=$(d);b.unshift(d);d.length&&c.apply(this,b)},this);b(this.XP,"#js-rt-pending-questions");b(this.YP,"#js-roundtable-search-box");b(this.FF,"#js-roundtable-followers > .zh-general-list");b(this.FF,"#js-rt-question-paged > .zh-general-list",this.GF);var c=this;$("#js-personal-answers .zm-item, #js-hot-answers .zm-item").each(function(){var b=ux(this);c.J(b);b.o(this);c.EF(this)});
if(b=$("#js-hot-answers-paged > .zh-general-list")[0]){var d=new Qu;this.J(d);d.ra("nodeSource");d.ra("childConstructor",{factory:ux});Iu(d,this.EF,this);d.o(b)}b=$("#js-rt-webshare-links");b.data();var e=this.me;$("a",b).click(function(){new zv(["分享活动","roundtable",e.url_token,{roundtable_id:e.id}],"tb-webshare-"+this.name);Y.Y({type:"ga_click_share_roundtable_box",target:this,data:{type:this.name}})});b=$(".rt-comment-box");b.length&&(d=new Ww(this.me.id,"roundtable"),this.J(d),this.h().e(this,
"click!",function(b){"comment"===b.namespace&&b.Gc.fill("label","roundtable")}),d.o(b[0]));b=$("#js-roundtable-menu-button");if(b.length){var g=this.me.url_token,d=new fv;d.o(b.next(".goog-menu")[0]);this.h().e(d,"action",function(b){b=$(b.target.m());if("addHotAnswer"===b.data("action"))var b=b.text(),c=Hi(b,'<input class="text" name="url" placeholder="请输入回答地址" style="width:90%">',function(b){if(b){var b=$("input",c.m()).val(),d=b.match(ze),e=d[1],h=d[2],l=d[3],d=d[4],G="";e&&(G+=e+":");l&&(G+="//",
h&&(G+=h+"@"),G+=l,d&&(G+=":"+d));if(!G)return n;$.post("/roundtable/"+g,{action:"add_hot_answer",answer_url:b}).done(function(){U("添加成功")})}})});d=new Mz("Settings",d);d.zm=j;Oz(d);d.o(b[0])}this.Ij();var h=this;$("#js-questions-home .roundtable-question-item").each(function(){h.GF(this)})};
t.EF=function(b){var c=this.me.url_token,d=$(b);if(this.aM){var e=$(".answer-actions",d),g=$('<span class="zg-bull zu-autohide">•</span><span>\n</span>'),h=$('<a href="javascript:;" class="zu-autohide meta-item">移除</a>');e.append(g).append(h);h.on("click",function(){Hi("移除回答","你确认要从活动中移除这个回答？",function(e){e&&(e=$(".zm-item-answer",b).data("atoken"),$.post("/roundtable/"+c,{action:"remove_hot_answer",url_token:e}),d.fadeOut(function(){d.remove()}))})})}};
t.GF=function(b){var c=this.me.url_token;$(b).on("click",".remove-button",function(b){Hi("移除问题","你确认要从活动中移除这个问题？",function(e){if(e){var g=$(b.delegateTarget),e=g.data("token");$.post("/roundtable/"+c,{action:"remove_question",url_token:e});g.fadeOut(function(){g.remove()})}})})};
t.uo=function(){this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.Gc.fill("category",this.nh).fill("label","roundtable_answer")});var b=this.me&&this.me.url_token;location.pathname==="/roundtable/"+b&&W(/expand=1/.test(location.search)?"notification":"navigation","visit_roundtable","roundtable_home");$(".roundtable-header .follow-button").on("click",function(){W("roundtable","click_follow_roundtable","roundtable_home")});$(".roundtable-search-box .add-button").on("click",function(){W("roundtable",
"click_apply_question","roundtable_add_quesiton")});$('a[data-follow="m:link"]').on("click",function(){W("roundtable","click_follow_people","roundtable_sidebar_follow")});$('a[data-follow="t:link"]').on("click",function(){W("roundtable","click_follow_topic","roundtable_sidebar_follow")});b&&Bv("roundtable",b,"read")};
t.YP=function(b){function c(b){return{none:'<i class="plus">+</i>',pending:"已申请",approved:"已添加"}[d(b)]}function d(b){var c=z.find(l,function(c){return c[0]===b});return c?c[1]?"approved":"pending":"none"}var e=$(".search-input",b).placeholder(),g=e[0],h=this.me.url_token,l=this.xT,m=this.Tm,p=Xk('<span class="title"><%=question.title%></span><span class="count"><%=question.answer_count%> 个回答</span><span class="status"><%= statusLabel(question.url_token) %></span>');(new Rp(g,{source:"/question/autocomplete",
lk:g.offsetParent,dd:function(b,d,e){e.innerHTML=p({question:b.data,statusLabel:c})}})).Ci=function(){var b=this.Xa[ym(this,this.zc)].url_token;"none"===d(b)&&(nu(h,b),l.push([b,n]),$(this.N.vg[this.N.mi]).find(".status").text("已申请"),W("roundtable","click_apply_question","roundtable_searchbox"))};e.on("keydown",rn(ha));$(".add-button",b).click(rn(function(){var b=e.val(),c=bs.U(),d={Tm:z.map(m,function(b){return[b.name,b.url_token,"",b.id]}),Yo:function(b){nu(h,b.wb).always(function(){location.href=
b.url})}};c.show(d);es(c,b)}))};
t.Ij=function(){var b=$("#js-roundtable-form");if(b.length){var c=this,d=this.h();$("input[placeholder]").placeholder();$('input[type="datetime"]',b).each(function(){var b=$(this),c=new aD;c.o(this);d.e(c,"change",function(){b.valid()})});$("input[data-suggest]",b).each(function(){var b=$(this),c=b.data("suggest"),e=b.closest(".controls"),g=e.find('input[type="hidden"]'),e=e.find("ul").get(0),h=b.data("maxTags"),l=new IC(this,{vJ:{topic:"/topic/%s",user:"/people/%s"}[c],source:{topic:"/topic/autocomplete",
user:"/people/autocomplete"}[c],Wq:j,Lb:e});d.e(l,"change",function(){var c=l.jx();h&&b.prop("disabled",c.length>=h);g.val(c.join(","))});c=l.jx();g.val(c.join(","))});var e=$('input[name="logo"]',b),g=$("#js-avatar-container"),h=$("img.avatar",g),g=$(".upload-button",g);if(R.Jg){var l=new Vl(4,this.me&&this.me.id,"xl");l.o(g[0]);d.e(l,"success",function(b){h.attr("src",b.src);e.val(l.getData())})}g.click(rn(ha,j));b.validate({ignore:[],submitHandler:function(){var d=$("#url_token").val(),e=c.me&&
c.me.url_token;$.post(b.attr("action"),b.serialize(),function(b){b.success?(U(e?"活动修改成功":"活动创建成功"),setTimeout(function(){location.href="/roundtable/"+d},3E3)):U(b.message)})},rules:{url_token:{pattern:/^[-A-Za-z0-9]+$/},beginTime:"datetime",endTime:{datetime:j,dateGreaterThan:"#beginTime"}},messages:{url_token:{pattern:"仅限数字、字母和短横线"},name:{maxlength:"活动名称不能超过 30 个字"},endTime:{dateGreaterThan:"结束时间必须大于开始时间"}}})}};
t.XP=function(b){function c(){d().length||($(".ignore-button").remove(),location.reload())}function d(){return $(".roundtable-question-item",b)}var e=d(),g=this.me.url_token;e.on("click",".approve-button",function(b){var d=$(b.delegateTarget),b=$(b.target),e=d.data("token");$.post("/roundtable/"+g,{action:"approve_question",url_token:e});b.text("添加成功");d.fadeOut(400,function(){d.remove();c()})});b.on("click",".ignore-button",function(){var b=d().map(function(){return $(this).data("token")}).get();
$.post("/roundtable/"+g,{action:"ignore_questions",url_tokens:b.join(",")});e.fadeOut(400,function(){$(this).remove();c()})})};t.FF=function(b,c){var d=new Qu;this.J(d);d.ra("nodeSource");d.o(b[0]);c&&Iu(d,c,this)};Ca("ZH.entryQuestionLog",function(){(new EC).B()});Ca("ZH.entryQuestionFollowersPage",function(){(new GC).B()});Ca("ZH.entrySQ",function(){(new nC).B()});Ca("ZH.entrySA",function(){(new wC).B()});Ca("ZH.entryL",function(){(new Ty).B()});Ca("ZH.entryT",function(){(new My).B()});Ca("ZH.entryTS",function(){(new DC).B()});Ca("ZH.entryP",function(){(new ey).B()});Ca("ZH.entryM",function(){(new Ay).B()});Ca("ZH.entryPM",function(){(new Uu).B()});Ca("ZH.entryPMDetail",function(){(new Vu).B()});
Ca("ZH.entryHelp",function(){(new Du).B()});Ca("ZH.entryInvite",function(){(new HC).B()});Ca("ZH.entryQueue",function(){(new xy).B()});Ca("ZH.entryTest",ba());Ca("ZH.entrySettings",function(){(new Dy).B()});Ca("ZH.entryTopicFeed",function(){(new yC).B()});Ca("ZH.entryTest",function(){(new fu.DY).B()});Ca("ZH.entryRQ3",function(){(new JC).B()});Ca("ZH.entryTerms",function(){(new KC).B()});Ca("ZH.entryHome",function(){(new hz).B()});Ca("ZH.entryQuestionFollowing",function(){(new LC).B()});
Ca("ZH.entryDraft",function(){(new NC).B()});Ca("ZH.entryExplore",function(){(new OC).B()});Ca("ZH.entryLookup",function(){(new QC).B()});Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(rn(function(){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}))})});Ca("ZH.entryRT",function(b,c){(new fD(b,c)).B()});Lf("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js